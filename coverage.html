intializing
[33m[Socket][0m A new guest has connected

user.auth(1,"367eca5b46762719ba54553963c57d4c16c8e5fa1709f0bd251d25fefcd28cc0").fn(0)
[33m[Socket][0m A user has been authenticated

task.update({"date":98843,"notes":"","completed":42418,"id":1}).fn(0)
[32m[user][0m [task] does not own 1
err_no_row

list.destroy({"tasks":[1,1,0,1,1,0,1,1],"id":0}).fn(1)
[32m[user][0m [list] does not own 0
err_no_row

pref.update({"night":98}).fn(2)

task.create({"id":1,"listId":1,"date":95655,"name":"nvuqsrjp","notes":"mbifggcvhmlmybz","priority":0,"completed":0}).fn(3)
[32m[user][0m [list] does not own 1

list.update({"tasks":[1,1,1,2,1,1,1,1],"id":2}).fn(4)
[32m[user][0m [list] does not own 2
err_no_row

task.create({"id":2,"listId":1,"date":0,"name":"gxzqpjivdvf","notes":"","priority":3,"completed":31956}).fn(5)
[32m[user][0m [list] does not own 1

list.update({"id":2,"tasks":[1,1,2,1,0,2,0,0,0,1]}).fn(6)
[32m[user][0m [list] does not own 2
err_no_row

list.destroy({"name":"weqdekkqhotrsbbz","tasks":[2,0,0],"id":2}).fn(7)
[32m[user][0m [list] does not own 2
err_no_row

task.create({"id":1,"listId":2,"date":89555,"name":"ixobpfimqqbldjxydvc","notes":"umkgirwvvp","priority":1,"completed":7914}).fn(8)
[32m[user][0m [list] does not own 2

task.create({"id":1,"listId":0,"date":21590,"name":"shgjfkmxrcmoupylalay","notes":"wolooro","priority":2,"completed":61448}).fn(9)
[32m[user][0m [list] does not own 0

pref.update({"sort":58,"night":52,"moveCompleted":47}).fn(10)

list.update({"id":2,"name":"gbih","tasks":[0]}).fn(11)
[32m[user][0m [list] does not own 2
err_no_row

task.update({"priority":0,"id":1}).fn(12)
[32m[user][0m [task] does not own 1
err_no_row

list.update({"id":2}).fn(13)
err_invalid_model

pref.update({"sort":60,"night":24,"language":"v","moveCompleted":35}).fn(14)

task.update({"id":1,"listId":1,"date":53700,"name":"jotubivqstcxewtnywuq","completed":72294}).fn(15)
[32m[user][0m [task] does not own 1
err_no_row

list.create({"id":0,"name":"djqciqawvevtnopin","tasks":[1,0,1,1,1,1]}).fn(16)

pref.update({"night":75,"weekStart":93,"dateFormat":"exptaptusnwlcs","confirmDelete":51}).fn(17)

list.update({"name":"fhcmlzjgjsdmtsox","tasks":[2,1,2,1],"id":2}).fn(18)
[32m[user][0m [list] does not own 2
err_no_row

list.create({"id":2,"name":"npihpqwwgjfnj","tasks":[2,2,2,0,2,0,1]}).fn(19)

list.destroy({"id":1,"name":"xqjubxgsxekxzsmkmv"}).fn(20)

pref.update({"language":"qipesuwhen","dateFormat":"lpynktdiqvuxmmgoo","confirmDelete":83}).fn(21)

list.destroy({"tasks":[2,1,1,2],"id":2}).fn(22)

list.destroy({"tasks":[2,2,1,1,2,0,1,2],"id":2}).fn(23)
[32m[user][0m [list] does not own 2
err_no_row

task.update({"listId":2,"date":34944,"notes":"bwvovgidlzl","priority":1,"id":1}).fn(24)
[32m[user][0m [task] does not own 1
err_no_row

pref.update({"sort":36,"night":85,"language":"u","dateFormat":"tckrzxvrqnaa","confirmDelete":11,"moveCompleted":96}).fn(25)

task.update({"listId":1,"date":25588,"name":"sh","notes":"","priority":2,"completed":0,"id":2}).fn(26)
[32m[user][0m [task] does not own 2
err_no_row

list.create({"id":2,"name":"umsdootucenoufdia","tasks":[2,2,2,1,2,0,1,1,0]}).fn(27)

pref.update({"night":50,"weekStart":49,"moveCompleted":28}).fn(28)

list.create({"id":0,"name":"esrtmizdhlygpopmx","tasks":[2,1,1,3,3]}).fn(29)

task.update({"id":2,"listId":4,"notes":"eckrqxo"}).fn(30)
[32m[user][0m [task] does not own 2
err_no_row

pref.update({"sort":25,"night":25,"weekStart":90,"dateFormat":"srmnc","moveCompleted":12}).fn(31)

pref.update({"sort":90,"night":56,"dateFormat":"izxscpsk","confirmDelete":50}).fn(32)

list.create({"id":1,"name":"yihqjkecz","tasks":[4,3]}).fn(33)

list.destroy({"name":"qftjgbmyxkngfyjxh","id":4}).fn(34)

list.destroy({"tasks":[0,1,3,2],"id":0}).fn(35)
[32m[user][0m [list] does not own 0
err_no_row

pref.update({"sort":74,"night":84,"weekStart":33,"dateFormat":"tfloct"}).fn(36)

list.create({"id":1,"name":"zwntotqapvlhbwarne","tasks":[1,2,0,1,2]}).fn(37)

list.update({"id":5}).fn(38)
err_invalid_model

list.update({"id":1,"name":"efgmvzwjjcbstxetru"}).fn(39)
[32m[user][0m [list] does not own 1
err_no_row

list.update({"id":3,"tasks":[0,3,2,2]}).fn(40)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.create({"id":4,"name":"qkqpbqf","tasks":[5,3,4]}).fn(41)

list.update({"id":3}).fn(42)
err_invalid_model

list.update({"id":2,"tasks":[7,1,4,4]}).fn(43)
[32m[user][0m [list] does not own 2
err_no_row

task.update({"id":6,"listId":1,"name":"kupakpierdo","notes":"hv","completed":0}).fn(44)
[32m[user][0m [task] does not own 6
err_no_row

list.update({"name":"pdssjsiuobihv","id":2}).fn(45)
[32m[user][0m [list] does not own 2
err_no_row

list.update({"name":"btqheyf","tasks":[6,2,3,5],"id":0}).fn(46)
[32m[user][0m [list] does not own 0
err_no_row

list.destroy({"id":2,"tasks":[2,3,6,2,5,4,4,6,2,1]}).fn(47)
[32m[user][0m [list] does not own 2
err_no_row

list.update({"name":"tlljdhogybtoxxfi","tasks":[1,4],"id":4}).fn(48)
[32m[user][0m [list] does not own 4
err_no_row

list.update({"id":3,"tasks":[5,0,2,5,1,1,5,7]}).fn(49)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":2}).fn(50)
err_invalid_model

pref.update({"language":"ikbyctgsnqdjnqgy"}).fn(51)

list.destroy({"id":2,"name":"wevqezhjtgfnirrgjolk","tasks":[3,7,7,1,2,3,5,3,6,2,6]}).fn(52)
[32m[user][0m [list] does not own 2
err_no_row

task.destroy({"listId":2,"notes":"","id":1}).fn(53)
[32m[user][0m [task] does not own 1
err_no_row

list.destroy({"tasks":[2,3,5,5,3,4,4,5,0],"id":6}).fn(54)

pref.update({"sort":78,"dateFormat":"h","moveCompleted":31}).fn(55)

list.destroy({"id":2,"name":"hnlcyjuvngsmxyvn"}).fn(56)
[32m[user][0m [list] does not own 2
err_no_row

task.update({"id":5,"date":61003,"name":"ckeyrpe","notes":"","priority":2}).fn(57)
[32m[user][0m [task] does not own 5
err_no_row

task.update({"listId":2,"name":"o","priority":1,"completed":0,"id":5}).fn(58)
[32m[user][0m [task] does not own 5
err_no_row

list.create({"id":5,"name":"gjfubrtsxyglxi","tasks":[2,4,2,4,2,0,4]}).fn(59)

list.create({"id":5,"name":"pyfplgmwiwdkcqb","tasks":[0,0]}).fn(60)

pref.update({"night":42,"dateFormat":"mdgxgfscwfqenvcio"}).fn(61)

task.update({"id":5,"date":44692,"name":"oyplvnmiktbexfbnivq","notes":"ertv","priority":1,"completed":84327}).fn(62)
[32m[user][0m [task] does not own 5
err_no_row

list.create({"id":2,"name":"fofn","tasks":[5,8,1,4,3,1,4]}).fn(63)

pref.update({"night":13,"dateFormat":"lkqdcisvbutwalat"}).fn(64)

task.create({"id":5,"listId":3,"date":0,"name":"go","notes":"","priority":0,"completed":0}).fn(65)

task.create({"id":9,"listId":1,"date":61502,"name":"cldsys","notes":"","priority":0,"completed":0}).fn(66)
[32m[user][0m [list] does not own 1

list.destroy({"tasks":[2],"id":0}).fn(67)
[32m[user][0m [list] does not own 0
err_no_row

list.destroy({"id":4}).fn(68)
[32m[user][0m [list] does not own 4
err_no_row

task.update({"date":91469,"id":8}).fn(69)
[32m[user][0m [task] does not own 8
err_no_row

list.create({"id":10,"name":"hkkundjkctmzxfle","tasks":[10,6,8,1,2,0,6,6]}).fn(70)

pref.update({"night":7,"language":"pinkmujuvdt","dateFormat":"swhrkytrgxydjsh","confirmDelete":46}).fn(71)

list.destroy({"id":7}).fn(72)

list.update({"id":4,"name":"xniqbbdpshqmicfxhc","tasks":[11,3,7]}).fn(73)
[32m[user][0m [list] does not own 4
err_no_row

pref.update({"sort":85,"dateFormat":"xugcfwypdpuzrqylledg","confirmDelete":23,"moveCompleted":44}).fn(74)

list.update({"id":2,"name":"ohhtb"}).fn(75)
[32m[user][0m [list] does not own 2
err_no_row

list.update({"id":9,"name":"fiioznrvghuqmjgfe","tasks":[0,8,4,5,7,4,2,2,7]}).fn(76)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.destroy({"id":3,"priority":1,"completed":0}).fn(77)
[32m[user][0m [task] does not own 3
err_no_row

pref.update({"dateFormat":"yjwopefupcbo"}).fn(78)

list.update({"id":9,"tasks":[8,2,1,8,3]}).fn(79)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.destroy({"name":"elxorlweyhxg","priority":2,"id":10}).fn(80)
[32m[user][0m [task] does not own 10
err_no_row

list.create({"id":1,"name":"yi","tasks":[5,6,1,9,2]}).fn(81)

list.update({"id":1}).fn(82)
err_invalid_model

list.create({"id":11,"name":"revzjqmynvwtgpvt","tasks":[11,2,4,1,9,5,7,1]}).fn(83)

pref.update({"sort":28,"weekStart":8,"confirmDelete":18}).fn(84)

list.create({"id":3,"name":"bvpojoskjfps","tasks":[8,1,8,5,2,2,2,4,3]}).fn(85)

task.destroy({"id":7,"listId":7,"name":"klvfo","completed":108}).fn(86)
[32m[user][0m [task] does not own 7
err_no_row

pref.update({"weekStart":9}).fn(87)

pref.update({"night":89,"language":"clcryjtrmplnwwvn","weekStart":84,"dateFormat":"hbobt","confirmDelete":87}).fn(88)

list.update({"id":6}).fn(89)
err_invalid_model

list.update({"id":13,"name":"pvfkbjemydfiixhrcakn","tasks":[2,2,4,5,9,13,6,1]}).fn(90)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":1,"tasks":[2,4,12,6,3,1]}).fn(91)
[32m[user][0m [list] does not own 1
err_no_row

list.create({"id":3,"name":"qryeld","tasks":[8,10,12,10,4,2,6,14,12,1]}).fn(92)

task.update({"id":6,"date":0,"name":"sfqksnlubg"}).fn(93)
[32m[user][0m [task] does not own 6
err_no_row

list.update({"name":"egroxqkjssqcxuiudm","id":13}).fn(94)

list.update({"id":8,"name":"yccmurdwnh","tasks":[14,13,2,1,7,1,6,14,10]}).fn(95)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"tasks":[2,1,13,3,10,11,1,8,1,2,14],"id":4}).fn(96)
[32m[user][0m [list] does not own 4
err_no_row

list.update({"id":1,"name":"cvraeipyambtgenq"}).fn(97)
[32m[user][0m [list] does not own 1
err_no_row

list.update({"id":0,"name":"bsiixwauqwqtngrbeqfj","tasks":[3,3,5,13,3,2,12]}).fn(98)
[32m[user][0m [list] does not own 0
err_no_row

list.destroy({"tasks":[6,1,15,3,2,11,7,1,10],"id":8}).fn(99)

list.update({"id":12}).fn(100)
err_invalid_model

list.update({"id":1,"tasks":[5,6,1,1,1]}).fn(101)
[32m[user][0m [list] does not own 1
err_no_row

list.create({"id":8,"name":"duklajuewh","tasks":[7,2,2,2,8,1,12]}).fn(102)

pref.update({"sort":71,"language":"hmyfwqreppr","weekStart":67,"confirmDelete":58}).fn(103)

list.destroy({"id":1,"name":"unurdlilsgymuxihonp"}).fn(104)
[32m[user][0m [list] does not own 1
err_no_row

list.update({"id":13}).fn(105)
err_invalid_model

list.update({"id":3,"name":"xtvqpwtornpizkickmt","tasks":[10,16,3,4,12,2,2,2]}).fn(106)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.create({"id":2,"name":"g","tasks":[14,1,11,12,1,2,1,4]}).fn(107)

list.destroy({"id":10}).fn(108)

task.update({"id":10,"priority":1,"completed":0}).fn(109)
[32m[user][0m [task] does not own 10
err_no_row

pref.update({"night":73,"language":"yukfohcxbu","weekStart":44,"dateFormat":"bzqcwnhhgtflb","moveCompleted":39}).fn(110)

list.destroy({"id":16}).fn(111)

pref.update({"sort":7,"night":77,"language":"ggbhm","weekStart":51,"confirmDelete":69}).fn(112)

list.destroy({"name":"ncgbtgtmxoxlu","id":1}).fn(113)
[32m[user][0m [list] does not own 1
err_no_row

task.destroy({"id":8,"listId":14,"date":96322}).fn(114)
[32m[user][0m [task] does not own 8
err_no_row

pref.update({"sort":93,"language":"lycvuedthvl","moveCompleted":75}).fn(115)

task.update({"id":11,"date":83703,"name":"nkcmnps","notes":"tnvqqudytkificf","completed":0}).fn(116)
[32m[user][0m [task] does not own 11
err_no_row

list.create({"id":1,"name":"hziaingpdcwrnxpg","tasks":[9,1]}).fn(117)

list.destroy({"name":"sobu","id":5}).fn(118)

task.create({"id":13,"listId":1,"date":0,"name":"bvualjknu","notes":"upibtqiysurcpr","priority":1,"completed":0}).fn(119)
[32m[user][0m [list] does not own 1

task.update({"id":12,"listId":2,"date":0,"name":"uklq","priority":2}).fn(120)
[32m[user][0m [task] does not own 12
err_no_row

list.create({"id":1,"name":"rmeufvrlihyferdxw","tasks":[8,1,2,13,11,0,2,13]}).fn(121)

pref.update({"sort":32,"night":37,"language":"atmkzmwclbfxdhw","confirmDelete":20}).fn(122)

task.update({"date":0,"name":"lvvn","priority":3,"id":9}).fn(123)
[32m[user][0m [task] does not own 9
err_no_row

task.create({"id":1,"listId":10,"date":0,"name":"mnpbsnst","notes":"","priority":1,"completed":0}).fn(124)
[32m[user][0m [list] does not own 10

task.update({"listId":1,"date":89743,"name":"xeckhnkng","notes":"","completed":89285,"id":4}).fn(125)
[32m[user][0m [task] does not own 4
err_no_row

pref.update({"sort":61,"night":35,"moveCompleted":21}).fn(126)

list.destroy({"tasks":[2,1,10,1,8,14,16],"id":1}).fn(127)
[32m[user][0m [list] does not own 1
err_no_row

list.destroy({"id":8,"tasks":[8,1,2]}).fn(128)
[32m[user][0m [list] does not own 8
err_no_row

task.update({"id":15,"date":0,"notes":"yggyhhguhtfve","priority":2}).fn(129)
[32m[user][0m [task] does not own 15
err_no_row

list.destroy({"id":1}).fn(130)
[32m[user][0m [list] does not own 1
err_no_row

pref.update({"sort":99,"language":"royxkbqscohfvffmqi","dateFormat":"mdkzebhpsnvmvpmqswq","confirmDelete":91,"moveCompleted":42}).fn(131)

pref.update({"sort":65,"dateFormat":"gqwjfvtbsqxjmoq","moveCompleted":77}).fn(132)

list.create({"id":1,"name":"rswmntmfg","tasks":[6,2,2,1,14,10,12,0,18]}).fn(133)

pref.update({"night":49,"confirmDelete":20}).fn(134)

pref.update({"night":46,"language":"yhlzxgsuyd","weekStart":16,"moveCompleted":38}).fn(135)

task.update({"listId":14,"name":"nkyunfeyjxucv","notes":"","id":10}).fn(136)
[32m[user][0m [task] does not own 10
err_no_row

pref.update({"sort":69,"night":58,"weekStart":24,"dateFormat":"nqeqhulwesvt","confirmDelete":38,"moveCompleted":3}).fn(137)

pref.update({"language":"gxdrdneqcowum","weekStart":48,"dateFormat":"nhoxopiebnvtwwghjcdd"}).fn(138)

pref.update({"sort":64,"language":"yw","confirmDelete":78,"moveCompleted":55}).fn(139)

list.destroy({"id":16,"name":"ij"}).fn(140)
[32m[user][0m [list] does not own 16
err_no_row

task.create({"id":15,"listId":12,"date":68301,"name":"kfmwo","notes":"","priority":3,"completed":0}).fn(141)

list.update({"id":8}).fn(142)
err_invalid_model

pref.update({"sort":65,"language":"kmhtmfbqx","weekStart":58,"confirmDelete":3}).fn(143)

list.destroy({"name":"ztuncvemmifxl","id":17}).fn(144)

list.update({"id":14}).fn(145)
err_invalid_model

task.update({"notes":"gr","completed":31661,"id":3}).fn(146)
[32m[user][0m [task] does not own 3
err_no_row

pref.update({"night":36,"language":"liywv","dateFormat":"uuvjwsij","confirmDelete":61,"moveCompleted":18}).fn(147)

pref.update({"language":"rjqwlibxi","confirmDelete":48}).fn(148)

task.create({"id":6,"listId":1,"date":0,"name":"bx","notes":"","priority":1,"completed":43952}).fn(149)
[32m[user][0m [list] does not own 1

task.create({"id":15,"listId":0,"date":8432,"name":"xftfssw","notes":"","priority":3,"completed":0}).fn(150)
[32m[user][0m [list] does not own 0

pref.update({"language":"xkgvk","dateFormat":"lsjineqmluejfxiw"}).fn(151)

task.create({"id":1,"listId":10,"date":0,"name":"oibbhq","notes":"jpayxfvkelnrviyhkc","priority":1,"completed":34329}).fn(152)
[32m[user][0m [list] does not own 10

task.create({"id":7,"listId":16,"date":38971,"name":"znrwrljpygvknjwyut","notes":"pcxnkgzoodlmsyjybqni","priority":2,"completed":0}).fn(153)
[32m[user][0m [list] does not own 16

list.update({"id":20}).fn(154)
err_invalid_model

pref.update({}).fn(155)
err_invalid_model

list.create({"id":7,"name":"ydycplfsithqpfqf","tasks":[8,5,13,1,13,10,15,2,8]}).fn(156)

list.destroy({"id":16,"tasks":[4,21,17,13]}).fn(157)
[32m[user][0m [list] does not own 16
err_no_row

pref.update({"night":100,"language":"jxhghxrddknv","confirmDelete":36}).fn(158)

task.destroy({"listId":17,"notes":"bnqxjqhihwjdrkg","priority":1,"id":18}).fn(159)
[32m[user][0m [task] does not own 18
err_no_row

list.update({"name":"kxxp","id":3}).fn(160)

list.update({"tasks":[16,7,12,15,18,10,19],"id":3}).fn(161)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"tasks":[6,0],"id":14}).fn(162)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":9,"name":"yzutly"}).fn(163)

pref.update({"night":39,"language":"nxgvvl","dateFormat":"bctdnvxtmjvnlpafbr"}).fn(164)

task.create({"id":16,"listId":14,"date":39134,"name":"vvgaul","notes":"nldnvkfrxbsnjoffhfv","priority":1,"completed":24835}).fn(165)

list.update({"id":17}).fn(166)
err_invalid_model

list.update({"tasks":[2,20,13,14,19,21,9,6,2],"id":7}).fn(167)
[32m[user][0m [list] does not own 7
err_no_row

list.destroy({"id":1}).fn(168)
[32m[user][0m [list] does not own 1
err_no_row

task.update({"id":3,"date":0,"name":"xtcbmfcmvmklmsmx"}).fn(169)

pref.update({"sort":52,"night":19,"weekStart":84,"confirmDelete":79}).fn(170)

pref.update({"sort":21,"night":83,"language":"nk","confirmDelete":22}).fn(171)

list.destroy({"id":16}).fn(172)
[32m[user][0m [list] does not own 16
err_no_row

pref.update({"sort":57,"night":46}).fn(173)

task.destroy({"id":16,"listId":5,"name":"wdwznkkqjnygmdhnpbgxj","priority":1,"completed":0}).fn(174)
[32m[user][0m [task] does not own 16
err_no_row

task.update({"id":10,"listId":13,"date":0,"name":"blslobkshypqgfxrkpnt"}).fn(175)
[32m[user][0m [task] does not own 10
err_no_row

list.update({"id":1}).fn(176)
err_invalid_model

list.update({"id":14}).fn(177)
err_invalid_model

task.update({"id":8,"listId":19,"date":0,"name":"ikjsbftcagpxfxymxswqn","notes":"","completed":0}).fn(178)
[32m[user][0m [task] does not own 8
err_no_row

task.create({"id":2,"listId":3,"date":65721,"name":"kbdthrpmfsboloqxgdhf","notes":"","priority":1,"completed":15271}).fn(179)

list.destroy({"id":14,"name":"rpiesbuirfdncnfkvdu","tasks":[2,20,21,11]}).fn(180)

list.destroy({"id":7}).fn(181)
[32m[user][0m [list] does not own 7
err_no_row

list.create({"id":13,"name":"acwnsdi","tasks":[3,4,3,5]}).fn(182)

task.update({"listId":15,"name":"jnrtbrqbchyrout","priority":3,"completed":34925,"id":2}).fn(183)

task.destroy({"name":"wdypjnpadnimlebnnwpu","completed":95188,"id":14}).fn(184)
[32m[user][0m [task] does not own 14
err_no_row

list.update({"id":19,"name":"iqxhlvvkcnqpovvmxc","tasks":[18,4,3,13,7,20,13,15]}).fn(185)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.create({"id":16,"name":"dezs","tasks":[7,4,9,19,2,3,1,3,18,7]}).fn(186)

task.update({"id":20,"listId":3,"name":"yjctgott","priority":2}).fn(187)
[32m[user][0m [task] does not own 20
err_no_row

list.destroy({"id":9,"tasks":[6,12]}).fn(188)

pref.update({"sort":52,"night":11,"weekStart":69,"dateFormat":"lxllwgtgtcaz","moveCompleted":50}).fn(189)

task.create({"id":13,"listId":13,"date":48891,"name":"xtpsnaqwynlpuo","notes":"","priority":2,"completed":0}).fn(190)

list.destroy({"id":6,"name":"whnuysdshbdelcojxtoa"}).fn(191)
[32m[user][0m [list] does not own 6
err_no_row

list.update({"id":13,"name":"jelrlqsgthy"}).fn(192)

pref.update({"sort":84,"language":"urq","weekStart":18,"dateFormat":"csvdnthieauyupzneuq","confirmDelete":26}).fn(193)

list.update({"id":2}).fn(194)
err_invalid_model

pref.update({"sort":0,"weekStart":1,"confirmDelete":11,"moveCompleted":42}).fn(195)

pref.update({"sort":26,"night":68,"weekStart":49,"dateFormat":"ckbnsxyoiypdel","confirmDelete":19,"moveCompleted":26}).fn(196)

list.destroy({"id":20,"name":"sdurqngogbkhyry"}).fn(197)

list.update({"id":22,"name":"kqewccajfcntxnw","tasks":[2,18,5,6,3,14,3,2]}).fn(198)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"tasks":[1,18,3],"id":15}).fn(199)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.create({"id":3,"name":"btnpnnvismin","tasks":[22,3,5,1,1,4,7,8,3]}).fn(200)

list.destroy({"id":12,"name":"pea","tasks":[3,4,4,5,5,10,2,13,11]}).fn(201)

task.update({"listId":23,"date":0,"name":"upf","notes":"","priority":1,"id":4}).fn(202)

task.update({"id":16,"listId":21,"name":"vkkoulnbprryk"}).fn(203)
[32m[user][0m [task] does not own 16
err_no_row

list.update({"id":7,"tasks":[19,21,14,9,2]}).fn(204)
[32m[user][0m [list] does not own 7
err_no_row

task.destroy({"id":15,"listId":6,"name":"cftjukjtwiiqipigpllb","notes":"","priority":2,"completed":0}).fn(205)
[32m[user][0m [task] does not own 15
err_no_row

list.update({"name":"rwtxmyzbyifguweqn","id":22}).fn(206)

task.update({"id":11,"listId":12,"date":45289,"notes":"","priority":0}).fn(207)
[32m[user][0m [task] does not own 11
err_no_row

task.destroy({"listId":2,"date":46595,"name":"wytpdlflakkxxqdrdclig","notes":"","priority":0,"completed":0,"id":5}).fn(208)

list.destroy({"name":"snqorjtjxj","id":21}).fn(209)

list.update({"id":8,"tasks":[2,16,3,1,23,11,1,1,1,5]}).fn(210)
[32m[user][0m [list] does not own 8
err_no_row

list.update({"id":7,"name":"rutivgctxyxfb"}).fn(211)
[32m[user][0m [list] does not own 7
err_no_row

list.create({"id":2,"name":"madir","tasks":[2,4,11,18,3,5,15,4]}).fn(212)

task.destroy({"id":12,"listId":2,"date":0,"priority":0}).fn(213)
[32m[user][0m [task] does not own 12
err_no_row

pref.update({"sort":13,"night":4,"language":"ssfqlqjkqonlbrdfoqu","weekStart":45,"dateFormat":"pb","confirmDelete":21,"moveCompleted":97}).fn(214)

list.update({"name":"fmveowthgjh","tasks":[4,5,3],"id":4}).fn(215)
[32m[user][0m [list] does not own 4
err_no_row

task.update({"name":"es","notes":"","completed":88092,"id":13}).fn(216)
[32m[user][0m [task] does not own 13
err_no_row

list.create({"id":18,"name":"dzbxwsdwtgjruwy","tasks":[19,21,2,10,10,20,20,10]}).fn(217)

list.create({"id":20,"name":"phhbgqilvtrtfsutc","tasks":[11,1,8,4,6,6,21,18,13]}).fn(218)

pref.update({"sort":27,"night":65,"weekStart":55,"moveCompleted":5}).fn(219)

list.update({"id":24,"name":"hjlktf"}).fn(220)

list.update({"id":1}).fn(221)
err_invalid_model

task.update({"id":11,"date":16827,"name":"acgxldp","priority":3,"completed":0}).fn(222)
[32m[user][0m [task] does not own 11
err_no_row

list.create({"id":20,"name":"mhkdu","tasks":[20,1,6,13,17,26]}).fn(223)

list.update({"id":5}).fn(224)
err_invalid_model

task.update({"name":"nwxlsuxexkmsvdpxenox","notes":"","priority":0,"completed":0,"id":4}).fn(225)

task.update({"date":24157,"priority":3,"completed":0,"id":8}).fn(226)
[32m[user][0m [task] does not own 8
err_no_row

pref.update({"sort":41,"weekStart":62}).fn(227)

task.update({"name":"ymxugwlr","priority":0,"id":24}).fn(228)
[32m[user][0m [task] does not own 24
err_no_row

list.update({"name":"xbqsccppklpgenucqx","id":3}).fn(229)

task.destroy({"id":3,"date":0,"name":"jgfow","priority":1}).fn(230)
[32m[user][0m [task] does not own 3
err_no_row

list.destroy({"id":9,"name":"wbhdwepsclfio","tasks":[3,25,4,6,5,16,3]}).fn(231)
[32m[user][0m [list] does not own 9
err_no_row

list.update({"name":"dlbjjnobpefgnrhbwiho","tasks":[17,4,23,5,15,5,2,23,21],"id":1}).fn(232)
[32m[user][0m [list] does not own 1
err_no_row

pref.update({"language":"chqffizapvjdclhqgkv"}).fn(233)

pref.update({"sort":43,"weekStart":9,"dateFormat":"whd","confirmDelete":94}).fn(234)

list.update({"id":14,"name":"fjmwydbvmvygbjfnjjf","tasks":[14,24,1]}).fn(235)
[32m[user][0m [list] does not own 14
err_no_row

task.update({"id":14,"date":12512,"name":"cwhwl","priority":1}).fn(236)
[32m[user][0m [task] does not own 14
err_no_row

list.create({"id":7,"name":"eopkpnwaoknprcddf","tasks":[24,4,4,25,3,5,8,8]}).fn(237)

list.destroy({"id":6,"name":"wylsezih"}).fn(238)
[32m[user][0m [list] does not own 6
err_no_row

task.destroy({"listId":1,"date":6912,"priority":1,"completed":0,"id":6}).fn(239)
[32m[user][0m [task] does not own 6
err_no_row

list.create({"id":1,"name":"rexkiqpflgklftrqgcpkj","tasks":[12,26,4,11,7,3,13,26]}).fn(240)

task.destroy({"date":21392,"name":"mogdxspn","priority":1,"id":1}).fn(241)

task.destroy({"listId":8,"notes":"","priority":2,"completed":0,"id":5}).fn(242)
[32m[user][0m [task] does not own 5
err_no_row

task.create({"id":5,"listId":1,"date":29154,"name":"wdcvkmcmg","notes":"","priority":0,"completed":90890}).fn(243)
[32m[user][0m [list] does not own 1

pref.update({"sort":19,"night":51,"language":"qxrhwdbidus","weekStart":68,"confirmDelete":11,"moveCompleted":71}).fn(244)

pref.update({"night":36,"language":"nbdq","weekStart":76,"confirmDelete":60}).fn(245)

task.create({"id":24,"listId":0,"date":0,"name":"fzhkwkklwkumnrtqthwd","notes":"","priority":2,"completed":0}).fn(246)
[32m[user][0m [list] does not own 0

task.update({"id":16,"date":0,"notes":"","priority":3}).fn(247)
[32m[user][0m [task] does not own 16
err_no_row

list.create({"id":23,"name":"mvkelylxrhykb","tasks":[23,10,6,4,26,1]}).fn(248)

pref.update({"night":80,"language":"tnotoqfs","dateFormat":"kltmjpazfn","moveCompleted":91}).fn(249)

task.create({"id":2,"listId":20,"date":0,"name":"ycr","notes":"q","priority":2,"completed":0}).fn(250)
[32m[user][0m [list] does not own 20

task.create({"id":10,"listId":28,"date":0,"name":"jbjsybytzsapabc","notes":"","priority":1,"completed":71169}).fn(251)

task.create({"id":1,"listId":5,"date":12898,"name":"opouhrrpmqqzyf","notes":"uzgowviwqagcixjnmz","priority":0,"completed":76237}).fn(252)
[32m[user][0m [list] does not own 5

task.create({"id":12,"listId":6,"date":0,"name":"bdyronwkexbvp","notes":"","priority":0,"completed":55358}).fn(253)
[32m[user][0m [list] does not own 6

task.update({"id":1,"listId":3,"notes":"jfihwancjbjk"}).fn(254)
[32m[user][0m [task] does not own 1
err_no_row

pref.update({"sort":37,"language":"prz","dateFormat":"attxfrjo","confirmDelete":7,"moveCompleted":79}).fn(255)

pref.update({"night":96,"weekStart":83,"moveCompleted":93}).fn(256)

task.destroy({"listId":11,"name":"muhjj","notes":"","priority":1,"id":2}).fn(257)

list.update({"id":13}).fn(258)
err_invalid_model

pref.update({"language":"xmiskpvtmnnmjyc","dateFormat":"cxptffbarnhdchbxb"}).fn(259)

pref.update({"language":"reyfrbchcbfykpvq","weekStart":69,"dateFormat":"rnpvbqhkhgjljywug","moveCompleted":29}).fn(260)

pref.update({"sort":56,"weekStart":7}).fn(261)

task.update({"id":4,"listId":2,"completed":0}).fn(262)
[32m[user][0m [list] does not own 2

list.create({"id":20,"name":"lgwhgxkcondhlnvgdhrkf","tasks":[5,2,23,5,8]}).fn(263)

list.update({"name":"uyfschvtvrinkgrtdpky","tasks":[29,21,20,3,11,4,18],"id":13}).fn(264)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.destroy({"id":28}).fn(265)

task.create({"id":4,"listId":29,"date":0,"name":"nisgzlevsqcobk","notes":"umuafledukoplnrjf","priority":0,"completed":0}).fn(266)

list.create({"id":18,"name":"bmqtffrkwflavwjzq","tasks":[10,25,24,25]}).fn(267)

task.update({"id":25,"name":"xy","notes":"","priority":2,"completed":73035}).fn(268)
[32m[user][0m [task] does not own 25
err_no_row

pref.update({"language":"derjwdmqepmv","weekStart":97,"dateFormat":"nhxttpvmiuvixbcifah","moveCompleted":52}).fn(269)

pref.update({"sort":4,"dateFormat":"ghvkizrh"}).fn(270)

list.create({"id":30,"name":"zwdmxwpnqxyjgyxenwn","tasks":[19,14,2,4,4,7,3,5,27]}).fn(271)

pref.update({"night":51}).fn(272)

task.update({"id":1,"date":88806}).fn(273)
[32m[user][0m [task] does not own 1
err_no_row

pref.update({"weekStart":9,"dateFormat":"krxefodhdnvqxt","confirmDelete":1}).fn(274)

task.destroy({"id":20,"priority":3,"completed":0}).fn(275)
[32m[user][0m [task] does not own 20
err_no_row

list.create({"id":0,"name":"lycyh","tasks":[6,13,2,18,12,33]}).fn(276)

task.update({"id":25,"completed":0}).fn(277)
[32m[user][0m [task] does not own 25
err_no_row

list.update({"id":8}).fn(278)
err_invalid_model

task.create({"id":27,"listId":9,"date":0,"name":"orid","notes":"jteyjkfjn","priority":3,"completed":16242}).fn(279)
[32m[user][0m [list] does not own 9

pref.update({"night":82,"language":"or","weekStart":90}).fn(280)

list.update({"name":"tvbxhlilk","tasks":[11,4,12],"id":10}).fn(281)
[32m[user][0m [list] does not own 10
err_no_row

pref.update({"language":"mqilscevhjgcdtxlgutu","confirmDelete":20,"moveCompleted":97}).fn(282)

list.destroy({"id":6,"name":"jcaomdn","tasks":[18,7,25,27]}).fn(283)
[32m[user][0m [list] does not own 6
err_no_row

list.update({"name":"kmrxjcs","tasks":[27,25,21,17,2,20,14,22,12,15],"id":28}).fn(284)
[32m[user][0m [list] does not own 28
err_no_row

pref.update({"sort":25,"language":"qiaufo","dateFormat":"skbxstq"}).fn(285)

list.destroy({"name":"hkikpcpvllptvple","id":16}).fn(286)
[32m[user][0m [list] does not own 16
err_no_row

list.update({"id":2,"name":"xqebffcfpwhavixcsjcs"}).fn(287)
[32m[user][0m [list] does not own 2
err_no_row

pref.update({"sort":39,"weekStart":89,"confirmDelete":92}).fn(288)

list.create({"id":1,"name":"icvbvjjopmhvord","tasks":[7,12,31,21]}).fn(289)

task.create({"id":29,"listId":11,"date":0,"name":"uwhsskhggenhpdgovv","notes":"","priority":2,"completed":88605}).fn(290)

pref.update({"sort":79,"language":"fj","weekStart":23,"moveCompleted":75}).fn(291)

list.update({"name":"yvz","tasks":[6,21,2,24,6,26,18,2,4,25],"id":3}).fn(292)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.create({"id":32,"listId":2,"date":34043,"name":"rkgbjnpnusbxmjep","notes":"ltvyyns","priority":1,"completed":0}).fn(293)
[32m[user][0m [list] does not own 2

list.update({"id":6}).fn(294)
err_invalid_model

task.create({"id":14,"listId":6,"date":0,"name":"fopqif","notes":"","priority":2,"completed":0}).fn(295)
[32m[user][0m [list] does not own 6

pref.update({"night":87,"dateFormat":"dotbryyusvioemjdqf"}).fn(296)

task.destroy({"id":16,"notes":"wtkvlahruilncktmily","completed":61314}).fn(297)
[32m[user][0m [task] does not own 16
err_no_row

task.update({"id":4,"listId":26,"date":0,"name":"hlmujqst","priority":2,"completed":83302}).fn(298)

pref.update({"sort":46,"night":39,"language":"cwrgpznseuqxcsfbw","dateFormat":"uxf","confirmDelete":60,"moveCompleted":76}).fn(299)

list.create({"id":27,"name":"ihiyotgoixtij","tasks":[1,35,11,23,32,27,28,8,9]}).fn(300)

list.update({"name":"rotmye","tasks":[2,31,2,21,37,13,6,22,5],"id":36}).fn(301)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.update({"date":11772,"priority":2,"id":18}).fn(302)
[32m[user][0m [task] does not own 18
err_no_row

pref.update({"night":2,"weekStart":79}).fn(303)

list.update({"id":3,"name":"oeleqjtxnpktuerftr"}).fn(304)

list.create({"id":12,"name":"xjchggpetskwfteemve","tasks":[8,17,6,11]}).fn(305)

list.create({"id":35,"name":"keitdckbevfcvrbmb","tasks":[1,24,25,17,16,35,30,27,36]}).fn(306)

list.update({"id":9,"name":"zdthtgoqxcvrmjgeo"}).fn(307)
[32m[user][0m [list] does not own 9
err_no_row

pref.update({"weekStart":15}).fn(308)

list.update({"id":24}).fn(309)
err_invalid_model

list.update({"id":25}).fn(310)
err_invalid_model

pref.update({"sort":100,"language":"nre","weekStart":1,"dateFormat":"csgkknnzyblbdhh","moveCompleted":20}).fn(311)

task.update({"listId":7,"date":1111,"notes":"vghh","completed":0,"id":32}).fn(312)
[32m[user][0m [task] does not own 32
err_no_row

pref.update({"sort":95,"dateFormat":"mtwvbbbvkv","confirmDelete":66}).fn(313)

task.update({"listId":10,"date":92782,"name":"mqbamlwquinybufetnc","priority":1,"completed":85484,"id":6}).fn(314)
[32m[user][0m [task] does not own 6
err_no_row

task.create({"id":9,"listId":19,"date":82402,"name":"lugx","notes":"","priority":3,"completed":0}).fn(315)

list.create({"id":35,"name":"cthhrixfuwu","tasks":[28,7,10,34,12,6,20,6]}).fn(316)

list.update({"name":"hupfjs","tasks":[37,14,28],"id":11}).fn(317)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":80,"language":"udmknkearjkjodqjowd","confirmDelete":31}).fn(318)

list.create({"id":26,"name":"qt","tasks":[27,19,2,4,40,13,15,3,34,1]}).fn(319)

list.update({"id":23,"tasks":[38,25,22,9,12,7,9,12,36,32]}).fn(320)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.create({"id":27,"listId":9,"date":18441,"name":"cyysncshpbsyv","notes":"ddejocjlubvwflr","priority":2,"completed":72136}).fn(321)
[32m[user][0m [list] does not own 9

list.update({"id":1,"name":"fytegbzcq"}).fn(322)
[32m[user][0m [list] does not own 1
err_no_row

pref.update({"sort":19,"weekStart":38,"dateFormat":"hpcmrahfqxzipflsxwkt"}).fn(323)

list.destroy({"name":"xmkobunqughnffqeqjk","tasks":[9,13,15,5],"id":26}).fn(324)

list.update({"id":1}).fn(325)
err_invalid_model

pref.update({"dateFormat":"smwovwwtscespydxbn"}).fn(326)

task.create({"id":6,"listId":23,"date":73511,"name":"ydicoepmspionnsdlak","notes":"tp","priority":0,"completed":0}).fn(327)

list.create({"id":28,"name":"ibmdiwcymctqtvx","tasks":[4,35,18,11,32,26,41,4,18,11,5]}).fn(328)

task.destroy({"id":13,"listId":36,"date":0}).fn(329)
[32m[user][0m [task] does not own 13
err_no_row

task.create({"id":17,"listId":20,"date":0,"name":"ubombrqspkoy","notes":"","priority":3,"completed":18664}).fn(330)
[32m[user][0m [list] does not own 20

task.update({"date":0,"priority":2,"completed":1773,"id":30}).fn(331)
[32m[user][0m [task] does not own 30
err_no_row

list.update({"tasks":[35,12,19,23,6,17,39,4,2],"id":26}).fn(332)
[32m[user][0m [list] does not own 26
err_no_row

task.destroy({"id":23,"listId":25,"notes":"","completed":0}).fn(333)
[32m[user][0m [task] does not own 23
err_no_row

list.destroy({"id":3}).fn(334)

list.create({"id":2,"name":"uthcqkbltkmpg","tasks":[8,11,5,2,16]}).fn(335)

list.destroy({"name":"yieftxq","id":35}).fn(336)

list.update({"id":5}).fn(337)
err_invalid_model

list.update({"id":42,"name":"jahhlqufdiwhrtxdu","tasks":[15,16,3,9,3,41,17,16,34,23]}).fn(338)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":52,"language":"gbrygesicou","moveCompleted":2}).fn(339)

task.create({"id":10,"listId":14,"date":0,"name":"sronkvnyybw","notes":"","priority":2,"completed":0}).fn(340)
[32m[user][0m [list] does not own 14

list.update({"id":36}).fn(341)
err_invalid_model

pref.update({"sort":41,"night":25,"weekStart":31,"confirmDelete":83,"moveCompleted":59}).fn(342)

list.update({"id":6,"name":"rnrq"}).fn(343)
[32m[user][0m [list] does not own 6
err_no_row

pref.update({"sort":13,"night":36,"dateFormat":"neu","confirmDelete":49}).fn(344)

list.create({"id":1,"name":"imgtsffjs","tasks":[20,9]}).fn(345)

list.create({"id":38,"name":"q","tasks":[20,5,12,28]}).fn(346)

task.update({"id":2,"date":76235,"name":"wjcvwboicxtnhu","notes":"","completed":0}).fn(347)
[32m[user][0m [task] does not own 2
err_no_row

task.update({"id":40}).fn(348)
err_invalid_model

task.update({"date":94920,"priority":2,"id":27}).fn(349)
[32m[user][0m [task] does not own 27
err_no_row

pref.update({"sort":22,"weekStart":23,"moveCompleted":45}).fn(350)

pref.update({"sort":91,"night":47,"language":"dawnhvuponxjhfp","weekStart":41,"dateFormat":"touzhcyjoroavyly","moveCompleted":18}).fn(351)

list.create({"id":1,"name":"kicl","tasks":[10,1,28,32,15,7,21,0,9]}).fn(352)

task.update({"id":21,"listId":43,"date":38915,"notes":"wjjmbnotfyflhwuxl","priority":2,"completed":0}).fn(353)
[32m[user][0m [task] does not own 21
err_no_row

list.create({"id":2,"name":"erkiobakjbdnllukzkum","tasks":[16,25,33,29,23]}).fn(354)

pref.update({"language":"mfspuvqmcyu","weekStart":89}).fn(355)

list.update({"id":11}).fn(356)
err_invalid_model

pref.update({"sort":84,"night":17,"weekStart":30,"confirmDelete":60}).fn(357)

pref.update({"sort":49,"language":"tnesvbultxtrusbvloyg","dateFormat":"vxaijffpvs","confirmDelete":55}).fn(358)

list.destroy({"id":35,"name":"kydnghvsetxjgahwdyb"}).fn(359)
[32m[user][0m [list] does not own 35
err_no_row

list.create({"id":9,"name":"upmfnqa","tasks":[16]}).fn(360)

list.create({"id":8,"name":"xm","tasks":[31,39,3,35,3,12,27,10,45,5]}).fn(361)

pref.update({"language":"olnwwznobuhohikg","dateFormat":"k"}).fn(362)

list.create({"id":31,"name":"awsmclxt","tasks":[1,8,35,11]}).fn(363)

pref.update({"night":17,"language":"kpfuyqsos","weekStart":83,"moveCompleted":98}).fn(364)

list.update({"id":34}).fn(365)
err_invalid_model

task.destroy({"listId":24,"completed":0,"id":43}).fn(366)
[32m[user][0m [task] does not own 43
err_no_row

pref.update({"weekStart":96,"dateFormat":"vuk"}).fn(367)

pref.update({"sort":78,"confirmDelete":42,"moveCompleted":41}).fn(368)

list.update({"id":25,"tasks":[6,12,7,16,45,12,9,23,48]}).fn(369)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"name":"blwsq","tasks":[10,7,6,39,35,23,17,1,1],"id":48}).fn(370)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.update({"id":49,"date":0,"priority":1,"completed":0}).fn(371)
[32m[user][0m [task] does not own 49
err_no_row

pref.update({"weekStart":38,"confirmDelete":22,"moveCompleted":30}).fn(372)

list.destroy({"id":13,"name":"ejnymgzmxlfun"}).fn(373)

pref.update({"sort":34,"language":"bjsyhr","weekStart":19,"dateFormat":"kgtgbffwmb"}).fn(374)

list.update({"tasks":[20,24],"id":1}).fn(375)
[32m[user][0m [list] does not own 1
err_no_row

task.create({"id":20,"listId":19,"date":0,"name":"vuqkohpi","notes":"","priority":2,"completed":0}).fn(376)

list.destroy({"id":48}).fn(377)

pref.update({"night":4,"weekStart":75,"dateFormat":"dhnqkjviue"}).fn(378)

task.destroy({"id":10,"listId":9,"date":2019,"notes":"y","priority":1}).fn(379)

task.update({"name":"oooxvfqbuulhxoq","notes":"nlegkbkmntfdwyfw","priority":2,"completed":0,"id":35}).fn(380)
[32m[user][0m [task] does not own 35
err_no_row

task.create({"id":1,"listId":2,"date":0,"name":"vbvwrmvcrjqkohru","notes":"jddcl","priority":1,"completed":42268}).fn(381)
[32m[user][0m [list] does not own 2

list.create({"id":18,"name":"imubhakrrqixfjjkx","tasks":[30,11,28,3,3,7,47,17,32,2]}).fn(382)

list.create({"id":32,"name":"fcjxokjfqwtnwfytxldq","tasks":[2,30,32,20,21,6,22,5,40]}).fn(383)

task.destroy({"id":22,"listId":4,"notes":"dkjxvbmxzrwlhlnxgdx","priority":3}).fn(384)
[32m[user][0m [task] does not own 22
err_no_row

list.create({"id":52,"name":"sqjzvx","tasks":[33,10,1,42,33]}).fn(385)

list.destroy({"name":"xitpuutetyj","tasks":[14,11,45,19,20,41,37,29],"id":34}).fn(386)

list.update({"name":"wtzuitnxd","tasks":[15],"id":47}).fn(387)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.destroy({"listId":24,"name":"wicfeiyupkjzxtwo","notes":"rud","id":44}).fn(388)
[32m[user][0m [task] does not own 44
err_no_row

list.destroy({"id":10,"name":"kdwilvflp"}).fn(389)
[32m[user][0m [list] does not own 10
err_no_row

list.update({"id":1,"tasks":[2,3,4,52,17,41,9]}).fn(390)
[32m[user][0m [list] does not own 1
err_no_row

task.destroy({"date":41553,"name":"tpvixvpu","notes":"","id":15}).fn(391)
[32m[user][0m [task] does not own 15
err_no_row

task.create({"id":48,"listId":37,"date":58900,"name":"wlyetltfyfegdfhjvn","notes":"","priority":0,"completed":95969}).fn(392)

pref.update({"sort":72,"language":"wmcmheoutw","weekStart":100,"dateFormat":"nchtrobjm","confirmDelete":26}).fn(393)

pref.update({"sort":89,"language":"zmdwhrg","weekStart":76,"dateFormat":"ajieyxbrwwlf","confirmDelete":52}).fn(394)

pref.update({"night":56,"language":"xudyygdutfsfkw","moveCompleted":34}).fn(395)

list.create({"id":15,"name":"hyevmngx","tasks":[14,52,1,35,31,2]}).fn(396)

list.update({"id":30,"tasks":[12,7,45,37]}).fn(397)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"name":"scuwchuyfgbdcl","tasks":[31,0,38,9,4,1,4],"id":22}).fn(398)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.create({"id":1,"name":"iwfitqvqxsfvykgedn","tasks":[29,34,42,30,38,30,11,3,31,24]}).fn(399)

list.update({"id":17,"name":"wrdifvyvswp","tasks":[4,8,39,12,6]}).fn(400)
[32m[user][0m [list] does not own 17
err_no_row

list.create({"id":43,"name":"o","tasks":[2,24,32,52,20,10,35]}).fn(401)

task.destroy({"listId":14,"date":0,"name":"lnrcbkmfjtxql","notes":"","completed":85057,"id":3}).fn(402)
[32m[user][0m [task] does not own 3
err_no_row

list.destroy({"id":9,"name":"iu"}).fn(403)
[32m[user][0m [list] does not own 9
err_no_row

list.update({"id":54,"name":"bcki","tasks":[10,13,7,3,51,8,25,23,21,29]}).fn(404)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.destroy({"tasks":[22,38,22],"id":6}).fn(405)
[32m[user][0m [list] does not own 6
err_no_row

task.destroy({"id":5,"name":"rghvu","priority":1,"completed":36541}).fn(406)
[32m[user][0m [task] does not own 5
err_no_row

pref.update({"night":22,"confirmDelete":88}).fn(407)

pref.update({"night":71,"language":"nmnz","weekStart":89,"dateFormat":"zm"}).fn(408)

pref.update({"sort":66,"language":"bbnsszokjdfobwpt","dateFormat":"uobraxpnrgsv","confirmDelete":20,"moveCompleted":9}).fn(409)

list.update({"id":9}).fn(410)
err_invalid_model

list.destroy({"name":"osxelukqni","id":17}).fn(411)
[32m[user][0m [list] does not own 17
err_no_row

list.destroy({"id":13,"name":"frswswxxuxxvlbphlf","tasks":[18,52,9,52,4,34,10,4,41]}).fn(412)
[32m[user][0m [list] does not own 13
err_no_row

pref.update({"weekStart":36}).fn(413)

task.update({"notes":"fahiyus","completed":77869,"id":1}).fn(414)
[32m[user][0m [task] does not own 1
err_no_row

list.update({"id":3,"name":"ngzcundfken","tasks":[37,5,2,35,6,31,7]}).fn(415)
[32m[user][0m [list] does not own 3
err_no_row

task.destroy({"listId":14,"date":52422,"notes":"ewytvjglfxixdcmqibdm","completed":11940,"id":42}).fn(416)
[32m[user][0m [task] does not own 42
err_no_row

pref.update({"sort":58,"night":20,"dateFormat":"jnyp","moveCompleted":30}).fn(417)

list.destroy({"name":"egpby","id":11}).fn(418)

task.destroy({"priority":1,"completed":0,"id":1}).fn(419)
[32m[user][0m [task] does not own 1
err_no_row

task.create({"id":3,"listId":4,"date":0,"name":"jwxwcothjjuszijgqv","notes":"oonucjxymyqujnm","priority":2,"completed":99221}).fn(420)
[32m[user][0m [list] does not own 4

pref.update({"sort":51,"night":3,"language":"wpdhkimk","weekStart":76,"dateFormat":"vuyrhmiiobqqqucb","confirmDelete":68,"moveCompleted":98}).fn(421)

task.create({"id":7,"listId":10,"date":0,"name":"unsfan","notes":"","priority":0,"completed":4215}).fn(422)
[32m[user][0m [list] does not own 10

list.create({"id":27,"name":"ssgrwfksrkam","tasks":[19,5,7]}).fn(423)

task.update({"id":34,"date":0,"name":"ifnptyi"}).fn(424)
[32m[user][0m [task] does not own 34
err_no_row

task.destroy({"id":1,"listId":36,"date":58382,"name":"pthoigqyzguj","notes":"","priority":0}).fn(425)
[32m[user][0m [task] does not own 1
err_no_row

pref.update({"night":23,"language":"nlugwyynvxlvebwukjm","dateFormat":"pqx","confirmDelete":49}).fn(426)

task.update({"priority":1,"id":56}).fn(427)
[32m[user][0m [task] does not own 56
err_no_row

list.create({"id":35,"name":"cn","tasks":[56,0,10,43,39,13]}).fn(428)

list.update({"name":"tux","tasks":[55,30,29,7],"id":2}).fn(429)
[32m[user][0m [list] does not own 2
err_no_row

task.update({"date":0,"name":"ekbxcw","completed":52080,"id":47}).fn(430)
[32m[user][0m [task] does not own 47
err_no_row

pref.update({"sort":31,"night":87,"language":"bmxgbhffjlqxu","weekStart":1,"dateFormat":"nymltxextys"}).fn(431)

list.create({"id":14,"name":"cvlkcmefd","tasks":[20,12,15,8,22,30,11]}).fn(432)

list.update({"tasks":[28,54,24,1,32,1,34],"id":15}).fn(433)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":42,"tasks":[17,31,55,10,19,52,20,45,3,47]}).fn(434)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.create({"id":4,"listId":32,"date":48422,"name":"fljuihhbnzommz","notes":"","priority":2,"completed":69053}).fn(435)

list.destroy({"name":"ygrkwjmje","id":57}).fn(436)

list.update({"id":43,"name":"linrhqjdmutbxwpiiwayh","tasks":[12,20,37,44,57,39,5,43,37,26]}).fn(437)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.destroy({"id":13,"date":15461,"name":"kxpptpnpit","notes":"nuuq","priority":3,"completed":4762}).fn(438)

task.create({"id":41,"listId":1,"date":87598,"name":"zr","notes":"","priority":1,"completed":14390}).fn(439)
[32m[user][0m [list] does not own 1

list.update({"name":"otpfg","tasks":[42,1,27,20,43,31,9],"id":43}).fn(440)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.update({"priority":1,"completed":0,"id":0}).fn(441)
[32m[user][0m [task] does not own 0
err_no_row

task.update({"id":15,"name":"yyagvojvjlfqf","notes":"","priority":1}).fn(442)
[32m[user][0m [task] does not own 15
err_no_row

task.update({"listId":43,"date":3273,"name":"qbkevkhgu","id":42}).fn(443)
[32m[user][0m [task] does not own 42
err_no_row

list.create({"id":30,"name":"lreopluw","tasks":[17,50,23,25,28,36,40,18,31]}).fn(444)

pref.update({"sort":46,"language":"nwmeqbf","weekStart":6,"dateFormat":"osv","confirmDelete":70,"moveCompleted":98}).fn(445)

pref.update({"sort":14,"night":42,"language":"npiiwxupcxx","dateFormat":"bkvqkmfbdmfv"}).fn(446)

list.create({"id":28,"name":"qzop","tasks":[36]}).fn(447)

list.destroy({"name":"yisqwtiwwhlfrxjgd","id":9}).fn(448)
[32m[user][0m [list] does not own 9
err_no_row

pref.update({"weekStart":40,"moveCompleted":56}).fn(449)

list.create({"id":48,"name":"nrunmtmdwy","tasks":[38,61,53,15,58,1,61,5,39]}).fn(450)

pref.update({"sort":37,"language":"xxyllqsydagfh"}).fn(451)

list.create({"id":19,"name":"hm","tasks":[37,34,49,30]}).fn(452)

list.update({"id":24}).fn(453)
err_invalid_model

list.destroy({"name":"isosetbvtuskcdywy","tasks":[12,36,31,31,11,22,14,4,36,11,43],"id":25}).fn(454)

list.update({"id":42,"name":"volbtjl"}).fn(455)

pref.update({"night":19,"confirmDelete":89}).fn(456)

pref.update({"weekStart":55,"confirmDelete":93}).fn(457)

task.create({"id":48,"listId":31,"date":12982,"name":"snbgdcd","notes":"iwousinc","priority":0,"completed":41735}).fn(458)

list.destroy({"name":"upnvqrtrlmxuvjv","id":2}).fn(459)
[32m[user][0m [list] does not own 2
err_no_row

list.update({"tasks":[8,24,44,13,45,55,26,41],"id":17}).fn(460)
[32m[user][0m [list] does not own 17
err_no_row

task.create({"id":18,"listId":28,"date":54778,"name":"pppgodha","notes":"dopjyrsnd","priority":3,"completed":70695}).fn(461)
[32m[user][0m [list] does not own 28

pref.update({"sort":24,"language":"ff","confirmDelete":43}).fn(462)

task.update({"id":18,"listId":36,"date":5197,"priority":2}).fn(463)
[32m[user][0m [task] does not own 18
err_no_row

task.update({"date":36001,"completed":72642,"id":28}).fn(464)
[32m[user][0m [task] does not own 28
err_no_row

list.destroy({"id":23}).fn(465)

list.destroy({"id":42,"name":"pqglpvcr","tasks":[59,1,9,13,34]}).fn(466)

list.update({"id":21}).fn(467)
err_invalid_model

task.update({"date":0,"name":"gfdfgelxqxxf","notes":"vbrglmgwocpwypkp","id":12}).fn(468)

pref.update({"sort":19,"confirmDelete":88,"moveCompleted":2}).fn(469)

list.destroy({"id":2,"name":"wdooumejthzwtjj","tasks":[57,28,25,39,43]}).fn(470)
[32m[user][0m [list] does not own 2
err_no_row

task.destroy({"id":62,"notes":"nxftojsxnzwhsse","priority":2,"completed":11997}).fn(471)
[32m[user][0m [task] does not own 62
err_no_row

pref.update({"language":"xvojyhgw","moveCompleted":64}).fn(472)

task.update({"name":"vjup","notes":"ytmrplwdyathablhggxyt","priority":0,"completed":68954,"id":22}).fn(473)
[32m[user][0m [task] does not own 22
err_no_row

list.update({"name":"nvhpjhsyrnw","tasks":[8,9,34,54,12,56,15,47,26,23],"id":9}).fn(474)
[32m[user][0m [list] does not own 9
err_no_row

list.create({"id":3,"name":"onvspgimhltemzehtgrq","tasks":[12,54,38,61,18]}).fn(475)

task.create({"id":3,"listId":39,"date":0,"name":"iuboskvsbxkdiphogvthv","notes":"ondawdmgi","priority":1,"completed":0}).fn(476)

list.update({"id":3}).fn(477)
err_invalid_model

pref.update({"night":56,"weekStart":83,"confirmDelete":86}).fn(478)

list.update({"id":1}).fn(479)
err_invalid_model

pref.update({"language":"cgseopratzgkd","confirmDelete":51}).fn(480)

pref.update({"sort":63,"night":72,"weekStart":55,"dateFormat":"wbdguusxuurtjitie"}).fn(481)

list.destroy({"id":4,"name":"unmdcfaoqygdbks","tasks":[15,14,55,1,10,13,4,34,17]}).fn(482)
[32m[user][0m [list] does not own 4
err_no_row

list.create({"id":10,"name":"aeq","tasks":[52,51,44]}).fn(483)

pref.update({"sort":12,"weekStart":61,"confirmDelete":75,"moveCompleted":99}).fn(484)

list.create({"id":49,"name":"wbt","tasks":[31]}).fn(485)

pref.update({"night":53,"language":"h","weekStart":97,"dateFormat":"sldoxeofhoor","confirmDelete":63,"moveCompleted":53}).fn(486)

pref.update({"night":15,"language":"xwejkghscwjdmq","dateFormat":"digpghgditoclfpjbi","confirmDelete":22}).fn(487)

list.create({"id":8,"name":"eajketfxvewcnfswo","tasks":[10,9,59,28,40,52,61,54,22]}).fn(488)

pref.update({"sort":31,"night":9,"weekStart":25,"dateFormat":"jxornukuzipnbuiu","confirmDelete":54,"moveCompleted":97}).fn(489)

list.destroy({"id":2,"name":"oje","tasks":[19,28,47,18,15]}).fn(490)
[32m[user][0m [list] does not own 2
err_no_row

pref.update({"night":28,"confirmDelete":49,"moveCompleted":59}).fn(491)

list.update({"id":6,"tasks":[13,54,2,40,54,13,53,21]}).fn(492)
[32m[user][0m [list] does not own 6
err_no_row

pref.update({"weekStart":75,"dateFormat":"nldsacuhhbzkkgvxiowy","confirmDelete":80,"moveCompleted":59}).fn(493)

list.create({"id":7,"name":"lqhxooejeqcrrvbppgq","tasks":[6,8,10,28,41,23,22]}).fn(494)

list.update({"name":"tuiei","tasks":[37,12,26,13,4,11,3],"id":29}).fn(495)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":67,"language":"tgcmdefdfovwubrrinabg","weekStart":66,"moveCompleted":58}).fn(496)

list.destroy({"id":7,"name":"siexqdnsjsu","tasks":[4,63,58,4,13,32]}).fn(497)
[32m[user][0m [list] does not own 7
err_no_row

list.create({"id":10,"name":"fm","tasks":[53,61,65,41,19,17,29,16,2,3]}).fn(498)

list.update({"name":"lyjsoqkqopsuolfufcpk","tasks":[31,36,17,28,40,11,54,15],"id":22}).fn(499)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":7,"tasks":[6,32,56,5,10,4,6,4]}).fn(500)
[32m[user][0m [list] does not own 7
err_no_row

list.create({"id":52,"name":"bpzyptakzimfgiillq","tasks":[3,54,2,39,31]}).fn(501)

task.update({"listId":29,"date":0,"name":"colgjntgmuqmwxh","notes":"dfmeslubqjsk","id":2}).fn(502)
[32m[user][0m [task] does not own 2
err_no_row

pref.update({"sort":90,"night":76,"weekStart":26,"moveCompleted":26}).fn(503)

task.destroy({"id":6,"listId":27}).fn(504)
[32m[user][0m [task] does not own 6
err_no_row

list.create({"id":0,"name":"fhrbowewln","tasks":[59,1,32,10,35,5,36,32]}).fn(505)

list.update({"tasks":[7,63,65,7,42,35,68,20],"id":68}).fn(506)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.create({"id":44,"listId":14,"date":0,"name":"qpsnqzyqzyxnueuhrope","notes":"","priority":3,"completed":92263}).fn(507)
[32m[user][0m [list] does not own 14

list.destroy({"id":52}).fn(508)

task.create({"id":64,"listId":15,"date":0,"name":"seuoono","notes":"","priority":2,"completed":68092}).fn(509)

list.update({"id":39}).fn(510)
err_invalid_model

pref.update({"night":87,"language":"rm","dateFormat":"jpyqdlwtfgkx"}).fn(511)

list.update({"id":14}).fn(512)
err_invalid_model

list.create({"id":55,"name":"hwybwi","tasks":[31,60,22,27,22,11,67,12,69,39,43]}).fn(513)

pref.update({"sort":29,"confirmDelete":12}).fn(514)

list.update({"name":"nektdhkrylof","tasks":[25,56,23,70,1,7,61,27],"id":4}).fn(515)
[32m[user][0m [list] does not own 4
err_no_row

list.destroy({"name":"asrgdnakdltimrdvsx","id":15}).fn(516)

list.create({"id":8,"name":"hnfutgkgtwjgjyvqimu","tasks":[16,29]}).fn(517)

list.destroy({"id":46,"tasks":[38,32,46,11,59,40,26]}).fn(518)

list.update({"id":2}).fn(519)
err_invalid_model

task.create({"id":39,"listId":11,"date":79168,"name":"mfjibouwzdclltw","notes":"zltupotttbwwjcieu","priority":0,"completed":11955}).fn(520)
[32m[user][0m [list] does not own 11

list.update({"id":55,"tasks":[30,70,2,7,3,45,62,70,45,28,32]}).fn(521)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":52,"night":86,"weekStart":49,"confirmDelete":78,"moveCompleted":2}).fn(522)

list.destroy({"id":24,"name":"yibxieus"}).fn(523)

task.update({"date":0,"name":"dn","notes":"","priority":0,"id":26}).fn(524)
[32m[user][0m [task] does not own 26
err_no_row

list.destroy({"name":"ddqoqmlnqmedpksxebi","tasks":[18,15],"id":58}).fn(525)

pref.update({"night":12,"moveCompleted":45}).fn(526)

pref.update({"sort":83,"confirmDelete":17,"moveCompleted":68}).fn(527)

list.update({"id":28,"name":"oqhczxf"}).fn(528)
[32m[user][0m [list] does not own 28
err_no_row

list.create({"id":42,"name":"nviblcuhyuwpufbru","tasks":[3,40,39,56,48]}).fn(529)

pref.update({"sort":49,"night":49,"moveCompleted":86}).fn(530)

pref.update({"weekStart":28}).fn(531)

task.destroy({"date":82246,"notes":"tvfnzpyg","id":3}).fn(532)
[32m[user][0m [task] does not own 3
err_no_row

pref.update({"night":1,"language":"lfualwr","weekStart":12,"confirmDelete":12,"moveCompleted":28}).fn(533)

task.update({"id":68,"listId":52,"name":"wfdfviuswuaqy"}).fn(534)
[32m[user][0m [task] does not own 68
err_no_row

task.update({"listId":72,"date":48896,"priority":2,"id":16}).fn(535)
[32m[user][0m [task] does not own 16
err_no_row

pref.update({"sort":93,"language":"dwdunqcqmwnzukjp","weekStart":56,"confirmDelete":95}).fn(536)

task.update({"priority":3,"completed":0,"id":26}).fn(537)
[32m[user][0m [task] does not own 26
err_no_row

list.update({"name":"znhflygbsfdgntkw","tasks":[16,22,32,7],"id":15}).fn(538)
[32m[user][0m [list] does not own 15
err_no_row

list.update({"name":"zsgpvcgzpoeeuxng","tasks":[21,44,8],"id":65}).fn(539)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":9,"weekStart":44,"moveCompleted":92}).fn(540)

list.destroy({"id":7,"tasks":[8,47,41,4,12,3,25,56]}).fn(541)
[32m[user][0m [list] does not own 7
err_no_row

pref.update({"language":"kjobjlpge","dateFormat":"bhokfvgnynlxgqere","moveCompleted":21}).fn(542)

list.update({"id":12,"tasks":[32,9,63,62,70,68,11]}).fn(543)
[32m[user][0m [list] does not own 12
err_no_row

list.update({"name":"wyvnb","id":7}).fn(544)
[32m[user][0m [list] does not own 7
err_no_row

list.update({"id":16}).fn(545)
err_invalid_model

list.update({"tasks":[25,13,44,61],"id":66}).fn(546)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":48,"name":"vbywdnulwxly","tasks":[36,24,4,64,22,31,19,51]}).fn(547)
[32m[user][0m [list] does not own 48
err_no_row

task.update({"date":20346,"name":"fzfqpxjjowmcvqxkm","notes":"blasmlvrscx","completed":0,"id":14}).fn(548)

list.destroy({"id":46,"name":"kixapbltdfoxpxqmg"}).fn(549)
[32m[user][0m [list] does not own 46
err_no_row

list.create({"id":7,"name":"gbdtp","tasks":[57,54]}).fn(550)

pref.update({"sort":85,"night":9,"dateFormat":"pjfmptylmuz","moveCompleted":81}).fn(551)

list.update({"id":32,"name":"nbwymoo","tasks":[16,25,41,1,11,23,62,64,31]}).fn(552)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.destroy({"id":10,"date":0,"notes":"wmspfvgcqqnxvhxug"}).fn(553)
[32m[user][0m [task] does not own 10
err_no_row

task.update({"id":68,"notes":"","priority":1}).fn(554)
[32m[user][0m [task] does not own 68
err_no_row

list.update({"id":4}).fn(555)
err_invalid_model

pref.update({"sort":15,"weekStart":52,"dateFormat":"xfeqwa","confirmDelete":79,"moveCompleted":80}).fn(556)

pref.update({"sort":23,"night":67,"confirmDelete":41,"moveCompleted":57}).fn(557)

task.update({"listId":55,"date":0,"notes":"cjhxoxwcueyvqxc","priority":1,"completed":40822,"id":29}).fn(558)
[32m[user][0m [task] does not own 29
err_no_row

list.update({"id":1}).fn(559)
err_invalid_model

task.update({"listId":28,"name":"tjlxtwxvmehor","priority":1,"id":68}).fn(560)
[32m[user][0m [task] does not own 68
err_no_row

pref.update({"sort":48,"night":42,"language":"lexixcbxtjeqhmyrazndz","weekStart":100,"dateFormat":"clvxnrjelkqur","confirmDelete":48,"moveCompleted":35}).fn(561)

list.create({"id":27,"name":"u","tasks":[58,26,17,69,27,13,49,9]}).fn(562)

list.destroy({"id":21,"tasks":[55,67,70,9,51,64,31]}).fn(563)
[32m[user][0m [list] does not own 21
err_no_row

task.update({"id":76,"name":"vurziqfh","priority":1}).fn(564)
[32m[user][0m [task] does not own 76
err_no_row

pref.update({"night":21,"weekStart":40,"confirmDelete":16}).fn(565)

list.update({"id":14,"tasks":[68,13,42,50,19]}).fn(566)
[32m[user][0m [list] does not own 14
err_no_row

task.update({"priority":1,"completed":0,"id":44}).fn(567)
[32m[user][0m [task] does not own 44
err_no_row

list.create({"id":6,"name":"iyc","tasks":[58,35,49,75,18]}).fn(568)

list.destroy({"name":"xej","tasks":[58,31,6,20,40,3,57,12,31],"id":23}).fn(569)
[32m[user][0m [list] does not own 23
err_no_row

pref.update({"sort":66,"language":"tteebpwvotyphxtvl","confirmDelete":55}).fn(570)

task.destroy({"id":42,"listId":40,"date":0,"name":"dpcchuwmnvk","notes":"","priority":1,"completed":49152}).fn(571)
[32m[user][0m [task] does not own 42
err_no_row

list.update({"tasks":[50,65,48,21,51,36,1,72,27,20,41],"id":20}).fn(572)
[32m[user][0m [list] does not own 20
err_no_row

list.create({"id":1,"name":"hxdjnybjbtur","tasks":[37,70,70,2]}).fn(573)

list.create({"id":25,"name":"xgmfvlswotmxomz","tasks":[62,41,16,12,19,25,54,3,7,10,54]}).fn(574)

list.update({"name":"qkoyehvi","id":11}).fn(575)
[32m[user][0m [list] does not own 11
err_no_row

list.destroy({"name":"ovyjrhkelsjbeyilecmqs","tasks":[6,2,29,78,60,36,23,4,12],"id":60}).fn(576)

pref.update({"weekStart":51,"dateFormat":"qylcbcrpovwirzpnyl","confirmDelete":18,"moveCompleted":55}).fn(577)

list.create({"id":27,"name":"tijkgmh","tasks":[6,44,4]}).fn(578)

task.create({"id":14,"listId":19,"date":0,"name":"bx","notes":"","priority":1,"completed":28738}).fn(579)

pref.update({"sort":27,"night":8,"weekStart":98,"moveCompleted":48}).fn(580)

list.destroy({"id":59}).fn(581)

task.create({"id":47,"listId":10,"date":49878,"name":"dnmo","notes":"uvz","priority":2,"completed":50763}).fn(582)
[32m[user][0m [list] does not own 10

task.destroy({"priority":0,"completed":0,"id":69}).fn(583)
[32m[user][0m [task] does not own 69
err_no_row

list.destroy({"id":1}).fn(584)
[32m[user][0m [list] does not own 1
err_no_row

list.update({"id":58,"tasks":[54,60]}).fn(585)
[32m[user][0m [list] does not own 58
err_no_row

list.create({"id":62,"name":"bypxncelsdx","tasks":[71,24,65,52]}).fn(586)

task.destroy({"id":51,"date":25538,"notes":"ygjxypverqegsexjv"}).fn(587)
[32m[user][0m [task] does not own 51
err_no_row

pref.update({"sort":18,"night":97,"confirmDelete":90,"moveCompleted":32}).fn(588)

list.create({"id":12,"name":"ahcinrwh","tasks":[28,56,72,68,62,62,19,27,17,7]}).fn(589)

list.destroy({"id":73,"name":"ajdvnfkcycbcuewecvik","tasks":[58,43,8,16,69,36,5,71,55,44]}).fn(590)

list.update({"id":67}).fn(591)
err_invalid_model

list.update({"name":"elgkvfygyockabqumihub","tasks":[15,80,19,63,46,9,52,72,42,27],"id":2}).fn(592)
[32m[user][0m [list] does not own 2
err_no_row

list.update({"id":70,"name":"yvswv"}).fn(593)

list.create({"id":1,"name":"uskholuuo","tasks":[65,5,2,9]}).fn(594)

list.update({"id":66}).fn(595)
err_invalid_model

task.update({"id":21,"date":0,"notes":"bdegrmdkrgtpy","priority":2,"completed":0}).fn(596)
[32m[user][0m [task] does not own 21
err_no_row

pref.update({"sort":75,"weekStart":77,"confirmDelete":89,"moveCompleted":53}).fn(597)

pref.update({"sort":66,"night":87,"weekStart":63,"dateFormat":"dxkfipsw","confirmDelete":81,"moveCompleted":2}).fn(598)

list.destroy({"id":6}).fn(599)
[32m[user][0m [list] does not own 6
err_no_row

list.destroy({"id":32,"name":"rklfmzbfxhsc"}).fn(600)

pref.update({"night":65,"language":"xwrhnrfxrutrosebqn","weekStart":60,"dateFormat":"mw","confirmDelete":92,"moveCompleted":31}).fn(601)

pref.update({"night":85,"language":"orhegimnh","dateFormat":"kxlzkkppqhhki","confirmDelete":51,"moveCompleted":85}).fn(602)

list.destroy({"name":"ibjkmtetzj","id":23}).fn(603)
[32m[user][0m [list] does not own 23
err_no_row

list.update({"name":"rulprwccnc","tasks":[23,39,58,21],"id":26}).fn(604)
[32m[user][0m [list] does not own 26
err_no_row

pref.update({"language":"rfmmbkkqneqymj"}).fn(605)

pref.update({"weekStart":54,"dateFormat":"lynupnexulblkexoohdy","moveCompleted":69}).fn(606)

task.update({"date":0,"name":"rhelgpgtjfdmgrdyetck","completed":0,"id":18}).fn(607)
[32m[user][0m [task] does not own 18
err_no_row

list.update({"tasks":[72,74,21,67],"id":64}).fn(608)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":36,"name":"krwvkewt"}).fn(609)

list.create({"id":51,"name":"nc","tasks":[62,58,22,9]}).fn(610)

list.update({"tasks":[13],"id":76}).fn(611)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":86,"language":"kgjwoprir","confirmDelete":94}).fn(612)

pref.update({"language":"ofptiytnp","dateFormat":"eijxhboftviiwnmilefjj","moveCompleted":35}).fn(613)

pref.update({"language":"qcsrw","confirmDelete":27}).fn(614)

pref.update({"night":21,"dateFormat":"uehhcxkcpsj","confirmDelete":83,"moveCompleted":72}).fn(615)

list.destroy({"tasks":[83,6,78,10,40,67,74,12,16,15],"id":39}).fn(616)

task.update({"id":20,"listId":59,"date":0,"name":"wtliqvd","notes":"","priority":2}).fn(617)
[32m[user][0m [task] does not own 20
err_no_row

list.create({"id":9,"name":"fmqmn","tasks":[66,68,54,1,10,16,23,57,82]}).fn(618)

list.update({"id":30}).fn(619)
err_invalid_model

pref.update({"night":24,"language":"qrppkydqwkvxdphjrhhq","weekStart":35,"moveCompleted":6}).fn(620)

task.update({"id":16,"name":"msxjklypsw","notes":"ppitjqfgeinx","priority":1}).fn(621)
[32m[user][0m [task] does not own 16
err_no_row

list.update({"name":"zvfujku","tasks":[45,1,33],"id":39}).fn(622)
[32m[user][0m [list] does not own 39
err_no_row

list.create({"id":6,"name":"pckibwpzl","tasks":[8,80,38,73,81,69,65]}).fn(623)

list.update({"id":79}).fn(624)
err_invalid_model

list.update({"id":5,"name":"fmvkiwjqrdolocjolbhr"}).fn(625)
[32m[user][0m [list] does not own 5
err_no_row

task.destroy({"id":40,"notes":"","priority":1}).fn(626)
[32m[user][0m [task] does not own 40
err_no_row

task.update({"listId":68,"date":20275,"id":32}).fn(627)
[32m[user][0m [task] does not own 32
err_no_row

task.update({"completed":60700,"id":26}).fn(628)
[32m[user][0m [task] does not own 26
err_no_row

pref.update({"dateFormat":"nysfm","moveCompleted":37}).fn(629)

task.create({"id":12,"listId":1,"date":6539,"name":"hnhizvnogofuhv","notes":"qctv","priority":1,"completed":73544}).fn(630)
[32m[user][0m [list] does not own 1

task.create({"id":60,"listId":10,"date":0,"name":"nccabjdhiplwmigphoa","notes":"vmwsalvqcovs","priority":2,"completed":0}).fn(631)
[32m[user][0m [list] does not own 10

list.update({"id":31,"name":"qhkwqwmypgzcknne"}).fn(632)

list.update({"id":57,"name":"gvybhlldcfecbvbkl","tasks":[49,10,65,38,59,18,68]}).fn(633)
[32m[user][0m [list] does not own 57
err_no_row

list.create({"id":86,"name":"jrpwlheturxjcwueukwm","tasks":[70,4,36,86,24]}).fn(634)

list.update({"id":26}).fn(635)
err_invalid_model

task.destroy({"listId":66,"date":88367,"id":19}).fn(636)
[32m[user][0m [task] does not own 19
err_no_row

list.update({"id":65}).fn(637)
err_invalid_model

task.create({"id":37,"listId":83,"date":49081,"name":"legbtshjtgd","notes":"","priority":2,"completed":69139}).fn(638)

list.destroy({"id":74,"tasks":[5,32,25,29,15,57,76,39,87,72]}).fn(639)

pref.update({"weekStart":36,"dateFormat":"nmioqfkqombvqrjggc","confirmDelete":68,"moveCompleted":11}).fn(640)

task.create({"id":3,"listId":50,"date":10300,"name":"tzazknehuscwg","notes":"","priority":3,"completed":53627}).fn(641)

list.create({"id":32,"name":"lronkyegrdxwsjycqaxlf","tasks":[87,17,84,87,78,39,71]}).fn(642)

task.update({"id":43,"name":"fydkmunhiicrisrq","notes":"","priority":2,"completed":92643}).fn(643)
[32m[user][0m [task] does not own 43
err_no_row

pref.update({"sort":52,"night":67,"language":"uwsqs","weekStart":78,"dateFormat":"w"}).fn(644)

task.create({"id":8,"listId":32,"date":0,"name":"jdgcsuopxqbbj","notes":"","priority":1,"completed":0}).fn(645)
[32m[user][0m [list] does not own 32

pref.update({"sort":49,"weekStart":23}).fn(646)

list.destroy({"name":"qhowfn","id":11}).fn(647)
[32m[user][0m [list] does not own 11
err_no_row

task.destroy({"id":39,"name":"wssdpn","notes":"","priority":2,"completed":0}).fn(648)
[32m[user][0m [task] does not own 39
err_no_row

list.create({"id":74,"name":"invmpdsgheohdnh","tasks":[62,61,30,6,1,63,66,22]}).fn(649)

list.update({"name":"zvxobybnkgcuxfitgtj","tasks":[75,11,3,5,25,18,71,85,81,45,34],"id":19}).fn(650)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.create({"id":12,"name":"qvgm","tasks":[14,31,61,55,88,30,24]}).fn(651)

list.create({"id":2,"name":"gikdkt","tasks":[74,62,48,61,12]}).fn(652)

pref.update({"sort":44,"language":"pfkqqxmfmlbq","weekStart":52}).fn(653)

pref.update({"sort":97,"weekStart":91,"dateFormat":"igry","confirmDelete":70}).fn(654)

task.create({"id":10,"listId":81,"date":50537,"name":"mc","notes":"","priority":2,"completed":2603}).fn(655)

pref.update({"sort":63,"language":"bwjglkxyxpfwguh","weekStart":55,"confirmDelete":64}).fn(656)

list.update({"id":41,"tasks":[87,8,78,41]}).fn(657)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.update({"id":60,"priority":3,"completed":0}).fn(658)
[32m[user][0m [task] does not own 60
err_no_row

pref.update({"language":"iqtrhmqmquysedjpj","dateFormat":"vwd"}).fn(659)

task.create({"id":3,"listId":13,"date":72433,"name":"sopmtlxkhhkus","notes":"","priority":0,"completed":0}).fn(660)
[32m[user][0m [list] does not own 13

list.destroy({"name":"i","tasks":[15,57,53,65,59],"id":2}).fn(661)
[32m[user][0m [list] does not own 2
err_no_row

list.create({"id":14,"name":"lxxkzozqhn","tasks":[13,58,2,6,68,22,6,28]}).fn(662)

list.destroy({"id":1,"name":"tblwexgvxs"}).fn(663)
[32m[user][0m [list] does not own 1
err_no_row

list.destroy({"id":47}).fn(664)

list.destroy({"name":"lapexwiksyjyum","id":52}).fn(665)
[32m[user][0m [list] does not own 52
err_no_row

list.update({"id":66}).fn(666)
err_invalid_model

pref.update({"dateFormat":"zyqqcmlyvtyadfkcffmy","moveCompleted":1}).fn(667)

pref.update({"language":"uophxadswihcefqemx"}).fn(668)

task.update({"id":2,"date":0,"name":"bbefltyefrsido","priority":1,"completed":0}).fn(669)
[32m[user][0m [task] does not own 2
err_no_row

task.destroy({"id":78,"listId":1,"date":51263,"priority":1}).fn(670)
[32m[user][0m [task] does not own 78
err_no_row

list.update({"tasks":[13,89,70,1,37,19,33,59],"id":60}).fn(671)
[32m[user][0m [list] does not own 60
err_no_row

task.update({"id":81,"listId":69,"date":0,"name":"ilaevrfpcmaqhubzihc","priority":2}).fn(672)
[32m[user][0m [task] does not own 81
err_no_row

list.update({"tasks":[13,87,36,17,76,41,26,78,5,8,10],"id":14}).fn(673)
[32m[user][0m [list] does not own 14
err_no_row

task.destroy({"id":24,"listId":8,"completed":0}).fn(674)
[32m[user][0m [task] does not own 24
err_no_row

task.create({"id":42,"listId":20,"date":0,"name":"juqnllkqviucyrasfdo","notes":"dleixsuuolanu","priority":3,"completed":26157}).fn(675)
[32m[user][0m [list] does not own 20

pref.update({"night":15,"confirmDelete":42}).fn(676)

list.update({"id":86}).fn(677)
err_invalid_model

pref.update({"language":"nhmyzqexyfcysmxahru","weekStart":45,"dateFormat":"vuntftijq","moveCompleted":38}).fn(678)

list.create({"id":82,"name":"xkiplgdwhqhndcwz","tasks":[20,60,20]}).fn(679)

list.update({"tasks":[44,8,79,20],"id":41}).fn(680)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"confirmDelete":52}).fn(681)

list.update({"id":4}).fn(682)
err_invalid_model

task.update({"listId":86,"date":41791,"notes":"ovzdtpyywmirslyy","priority":3,"id":79}).fn(683)
[32m[user][0m [task] does not own 79
err_no_row

task.destroy({"listId":7,"date":0,"notes":"chschxcdjebftqkw","completed":43233,"id":15}).fn(684)
[32m[user][0m [task] does not own 15
err_no_row

task.create({"id":4,"listId":69,"date":1975,"name":"oy","notes":"","priority":1,"completed":0}).fn(685)

task.update({"notes":"","id":56}).fn(686)
[32m[user][0m [task] does not own 56
err_no_row

list.create({"id":82,"name":"vqrssvr","tasks":[90,38,91,59]}).fn(687)

list.destroy({"tasks":[38,4,10,50,38],"id":20}).fn(688)
[32m[user][0m [list] does not own 20
err_no_row

pref.update({"sort":55,"night":52,"weekStart":9,"dateFormat":"vqjbdaftfkrmu","confirmDelete":54}).fn(689)

pref.update({"weekStart":32,"dateFormat":"nguuerdbvdr","confirmDelete":50}).fn(690)

task.update({"id":31,"listId":3,"date":36447,"name":"nwunfqechl","priority":0}).fn(691)
[32m[user][0m [task] does not own 31
err_no_row

task.destroy({"date":0,"name":"jkk","completed":0,"id":42}).fn(692)
[32m[user][0m [task] does not own 42
err_no_row

pref.update({"sort":7,"language":"rlzpnzojjsfedrmj","weekStart":82,"moveCompleted":18}).fn(693)

list.update({"id":40}).fn(694)
err_invalid_model

task.create({"id":18,"listId":87,"date":0,"name":"vyj","notes":"tpkqwcj","priority":3,"completed":0}).fn(695)

list.update({"id":10}).fn(696)
err_invalid_model

list.create({"id":18,"name":"sovaleckgplxrefoldcbj","tasks":[14,66,29]}).fn(697)

pref.update({"night":22,"language":"thjmpukhbyxdtfpgmaot","weekStart":50,"dateFormat":"wlgeb","confirmDelete":50,"moveCompleted":62}).fn(698)

list.destroy({"name":"hnnpysdxhclbgoyrqzi","tasks":[61,3,15,23],"id":1}).fn(699)
[32m[user][0m [list] does not own 1
err_no_row

pref.update({"night":7,"weekStart":61,"dateFormat":"elyhrwiliceyhhcxyggk","confirmDelete":94}).fn(700)

task.destroy({"listId":19,"date":0,"name":"njhetq","notes":"hoysgnmiinnfuhr","completed":84706,"id":65}).fn(701)
[32m[user][0m [task] does not own 65
err_no_row

list.update({"name":"gejh","id":27}).fn(702)

pref.update({"weekStart":24,"dateFormat":"hwawfdtqmuxym"}).fn(703)

list.create({"id":23,"name":"nyjl","tasks":[37,62,92,84,83,39,19]}).fn(704)

task.create({"id":3,"listId":40,"date":24742,"name":"j","notes":"lfhsvencnxqfmp","priority":3,"completed":0}).fn(705)

pref.update({"night":42,"dateFormat":"gylmogmgqsewngzhps","confirmDelete":69,"moveCompleted":12}).fn(706)

list.create({"id":53,"name":"ejbplwftrzlbvvrxs","tasks":[19,51]}).fn(707)

list.update({"id":32}).fn(708)
err_invalid_model

list.update({"id":90}).fn(709)
err_invalid_model

pref.update({"sort":69,"night":24,"language":"pfyqfpfalqzz","dateFormat":"junylh","confirmDelete":20}).fn(710)

pref.update({"night":10,"language":"lbcaxxsxqgebehgx","weekStart":55,"dateFormat":"rbhidwxwrgfjpwlhi","moveCompleted":85}).fn(711)

list.destroy({"name":"advapbtgtatitiok","id":56}).fn(712)

pref.update({"sort":27,"night":10,"dateFormat":"ktgjqcl","confirmDelete":37,"moveCompleted":22}).fn(713)

pref.update({"weekStart":64,"dateFormat":"rsjzuuqiy","confirmDelete":28,"moveCompleted":15}).fn(714)

pref.update({"dateFormat":"uohabuoplln","confirmDelete":6,"moveCompleted":57}).fn(715)

list.destroy({"id":40}).fn(716)

pref.update({"sort":63,"night":70,"language":"nepsslxlc","weekStart":9,"dateFormat":"vtvsrnofprswcrt"}).fn(717)

pref.update({"language":"dhstdhd","weekStart":9,"dateFormat":"kxugrrjpdlygfdf","confirmDelete":96,"moveCompleted":18}).fn(718)

list.update({"id":5,"name":"jsopbihznd","tasks":[74,42]}).fn(719)
[32m[user][0m [list] does not own 5
err_no_row

list.create({"id":30,"name":"rucocs","tasks":[65,19,61,13,34,75,52]}).fn(720)

task.create({"id":12,"listId":80,"date":67378,"name":"yeldiiusxgm","notes":"","priority":1,"completed":14556}).fn(721)

list.create({"id":80,"name":"juhzcmpv","tasks":[44,42,62,53,55,61,12,11]}).fn(722)

task.update({"listId":96,"id":23}).fn(723)
[32m[user][0m [task] does not own 23
err_no_row

list.create({"id":21,"name":"wjuyhifkpl","tasks":[8,11,53,61,87,71,77,31]}).fn(724)

list.update({"tasks":[56,68],"id":6}).fn(725)
[32m[user][0m [list] does not own 6
err_no_row

list.destroy({"name":"namkosvqqtdfbx","tasks":[59,84,2,68,52,6,23,12,84],"id":73}).fn(726)
[32m[user][0m [list] does not own 73
err_no_row

pref.update({"sort":47,"weekStart":53,"dateFormat":"crcdchwwmbcptqv","confirmDelete":94,"moveCompleted":71}).fn(727)

pref.update({"night":8,"language":"czhriwoxsrtqdl","weekStart":22,"confirmDelete":86}).fn(728)

task.update({"id":45}).fn(729)
err_invalid_model

pref.update({"sort":53,"night":30}).fn(730)

pref.update({"sort":99,"weekStart":29,"dateFormat":"rnkkoqoorhwzck"}).fn(731)

task.update({"id":43,"listId":76,"notes":"qowuwphrxvahv","completed":0}).fn(732)
[32m[user][0m [task] does not own 43
err_no_row

task.create({"id":44,"listId":47,"date":52298,"name":"cjihdroomwryqyzwrl","notes":"lmxtufkvpc","priority":0,"completed":0}).fn(733)
[32m[user][0m [list] does not own 47

task.update({"listId":31,"date":0,"name":"gpvtc","id":28}).fn(734)
[32m[user][0m [task] does not own 28
err_no_row

pref.update({"sort":76,"weekStart":26,"confirmDelete":37}).fn(735)

task.update({"id":39,"listId":1,"date":75323,"name":"btr","priority":1}).fn(736)
[32m[user][0m [task] does not own 39
err_no_row

pref.update({"sort":21,"language":"winmaricwxtplcuz","dateFormat":"ctqn","confirmDelete":93}).fn(737)

pref.update({"night":84,"language":"cd","weekStart":75,"confirmDelete":55,"moveCompleted":82}).fn(738)

task.update({"id":79,"name":"shsxggi"}).fn(739)
[32m[user][0m [task] does not own 79
err_no_row

list.update({"id":81}).fn(740)
err_invalid_model

pref.update({"night":50,"dateFormat":"vjojrlaovlwgyfcqez","moveCompleted":11}).fn(741)

list.destroy({"id":3,"name":"pklrzgmvp"}).fn(742)
[32m[user][0m [list] does not own 3
err_no_row

list.destroy({"tasks":[23,12,27,72,60],"id":100}).fn(743)

list.update({"name":"bbnsaweau","tasks":[40,86,8,35,80,75,1,86],"id":81}).fn(744)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"tasks":[6,8,57,2,31,80],"id":16}).fn(745)
[32m[user][0m [list] does not own 16
err_no_row

list.destroy({"id":25,"name":"okbvpkcfendmizhc","tasks":[11,5,51,28,22,78,16,100]}).fn(746)
[32m[user][0m [list] does not own 25
err_no_row

task.create({"id":14,"listId":3,"date":96434,"name":"vvmvahxykbp","notes":"ezcbtjnqmkckfwpx","priority":2,"completed":0}).fn(747)
[32m[user][0m [list] does not own 3

task.create({"id":23,"listId":65,"date":0,"name":"vtblcpjfpvq","notes":"","priority":2,"completed":0}).fn(748)

list.create({"id":37,"name":"psq","tasks":[14,12,9,44,45,87]}).fn(749)

task.update({"id":17,"listId":47,"date":0,"name":"gcpxnptrwnbsajquoxck","priority":2,"completed":15560}).fn(750)
[32m[user][0m [list] does not own 47

list.update({"id":94}).fn(751)
err_invalid_model

list.destroy({"name":"oqvjfboejstxksvdabur","id":53}).fn(752)

list.update({"id":19}).fn(753)
err_invalid_model

list.update({"id":16}).fn(754)
err_invalid_model

list.create({"id":90,"name":"cfisfgmvlggsev","tasks":[48,19,1,10,85,76,87]}).fn(755)

pref.update({"sort":94,"night":39,"language":"ctrqbugogjpdemnk","weekStart":6,"dateFormat":"upnoscfwicjbydpzrpxq","confirmDelete":16}).fn(756)

list.destroy({"id":93,"name":"fb"}).fn(757)

list.update({"tasks":[18],"id":48}).fn(758)
[32m[user][0m [list] does not own 48
err_no_row

list.destroy({"id":94,"name":"jkfn","tasks":[17,14,6,3,45,42,34,73,78,9,77]}).fn(759)

task.destroy({"listId":5,"date":18034,"name":"lvsdgmgsbv","priority":1,"id":12}).fn(760)

task.update({"id":16,"listId":11,"date":0,"notes":"qppytknkmbnyh"}).fn(761)
[32m[user][0m [task] does not own 16
err_no_row

pref.update({"language":"vpdmfolzxjkytxnm","weekStart":11,"dateFormat":"q","moveCompleted":96}).fn(762)

list.update({"name":"autwmxxglj","tasks":[20,24,28,96,101,40,11],"id":31}).fn(763)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"name":"qy","id":14}).fn(764)
[32m[user][0m [list] does not own 14
err_no_row

list.create({"id":31,"name":"ipdws","tasks":[13,1,88,98,85,87,78]}).fn(765)

pref.update({"night":66,"weekStart":21}).fn(766)

list.update({"id":3,"name":"jekellcjgg","tasks":[96,1]}).fn(767)
[32m[user][0m [list] does not own 3
err_no_row

list.destroy({"name":"bneu","tasks":[3,83,79,62,1,8,74,12,21],"id":1}).fn(768)
[32m[user][0m [list] does not own 1
err_no_row

list.update({"name":"cdhjhpbuktdhj","id":11}).fn(769)
[32m[user][0m [list] does not own 11
err_no_row

list.destroy({"name":"brnpaipynj","tasks":[87,15,5],"id":55}).fn(770)

pref.update({"sort":15,"night":30,"language":"yhrkcklqo","weekStart":30,"dateFormat":"frzbuwhnvfglaskoira","confirmDelete":69,"moveCompleted":39}).fn(771)

task.destroy({"date":28102,"notes":"wxck","priority":2,"id":56}).fn(772)
[32m[user][0m [task] does not own 56
err_no_row

task.destroy({"listId":25,"notes":"qkrcpftfgq","id":13}).fn(773)
[32m[user][0m [task] does not own 13
err_no_row

task.destroy({"listId":33,"id":10}).fn(774)
[32m[user][0m [task] does not own 10
err_no_row

task.destroy({"id":102,"listId":83,"date":44896,"name":"egustcwdgnhfmbhsfqwdx","notes":"ecj","priority":1,"completed":80797}).fn(775)
[32m[user][0m [task] does not own 102
err_no_row

list.update({"id":11}).fn(776)
err_invalid_model

task.create({"id":40,"listId":98,"date":22608,"name":"rgutyywbznzesabcwnrdz","notes":"","priority":3,"completed":81352}).fn(777)

list.create({"id":23,"name":"bwsntizyqulrirbehr","tasks":[19,6,63,29]}).fn(778)

list.create({"id":18,"name":"buwelvhvdxccbpi","tasks":[76,18,5,78,20,4,27,93]}).fn(779)

list.update({"id":70}).fn(780)
err_invalid_model

list.create({"id":22,"name":"mdg","tasks":[8,46,67,22,81]}).fn(781)

list.destroy({"name":"cxrmsteuwjvtwy","id":89}).fn(782)

list.destroy({"name":"xyjykjqvfqxtzhq","id":76}).fn(783)

pref.update({"sort":48,"language":"jr","dateFormat":"ljnnxe","confirmDelete":88,"moveCompleted":68}).fn(784)

list.update({"id":96}).fn(785)
err_invalid_model

task.update({"date":51147,"notes":"","priority":1,"completed":0,"id":86}).fn(786)
[32m[user][0m [task] does not own 86
err_no_row

pref.update({"sort":99,"weekStart":91,"dateFormat":"apdsttkyuagp"}).fn(787)

list.update({"id":89}).fn(788)
err_invalid_model

pref.update({"sort":26,"weekStart":98,"dateFormat":"btyywfqvlhqjxhonyqwj","confirmDelete":73}).fn(789)

list.update({"name":"loodsxrbaszceeufrnjmk","id":3}).fn(790)
[32m[user][0m [list] does not own 3
err_no_row

list.create({"id":15,"name":"cel","tasks":[16,49,69,54,25,52,33,5,85]}).fn(791)

list.update({"id":50}).fn(792)
err_invalid_model

pref.update({"night":91,"language":"gwtspkxl","dateFormat":"gilehvhbwcntmjmqwwriq"}).fn(793)

pref.update({"weekStart":24}).fn(794)

pref.update({"sort":49,"moveCompleted":21}).fn(795)

task.update({"listId":52,"notes":"","priority":0,"id":24}).fn(796)
[32m[user][0m [list] does not own 52

list.update({"id":58}).fn(797)
err_invalid_model

list.update({"id":76,"tasks":[46,76]}).fn(798)
[32m[user][0m [list] does not own 76
err_no_row

task.update({"id":102,"name":"nhadnjsik","priority":3}).fn(799)
[32m[user][0m [task] does not own 102
err_no_row

task.destroy({"listId":8,"id":82}).fn(800)
[32m[user][0m [task] does not own 82
err_no_row

list.destroy({"id":26,"name":"sqmxxnxfgcm"}).fn(801)
[32m[user][0m [list] does not own 26
err_no_row

pref.update({"sort":60,"night":83,"weekStart":58,"moveCompleted":29}).fn(802)

list.update({"id":14,"name":"tgcoklnbiv"}).fn(803)
[32m[user][0m [list] does not own 14
err_no_row

task.update({"id":94,"listId":12,"date":20166,"notes":"cmfghxzkqkjaccbts","priority":2,"completed":93859}).fn(804)
[32m[user][0m [task] does not own 94
err_no_row

task.update({"notes":"hehn","completed":0,"id":77}).fn(805)
[32m[user][0m [task] does not own 77
err_no_row

list.update({"tasks":[79,34],"id":88}).fn(806)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"language":"hlnjjkokvf","moveCompleted":1}).fn(807)

task.create({"id":99,"listId":1,"date":48736,"name":"uxfqrelucmfcsbt","notes":"","priority":2,"completed":65731}).fn(808)
[32m[user][0m [list] does not own 1

task.create({"id":24,"listId":4,"date":94342,"name":"zuhqeucx","notes":"","priority":2,"completed":0}).fn(809)
[32m[user][0m [list] does not own 4

list.update({"name":"yjqwbhuwpwhbikugvu","id":16}).fn(810)
[32m[user][0m [list] does not own 16
err_no_row

task.destroy({"listId":44,"name":"drxvrxfkmhnrfv","completed":3311,"id":72}).fn(811)
[32m[user][0m [task] does not own 72
err_no_row

task.update({"id":3,"priority":3,"completed":62497}).fn(812)
[32m[user][0m [task] does not own 3
err_no_row

task.destroy({"id":69,"name":"otjhoocbfw","notes":"txcjywomgitjkafli","priority":2,"completed":58028}).fn(813)
[32m[user][0m [task] does not own 69
err_no_row

task.destroy({"date":71365,"notes":"whtfmbsicmjrx","completed":99340,"id":69}).fn(814)
[32m[user][0m [task] does not own 69
err_no_row

task.update({"id":66,"listId":10,"date":0,"priority":3,"completed":0}).fn(815)
[32m[user][0m [task] does not own 66
err_no_row

task.update({"listId":22,"name":"cyzqtqsdratzxyow","notes":"yutiq","priority":2,"id":19}).fn(816)

list.update({"name":"xinxbjxypufcsrxuofke","id":36}).fn(817)

pref.update({"language":"neipymnwshpynopesguj","dateFormat":"peeumdqwrycuvsorwb","confirmDelete":10,"moveCompleted":57}).fn(818)

list.update({"name":"anqx","tasks":[98,44,56,24,15,32,10,58],"id":22}).fn(819)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.update({"name":"efakbj","completed":0,"id":74}).fn(820)
[32m[user][0m [task] does not own 74
err_no_row

task.update({"id":13,"listId":11,"date":15579,"name":"pjfcygjcw","priority":2,"completed":47374}).fn(821)
[32m[user][0m [task] does not own 13
err_no_row

list.update({"tasks":[78,71,44,11,1],"id":19}).fn(822)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"tasks":[17,13],"id":56}).fn(823)
[32m[user][0m [list] does not own 56
err_no_row

list.update({"id":17,"tasks":[92,92,60,19,64,98,72,106,11,14,68]}).fn(824)
[32m[user][0m [list] does not own 17
err_no_row

pref.update({"night":25,"weekStart":45}).fn(825)

task.update({"listId":101,"name":"xgbowijfzk","priority":2,"id":95}).fn(826)
[32m[user][0m [task] does not own 95
err_no_row

list.create({"id":33,"name":"ifsfvkzrhcuwgvi","tasks":[16,31,23,23,46,86,12,29,64,44,46]}).fn(827)

task.update({"priority":2,"completed":58111,"id":103}).fn(828)
[32m[user][0m [task] does not own 103
err_no_row

task.update({"id":40,"name":"jqjixdzo","completed":70529}).fn(829)
[32m[user][0m [task] does not own 40
err_no_row

list.destroy({"id":62,"name":"rhzxgew"}).fn(830)

list.create({"id":58,"name":"osenwdjbohvp","tasks":[46,50,23,43,4,27]}).fn(831)

list.create({"id":45,"name":"ipfmbb","tasks":[2,58,38,37,75]}).fn(832)

pref.update({"night":29,"language":"limmtpcpbtitocgkovqo","weekStart":30,"dateFormat":"vkeejhdfjlpugel","confirmDelete":76}).fn(833)

task.create({"id":26,"listId":7,"date":0,"name":"hmsm","notes":"","priority":2,"completed":0}).fn(834)
[32m[user][0m [list] does not own 7

task.update({"id":57,"priority":2}).fn(835)
[32m[user][0m [task] does not own 57
err_no_row

list.update({"id":73,"name":"pobgwx","tasks":[72,16,71,23,14,67,2]}).fn(836)
[32m[user][0m [list] does not own 73
err_no_row

task.update({"id":110,"listId":58,"date":21290,"name":"twcewaon","notes":"","priority":0,"completed":0}).fn(837)
[32m[user][0m [task] does not own 110
err_no_row

list.create({"id":86,"name":"ohmunqrwkisdwwiejost","tasks":[102,10,14,11,65,49,76,1,7]}).fn(838)

task.destroy({"id":86,"listId":36,"date":22080,"notes":"","completed":0}).fn(839)
[32m[user][0m [task] does not own 86
err_no_row

task.update({"listId":66,"completed":0,"id":5}).fn(840)
[32m[user][0m [task] does not own 5
err_no_row

task.destroy({"id":72,"date":73253}).fn(841)
[32m[user][0m [task] does not own 72
err_no_row

task.update({"priority":2,"id":11}).fn(842)

pref.update({"sort":31,"weekStart":73,"confirmDelete":10,"moveCompleted":48}).fn(843)

list.destroy({"id":2,"name":"pxfcawb"}).fn(844)
[32m[user][0m [list] does not own 2
err_no_row

list.destroy({"id":26,"name":"rfilplpao"}).fn(845)
[32m[user][0m [list] does not own 26
err_no_row

pref.update({"language":"luelewdhlptgedpwnlpoe","dateFormat":"xjdtnjb"}).fn(846)

task.destroy({"listId":37,"name":"tncp","priority":1,"id":2}).fn(847)
[32m[user][0m [task] does not own 2
err_no_row

list.update({"name":"gerehstdlmbrtypuc","id":33}).fn(848)

list.destroy({"tasks":[68,6,68,49,25],"id":69}).fn(849)

task.destroy({"listId":44,"id":108}).fn(850)
[32m[user][0m [task] does not own 108
err_no_row

list.create({"id":2,"name":"coxlypwzpygdnzkdkksv","tasks":[45,2,4,67,50,0,19,64]}).fn(851)

list.update({"id":50}).fn(852)
err_invalid_model

pref.update({"language":"wwsbnmlwho","confirmDelete":8,"moveCompleted":69}).fn(853)

pref.update({"sort":94,"night":66,"weekStart":99,"dateFormat":"bhkovkhbszrurwkdicm","confirmDelete":84,"moveCompleted":61}).fn(854)

pref.update({"sort":21,"dateFormat":"bjqxgxcpddbujqkjhun","confirmDelete":86}).fn(855)

task.create({"id":78,"listId":21,"date":58955,"name":"lpngwqt","notes":"wwrrncbqamgk","priority":1,"completed":8573}).fn(856)
[32m[user][0m [list] does not own 21

task.create({"id":32,"listId":15,"date":0,"name":"titkopgbrhdxympq","notes":"","priority":0,"completed":0}).fn(857)
[32m[user][0m [list] does not own 15

list.create({"id":98,"name":"qpdwmbxwlwa","tasks":[41,82,103]}).fn(858)

list.destroy({"tasks":[11,105,48,108,40,17,23,23],"id":8}).fn(859)
[32m[user][0m [list] does not own 8
err_no_row

list.create({"id":54,"name":"xwlklhtwpe","tasks":[11,107,83,82,39,16]}).fn(860)

list.destroy({"tasks":[89,1,1,14,10,32,58],"id":111}).fn(861)

list.update({"id":8,"name":"bfp","tasks":[48,103,100,19,24,44,1,2,28,50]}).fn(862)
[32m[user][0m [list] does not own 8
err_no_row

task.update({"id":47,"listId":13,"date":0,"priority":1}).fn(863)
[32m[user][0m [task] does not own 47
err_no_row

task.update({"listId":25,"name":"tvf","completed":79310,"id":7}).fn(864)
[32m[user][0m [list] does not own 25

list.update({"id":21,"tasks":[104,26]}).fn(865)
[32m[user][0m [list] does not own 21
err_no_row

task.create({"id":94,"listId":90,"date":9636,"name":"utcusqigcb","notes":"","priority":2,"completed":0}).fn(866)

pref.update({"moveCompleted":72}).fn(867)

list.destroy({"tasks":[86,64,42,71,6,88,79,72,98,1],"id":114}).fn(868)

list.update({"name":"keprpku","id":9}).fn(869)
[32m[user][0m [list] does not own 9
err_no_row

task.update({"listId":103,"name":"bkxcpuzpb","notes":"","id":1}).fn(870)
[32m[user][0m [task] does not own 1
err_no_row

list.update({"id":89,"name":"erllptc","tasks":[43,1,84,1,82,46,44]}).fn(871)
[32m[user][0m [list] does not own 89
err_no_row

list.create({"id":95,"name":"fsjpprypiabplctbsurep","tasks":[42,14,94,32,6,55,12,69,10,68,23]}).fn(872)

task.create({"id":2,"listId":7,"date":88422,"name":"ipkologrxhwx","notes":"gkyxqeobgqgyjje","priority":1,"completed":0}).fn(873)
[32m[user][0m [list] does not own 7

pref.update({"night":1,"weekStart":26,"confirmDelete":63}).fn(874)

task.update({"id":61,"notes":"","completed":0}).fn(875)
[32m[user][0m [task] does not own 61
err_no_row

pref.update({"sort":35,"night":54,"language":"nufv","weekStart":93,"confirmDelete":52,"moveCompleted":28}).fn(876)

list.create({"id":84,"name":"npvbjdgnnd","tasks":[73,109,22]}).fn(877)

list.update({"id":56,"tasks":[20,56,36,67,72,22,2,31,94,20]}).fn(878)
[32m[user][0m [list] does not own 56
err_no_row

list.create({"id":61,"name":"jdjxobfddg","tasks":[70,99]}).fn(879)

pref.update({"sort":55,"night":72,"dateFormat":"eqthxfgycbpuyu","moveCompleted":81}).fn(880)

list.update({"name":"qlhphewwo","id":103}).fn(881)

list.destroy({"id":28}).fn(882)
[32m[user][0m [list] does not own 28
err_no_row

task.create({"id":115,"listId":45,"date":0,"name":"sjdndjeb","notes":"kyxw","priority":1,"completed":26041}).fn(883)

task.create({"id":90,"listId":49,"date":0,"name":"uswdzb","notes":"","priority":1,"completed":56950}).fn(884)

list.create({"id":2,"name":"lbdqikb","tasks":[13,98]}).fn(885)

task.update({"listId":11,"name":"wys","notes":"kbgeuzxnbcz","id":19}).fn(886)
[32m[user][0m [list] does not own 11

pref.update({"night":26,"language":"unmhgmdyfhdshts","dateFormat":"kfnxus"}).fn(887)

list.update({"id":14,"tasks":[108,40,97,55,9,103,20,85]}).fn(888)
[32m[user][0m [list] does not own 14
err_no_row

list.destroy({"tasks":[19,56,36],"id":109}).fn(889)

task.create({"id":91,"listId":88,"date":11907,"name":"qwnmqxexpdvikuwgxf","notes":"","priority":0,"completed":0}).fn(890)

list.update({"tasks":[80,12,113,30,65,82],"id":41}).fn(891)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.destroy({"id":109,"tasks":[3,67,19,91,118,6,22,15,64]}).fn(892)
[32m[user][0m [list] does not own 109
err_no_row

list.update({"tasks":[79,14,6,10,64,34,1,112,118,102,18],"id":1}).fn(893)
[32m[user][0m [list] does not own 1
err_no_row

list.update({"id":1,"tasks":[29]}).fn(894)
[32m[user][0m [list] does not own 1
err_no_row

list.update({"id":23,"name":"pqocpd","tasks":[13]}).fn(895)
[32m[user][0m [list] does not own 23
err_no_row

pref.update({"night":34,"dateFormat":"imzrmaudwfgyzt","confirmDelete":41,"moveCompleted":97}).fn(896)

task.create({"id":112,"listId":86,"date":16989,"name":"qtnqkpswsf","notes":"","priority":1,"completed":0}).fn(897)

list.update({"id":83}).fn(898)
err_invalid_model

task.update({"id":98,"listId":62,"date":0,"notes":"","completed":0}).fn(899)
[32m[user][0m [task] does not own 98
err_no_row

task.create({"id":14,"listId":97,"date":69214,"name":"tesnytlwxofjiimgnvcit","notes":"qdedfi","priority":1,"completed":0}).fn(900)

task.destroy({"id":4,"listId":90,"name":"cvqsnndwnuu","completed":0}).fn(901)
[32m[user][0m [task] does not own 4
err_no_row

task.update({"completed":21163,"id":38}).fn(902)
[32m[user][0m [task] does not own 38
err_no_row

list.update({"name":"vqorfah","tasks":[59,11],"id":65}).fn(903)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"night":21,"language":"mxdzxs","confirmDelete":84}).fn(904)

pref.update({"language":"kkjl","dateFormat":"eyqw","confirmDelete":72,"moveCompleted":39}).fn(905)

pref.update({"sort":35,"weekStart":90,"dateFormat":"hy","confirmDelete":14}).fn(906)

list.destroy({"id":26,"name":"fmbgfgwumglwmkkqoht","tasks":[25,28,2,38,81,22,9]}).fn(907)
[32m[user][0m [list] does not own 26
err_no_row

task.update({"notes":"pgncxeclcrtsxbilvfm","priority":1,"completed":0,"id":58}).fn(908)
[32m[user][0m [task] does not own 58
err_no_row

list.update({"id":73}).fn(909)
err_invalid_model

list.create({"id":10,"name":"vdixtlxhfiovgpr","tasks":[51,2,17,69,113,23,18]}).fn(910)

list.destroy({"id":23,"name":"gaienxikkrshftfgiuw"}).fn(911)
[32m[user][0m [list] does not own 23
err_no_row

list.create({"id":13,"name":"nba","tasks":[33,23,1,87,27,60,45]}).fn(912)

list.create({"id":31,"name":"cdeqkoilyqcwkdubnyj","tasks":[37,32,114,99,104]}).fn(913)

task.update({"id":34,"completed":0}).fn(914)
[32m[user][0m [task] does not own 34
err_no_row

list.create({"id":50,"name":"wpij","tasks":[18,70,65,67,62,11,22,26,6,44]}).fn(915)

list.update({"id":21}).fn(916)
err_invalid_model

task.update({"date":2057,"notes":"jrrfgwrogwlsu","id":12}).fn(917)
[32m[user][0m [task] does not own 12
err_no_row

pref.update({"sort":90,"night":20,"language":"vyzufwxcshthjksu","weekStart":46,"confirmDelete":4}).fn(918)

list.create({"id":106,"name":"mrhtzyyyfiz","tasks":[6,35,37,52]}).fn(919)

list.update({"id":90}).fn(920)
err_invalid_model

pref.update({"sort":85,"night":57,"language":"kugbkvgafycyieuwdffk","weekStart":96,"dateFormat":"bpvbqjhavokpk","confirmDelete":60}).fn(921)

pref.update({"weekStart":42,"dateFormat":"irxednxtxc","moveCompleted":66}).fn(922)

task.create({"id":56,"listId":85,"date":1865,"name":"xwpi","notes":"","priority":2,"completed":0}).fn(923)

task.update({"id":43,"name":"gegfexsdvrwsfaehql","priority":0}).fn(924)
[32m[user][0m [task] does not own 43
err_no_row

pref.update({"sort":19,"night":28,"weekStart":2,"dateFormat":"spwpkairbm","confirmDelete":59,"moveCompleted":82}).fn(925)

list.update({"tasks":[121,7,3,23,50,36,17],"id":30}).fn(926)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.update({"notes":"","priority":2,"id":57}).fn(927)
[32m[user][0m [task] does not own 57
err_no_row

task.destroy({"listId":119,"date":46776,"name":"tyowzlrzxqdeyda","notes":"kvpywd","completed":37681,"id":66}).fn(928)
[32m[user][0m [task] does not own 66
err_no_row

list.destroy({"id":109,"tasks":[123,92,30,10,108,33,44,51,16]}).fn(929)
[32m[user][0m [list] does not own 109
err_no_row

task.create({"id":102,"listId":23,"date":0,"name":"ftcxlozuuzufjgxe","notes":"wmz","priority":0,"completed":56427}).fn(930)
[32m[user][0m [list] does not own 23

list.update({"id":27,"name":"mf","tasks":[115,66,55,21]}).fn(931)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"language":"devxfjqwzezq","confirmDelete":48,"moveCompleted":91}).fn(932)

task.update({"date":0,"completed":0,"id":15}).fn(933)
[32m[user][0m [task] does not own 15
err_no_row

list.update({"id":71}).fn(934)
err_invalid_model

pref.update({"language":"pkyeplx","dateFormat":"jjrlffqiqewsjp","confirmDelete":85,"moveCompleted":56}).fn(935)

task.destroy({"id":48,"listId":32,"name":"ncfcm","notes":"","priority":2,"completed":0}).fn(936)
[32m[user][0m [task] does not own 48
err_no_row

list.update({"name":"df","tasks":[120],"id":43}).fn(937)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":68,"name":"hgmerxww"}).fn(938)

list.create({"id":29,"name":"wuoupgiae","tasks":[99,48,7,17,73,37,106]}).fn(939)

list.update({"id":97,"name":"dvjxzplxwl","tasks":[47,0,121]}).fn(940)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":40,"night":92,"language":"aixgus","weekStart":87,"confirmDelete":61}).fn(941)

pref.update({"night":22,"language":"nlxl","weekStart":59,"dateFormat":"olhcrnbswygirfltq"}).fn(942)

pref.update({"sort":70,"night":26,"moveCompleted":61}).fn(943)

task.destroy({"listId":21,"notes":"","completed":16563,"id":79}).fn(944)
[32m[user][0m [task] does not own 79
err_no_row

pref.update({"weekStart":23,"moveCompleted":22}).fn(945)

list.destroy({"id":1}).fn(946)
[32m[user][0m [list] does not own 1
err_no_row

pref.update({"sort":100,"night":12,"dateFormat":"lxrpchlvnjdjsxsr","confirmDelete":12}).fn(947)

list.destroy({"id":53,"tasks":[7,121,14,26,14,111,119,9,18,18]}).fn(948)
[32m[user][0m [list] does not own 53
err_no_row

task.destroy({"priority":2,"id":0}).fn(949)
[32m[user][0m [task] does not own 0
err_no_row

list.destroy({"name":"vjtylcmv","id":73}).fn(950)
[32m[user][0m [list] does not own 73
err_no_row

list.update({"name":"bphykhyjtikbfilbwzjo","tasks":[1,16,1,72,47,17,48,15,32,19],"id":42}).fn(951)
[32m[user][0m [list] does not own 42
err_no_row

list.update({"tasks":[0,45,5],"id":1}).fn(952)
[32m[user][0m [list] does not own 1
err_no_row

task.create({"id":1,"listId":8,"date":24204,"name":"ck","notes":"","priority":3,"completed":70449}).fn(953)
[32m[user][0m [list] does not own 8

list.update({"name":"jvlspzdoxx","id":45}).fn(954)

list.update({"name":"nevkbcicjx","id":14}).fn(955)
[32m[user][0m [list] does not own 14
err_no_row

list.update({"tasks":[21,33,51,59],"id":104}).fn(956)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":92,"language":"qtiaqegejsvj","dateFormat":"vdchcgqufwpmlu","confirmDelete":34,"moveCompleted":23}).fn(957)

list.create({"id":50,"name":"dbrvovtrnwnqs","tasks":[16,15,70,56,86]}).fn(958)

list.update({"id":108,"tasks":[11,5,88,94,12,58]}).fn(959)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

pref.update({"sort":45,"dateFormat":"mkkl","confirmDelete":12,"moveCompleted":78}).fn(960)

list.destroy({"id":68}).fn(961)

task.destroy({"id":8,"listId":9,"name":"fwdrdqpxrkfsx","notes":""}).fn(962)
[32m[user][0m [task] does not own 8
err_no_row

list.update({"id":119}).fn(963)
err_invalid_model

pref.update({"night":73,"language":"mp","moveCompleted":12}).fn(964)

list.update({"id":87,"name":"rbngkisgmmmmpt"}).fn(965)

list.update({"tasks":[27,15,65,92,11,27,4,84],"id":39}).fn(966)
[32m[user][0m [list] does not own 39
err_no_row

list.update({"name":"xmftpwr","id":85}).fn(967)

list.destroy({"name":"ajwqorjdul","tasks":[5,17,34,119,93,51,21],"id":43}).fn(968)

list.update({"name":"yrxcxe","tasks":[33,24,94,32,32,76,71,101,40,48],"id":15}).fn(969)
[32m[user][0m [list] does not own 15
err_no_row

list.update({"id":88,"name":"iuh"}).fn(970)

list.update({"name":"ksbzjuiefshaco","tasks":[27,35],"id":26}).fn(971)
[32m[user][0m [list] does not own 26
err_no_row

list.destroy({"id":47,"tasks":[52,19,109,10,8,27,48]}).fn(972)
[32m[user][0m [list] does not own 47
err_no_row

list.update({"name":"iyibr","id":1}).fn(973)
[32m[user][0m [list] does not own 1
err_no_row

list.destroy({"id":53}).fn(974)
[32m[user][0m [list] does not own 53
err_no_row

pref.update({"sort":41,"night":68,"language":"vkrjrfttxskdxfmuawua","weekStart":82,"dateFormat":"vyfdtnoicxsuwahicxle","confirmDelete":56}).fn(975)

pref.update({"night":27,"language":"mbdhurlezhlpb","weekStart":26,"confirmDelete":55,"moveCompleted":81}).fn(976)

pref.update({"sort":23,"night":87,"language":"ephiqpbnphfhurklf","weekStart":26,"dateFormat":"wmrrmpyefkrjriloubbb","moveCompleted":18}).fn(977)

pref.update({"sort":18,"dateFormat":"fpdgsngtc","moveCompleted":50}).fn(978)

list.destroy({"id":26,"name":"ebrunbuwhtmhi","tasks":[107,41,66]}).fn(979)
[32m[user][0m [list] does not own 26
err_no_row

task.create({"id":86,"listId":26,"date":20843,"name":"guwufe","notes":"","priority":1,"completed":0}).fn(980)
[32m[user][0m [list] does not own 26

pref.update({"sort":75,"night":55,"language":"blixjlhiffjecusfieabp","weekStart":59}).fn(981)

list.update({"id":87,"name":"rhsxae","tasks":[27,9,85,46,5,97,65,11,18]}).fn(982)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

list.update({"id":39,"name":"dkdcrokdikotqtips"}).fn(983)
[32m[user][0m [list] does not own 39
err_no_row

list.update({"id":73,"tasks":[75,1,103]}).fn(984)
[32m[user][0m [list] does not own 73
err_no_row

pref.update({"sort":71,"language":"mzxdbn","weekStart":13,"moveCompleted":9}).fn(985)

pref.update({"weekStart":50,"dateFormat":"ybmsdkbrdpdlokcfrmap"}).fn(986)

list.destroy({"name":"uyguuxwpiyx","tasks":[19,114,13,82,5,2,19,28,24],"id":11}).fn(987)
[32m[user][0m [list] does not own 11
err_no_row

pref.update({"night":70,"language":"flfyyeekdpqisra","dateFormat":"bellhrazyjhnz"}).fn(988)

list.destroy({"id":111}).fn(989)
[32m[user][0m [list] does not own 111
err_no_row

list.destroy({"tasks":[104,8,47],"id":85}).fn(990)

list.update({"name":"viiqkgtiohtglktblh","tasks":[26,85,39,8,25],"id":22}).fn(991)
[31m[Sync][0m [list] [update] TODO: Handle list.tasks
[TypeError: Cannot convert null to object]

task.destroy({"id":32,"date":0,"completed":9515}).fn(992)

list.destroy({"id":28,"name":"pjqmtpevrgwmndbumqoht","tasks":[105,123,86,20,25,27]}).fn(993)
[32m[user][0m [list] does not own 28
err_no_row

list.create({"id":3,"name":"iokfckgv","tasks":[9,48,13,38,42]}).fn(994)

list.destroy({"id":36,"name":"iswjd","tasks":[55,9,93,18,96,30,116,1,52,12,61]}).fn(995)

list.create({"id":98,"name":"tfbkpopgorxfyishgysg","tasks":[118,52,13,12,78]}).fn(996)

list.update({"id":25,"tasks":[2,51,23,60,28,24,60,33]}).fn(997)
[32m[user][0m [list] does not own 25
err_no_row

pref.update({"sort":16,"language":"spnngtrdqwhn","confirmDelete":94}).fn(998)

pref.update({"sort":89,"language":"nqqkmcnnss","weekStart":15,"moveCompleted":28}).fn(999)

list.create({"id":113,"name":"lebicy","tasks":[56,3,19,70,29,108,32,2,96]}).fn(1000)
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[33m[Socket][0m A new guest has connected
[33m[Socket][0m A user has been authenticated
[32m[Storage][0m Removing user 1
[32m[Storage][0m Removing user 2
[32m[Storage][0m Removing user 3
[32m[user][0m [task] does not own 13
[32m[user][0m [list] does not own 13
[32m[user][0m [task] does not own 13
[32m[user][0m [list] does not own 13
[32m[user][0m [task] does not own -200
[32m[user][0m [list] does not own -200
<!DOCTYPE html><html><head><title>Coverage</title><script>

headings = [];

onload = function(){
  headings = document.querySelectorAll('h2');
};

onscroll = function(e){
  var heading = find(window.scrollY);
  if (!heading) return;
  var links = document.querySelectorAll('#menu a')
    , link;

  for (var i = 0, len = links.length; i < len; ++i) {
    link = links[i];
    link.className = link.getAttribute('href') == '#' + heading.id
      ? 'active'
      : '';
  }
};

function find(y) {
  var i = headings.length
    , heading;

  while (i--) {
    heading = headings[i];
    if (y >= heading.offsetTop) {
      return heading;
    }
  }
}
</script>
<style>

body {
  font: 14px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: 0;
  color: #2C2C2C;
  border-top: 2px solid #ddd;
}

#coverage {
  padding: 60px;
}

h1 a {
  color: inherit;
  font-weight: inherit;
}

h1 a:hover {
  text-decoration: none;
}

.onload h1 {
  opacity: 1;
}

h2 {
  width: 80%;
  margin-top: 80px;
  margin-bottom: 0;
  font-weight: 100;
  letter-spacing: 1px;
  border-bottom: 1px solid #eee;
}

a {
  color: #8A6343;
  font-weight: bold;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

ul {
  margin-top: 20px;
  padding: 0 15px;
  width: 100%;
}

ul li {
  float: left;
  width: 40%;
  margin-top: 5px;
  margin-right: 60px;
  list-style: none;
  border-bottom: 1px solid #eee;
  padding: 5px 0;
  font-size: 12px;
}

ul::after {
  content: '.';
  height: 0;
  display: block;
  visibility: hidden;
  clear: both;
}

code {
  font: 12px monaco, monospace;
}

pre {
  margin: 30px;
  padding: 30px;
  border: 1px solid #eee;
  border-bottom-color: #ddd;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 0 10px #eee;
  -moz-box-shadow: inset 0 0 10px #eee;
  box-shadow: inset 0 0 10px #eee;
  overflow-x: auto;
}

img {
  margin: 30px;
  padding: 1px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  -moz-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  max-width: 100%;
}

footer {
  background: #eee;
  width: 100%;
  padding: 50px 0;
  text-align: right;
  border-top: 1px solid #ddd;
}

footer span {
  display: block;
  margin-right: 30px;
  color: #888;
  font-size: 12px;
}

#menu {
  position: fixed;
  font-size: 12px;
  overflow-y: auto;
  top: 0;
  right: 0;
  margin: 0;
  height: 100%;
  padding: 15px 0;
  text-align: right;
  border-left: 1px solid #eee;
  -moz-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-font-smoothing: antialiased;
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAABmCAMAAAAOARRQAAABelBMVEUjJSU6OzshIyM5OjoqKy02NjgsLS01NTYjJCUzNTUgISMlJSc0NTUvMDA6PDwlJyg1NjYoKis2NjYrLS02ODkpKyw0NDYrLC04ODovLzA4Ojo0NDUtLy86OjwjIyU4OTosLS82ODgtLS8hIyQvMTEnKCooKSsrKy0qLCwkJSUnKCkrLCwpKiwwMjIxMzMqLC0tLS0pKissLC00NTYwMDIwMTQpKysoKSovMDEtLzA2OTkxMzUrKywvLy8qKyszNTY5OzsqKiw6OjswMDExNDUoKiozNDUvMDIyNDY1Njg2Njk5OTozMzU0NjY4ODkiIyUiIyQ4OTkuMDEmKCowMjQwMTErLS4qKywwMTMhIiMpKiopKy0tLjAkJScxNDQvLzExNDYyNDQmKCk5OTslJig5OjskJSYxMzQrLS8gISIwMTIoKCk1NTUlJSUnJygwMDA4ODgiIiMhISI8PDw6Ojo5OTkpKSojIyQ7OzsyMjIpKSssLCw6Ozw1NjlrfLakAAAg2UlEQVR42jR6i3ea6rYvPgANIAhVXh8WvkQlioUiFlFcBtAmoiRNdzxqu9p0J7vrdK29zuPeex77nnvO/35n1r1ndHRktI0jTOacv/l7lCBK5UqVpOha/YxmWK7BC4TQFKVXrbYsnimqxuuMVlOQ0XltWjUdCwRJ1M+tC1KudOs9q6+da2adUewG0SC0SwELfHtgDds93VEuydEbl3QMWeNoYkR7b/0x1ZRobGI3mLwzAhePqTAwhg6aogjNsGy7/jwQ4rkdqe7CWLxF8k9LfMVFyRS7VJqtkrW8Vt/bkR8FZJao16ipknbC3Yw2lM7laO6HBEOadEZ2tpf65c4v8e3u7FyU6qbiNNyCuzXZ6pawgnwgmrpTT/Q7w2EZmiIJ0dzWDI7mhQ80IfRnMu2kzA5r5r1pIFoia+/d93HRYp1GV8TbrkWoU/+jdI0Ff6yGwTjT1Hn8J+8m1rKpGiYPuNiHnMtNMIv+zpsk84MYTNW1/+DpwXLvckdOCMYowVNPREe0QlM8xRHXXFhcNDzupwsSmb5pH+0t0RP2Qk+QtI7F1Qm6JRC6ZPBtPq/dq/kH+jxtCljn9TIpW6rQIgmSVyj6lPICIw4N/taka41PFUInth0je9+jO6Kt1G4/a7V2LEgG02B0pHVuCZrgltSKMuIl5SyufUv9mYuQi+mFgzbBEtFo2g+Dh4sSTrLNu8JPh00sQydpb00tqXBvqRN7Q7kqzcnIxCGnvZt/WmJacoOEO6Dcn8Qre03pOCSQxbMOXUuDNx9SxuLz4W1I18gvjViQ67zV0rxdWL8Te/TQkuo8STS41DR48W7L6YP2uWIqiUV8rd6Gbf/rnegKZeG8TpAM6afhGze9JAOxbLjsnUXEbrZ9vLYd7MT32cPF5mKKxmjy7huaoD9n62GOxni3iIJwv0IzZAZjdZkUtolCNLVfYZNaquFjGszVVf+J0vrz4CawoKdHnOzb0NMH7CDBOybfYNJ4rfeMyFNjkFYVTzMFs87rnPGXLUOeNKRVc0LnU7/UIgelzsy3CMuth0YfvnY0wsD3vODUL3eJcKqHQpm8yM3XZQWJxO6Un9iYloyyLpOwN2obHy6W6gbpcb44XmyC+mg+itAcaprGcrwZCqMj/GmtKn0zPvpTz/Cv1dw21XwP3cRupg3H3MF/S71eTKj1YrdwKdc2Mw0fRmb2sFf8lW3aU6JbIZSEPqvXvjM7G/aApyXlXeqKfMq0g/Su3rUGJPSPrtGElgknrZM3xUXqsAP6zMCNVn5u8aJnSNpJv2uru7t2jfRziW2+GuhqfldUNbPk71olwo+46ePUo1U3WKk/e5YK07F/wGRgcpODmQnIlVeHCWBE4puBi2jq28UKpqiN1/4UOrGz59TNYrrQHtd+11sG40BGD+pXdelNqGOg4NXe8W4eacJV/NS9/2Umtym6WQqveqR9xdCMElpxnbkalM4Vf9uaEcWZaKdyibEIjWKxJZPN95niCL3GiaXyssIrHxoLkqkzLCXULN46/f2h3tQJgyip+Tk9EAjJ9aJshq7t8X45aowSKspMSvPf7r9R8yxNptIaHS5ozuEm6luPDApugyNP8OaqiQ4BjaequXA54SLC83eHIY2r+CZp4409Xqw8Aa2oI7XkCrQi+in0w5AqF/kLNrcUz+qkl/lAobY1jSnx5OJNhyXIz3qfNFlXc0TKaglNwdWkWYt9QQ1Kr6W8zue21iNrdJk+N5oCr2O9nEtWKC7IS5J/zdDEYrmnAYfg6agCy+qcgz7ZofeDc4PbUWSvkshWuAc7OjiUyLkj+RAtdlwXJcjxdpkTTHDhK8lBCi8+JtvDVL1W6elmOM++YS0LuSlaP1oUvAeiW3cFnvTr8EbTz1tsSMYdGeZe40sRWu5uAfj7q+ZoKv2FNQ0p5XY1lmlcigHZqTPpabufEVrNuNPi165w3uCVQJHyJqmSJ7ZHnguqwtCmwViIJijj04ba2JNYtB+yORf5gg1/9t9iw4vUpeqiunSAbf+IBdj/b+iG2qrHvuNP0Vd/+ThVZT/lrvHYjjgDbbyxaqgHNM2uhxa1GW3UedZYhMMwM4mQhltouK+IV4NdbIQNM+8Yv311RZk9kT4tiYR4LkyFcuPpdcjuhUuFqBAWRZa11lcZ3gEBlXywsNhrt+plISZP5DlsV9l4EgY6J3yZPTUcMrgaWAT3oI79eSbGEbcJpr6BD8kyDiVt+G0/hXosQN4NFXKlfWIfsIs0BHODVok1/IGnKFHJYIquh8Xo+2+bkQNTGgWmN/fZ0Y33LSj6lr1GyV7mWIKg7ZTRZPGuhF/zjRNcQ1UPtSYgnWQxSs0yrVhwNDcdGMNSNe2JT3WuzbAM3HykyAajS3Uphf6STKEqxLas9EnmnhA/lyj9Uj+JoY7SVgVmGLl46Rm2u98sbkap2lzAdKBG4r6LgulQOSSjQv1GWdQ0jtDUK/mAaqM1Uqjpu4k3Rvfvxv7YTxLSK+wN3E5jVIzmF23uZ7hiH/sVP49D7tvoKp4S8b1LuvRlivVB/algbhcFITYVXvDpLzpDfplR2uD5V4XJFxpjmIpLc9Y5sB2TpBRix7Bme6GZIq+06v3XzNeTcA4obQIKxrnT4C2JpOqD92dbmSX8MGazly5EsZVMvSU1f4RZwyu8iQXbVdeLlZrjuTT1jrY1uk5c7iZ7RsvhhluqAkq4JpVQAg7RJFtSu+xgJ8Pv6O1j5DkLxT8mkbfyRW5DrQmG7hiDIjCgBsADbjuof6YHLGeV6a5Q1Smx9joUXPpdaaDx97A/Wq00oJkdR7ZYuQRfS533JtxO1erduqWOYIt3wh0wpbLuCNIYkwxbswbikCUu2CDCS+Q+7rgVtfRcm+SOcdKPRlZ/rE7wNVUEE39KTS5uvUKN1PUnkloPkyzhyGQ8qkouEjJ3H/VXdqG6asSRiw3ecMlBvDDt8dDhBHXMwZ2Cajzjr7/76T+IavqPYvz6r7//E/3X3+N//h/0QozbjPgPiir69P/8X3/9F/yv8b/827/++98WItPu5/Hvwd8YPf5bp/2/lX/T/+Of/0MJ/lYTa+L/Ef+d9vN/3/2T6P/+jyTzu/evf6U7vxN7B6pJkRtAF6jUr8I+P8RsP/ptGhfqFk+pQ/DgAy6NJtRYJdXmp4gK7WLqLKJ+MaKhGjOojvL+SnIWrkpy0SLHDe4QuyNzaEA15mLMCcmE8Em+4HdOihW4/ZWuppJEmzeAwcDtv7MuLc9y2V5atvxXNe3S4DUMt5/Qy2LM9kSYKiVWBuKlfp4nxTntpuW03JbIlkiRvBXmT23g1I2OYe6IizUHPIq6zm6mbfsbteKmi/sg9J+ocQBMctGFO7iljo8TPN+z3jxw4do+ZwfqoR9dkNTKHyM305GpTkfhcHexVkPVGEbUOjuo9f0UMPHBFlGEx0SLvJvVRKTwW7PSew5oPme+E42+frJa9cGt2njS3dK5kIif2eYbhuSEQXEqMVfUjhGIuin0G0/W5ezJyJQy3SpMLai4M0JUWb5u1k9tny5bd1pPwYBpQuDCXZl62xg4CdVEAtflXHs6JKmP/pH6mOl796Lgopj0o8d5kKh00hxG3OSdEE/QBo9Hgr8JJqAeLDwJohG5j/DGh61Rc/+tf22/8kEnxHNCEjo0ElvvGfESZkqmz2BDcKV1H1buSkhkdg7p1IMGs2s17nYjpblrWuE2K9WEO/hcRp5e9oOF/QBmOaDtgil+oaU6szPrdwW65fOB0KUTsVUn7LFU7J8e6cxJIl9+FHw5MQMzuQJ+4oxMH3iW/5GK+hWuG0T+gTLs+fAjdtUd58TmIUq04EeyRCYCjkldow234aIgR5bqwrtZosZ+6YEqAmDqatJ9lWasz4IquKALPtd92hGI3Z2BdzzZue+REl1Om4DIWD+RrtUTOJLI+S0jHowXXdAxsGLSd40zYNuEUlOGhrwL6c7tcOtUOvpJCP7QBQS19H+GvZn05ewjlVLz+IGKoC9TyfQjLMBNmXCuqqtTdOSukZW48B0HqgSTCBrBnlFvF4CG2Su7yFzqmJFURK3UmTT3ru050r0ptUpMilYnBJWfl2Bv6kPlUuE1kxxpdzui9AubsR2N2boVSu81OulAwBqoSr1LZ0LLYOomyZHmjqnXlP72s8LnDouEJjtodBvdHaG1jMySYO7crWd90MpCRyCG14vb5IE7Arupw/y/RcCm/Tm3zK6zYj8PYNaGldiUfkB/LHWcmf2lVM+mwyU27a0qq2tscrQ/vzBjN26DnntIrOyGizzXK35yKQdYnUABkyN4saz3WD/viF+eCcsXnIajdWYJWaYHRstIis9CS+tqnFGmz2j5uzfr3Z4prqgK4XOT/PyftvjZqIm8lhkfxJ7Ol3CJF1piYBGAG8wtAk56Drw1YwmOpcz+NdfkSpSLplRXLXHL0Rquj6YW/gabqgK7Dgr6NwtH0B/AN7XrN+MVJ6AmXmUuqmQulrNNYPmH0RoDogydOKLo/QbfYNARSQQKISRCzRXU+q9WWJFL3LZW6u34CkeG97xC0NNGaJ0bvK6SnZS3zPskr5EtuCgjMWR5o2x5BqhKmDWJPRe7JMEOyRb5uUKlHaGVtq5ivSOaSliSXp9SQm2qk8MRJh10MAp9QQ2H5t59J8rjiwSZtoIfMGjlLPVNdYl/LBR0AO6WLGDmkLkIPRE45Y9MftdAK/yNu1Hn6tzOQTesgQ+8fSzB19wO91vCnO23vOWQdwJ63SJrYjdfKFW6W281PKs2k8iT9ai1cgJ4sa3xqdvmtxR8/+D1B8AKc2u+6JftryRhMWSQtoSBgIyyQGyxcnELuAasXN12oSriU4RMz1DD6RL0TSV+om7i1Yt+jEE/jnawM8cX/UhN4nkiv/w9eALrzNhXuQfOzFL0Fi6SjF7/4Qn8rLYBoa85cvgAnkCEBP+HPbEnquVXCZsMS/yzYw2Vru60P/+nJPYKkzZFjmbykzUoEqV836T5q3fP/L383dF82tx18/AZgZczMAgyeWYKmSZIqtHL+e+O4ZRcq9VI3g/qPeCoiK4pcgEqdbS0S/Be54sbVQOuJVPNBblIghzeasNu7h/g+Sz1IdhI5lCwq1nUb3Ji4OCIcqQZqtqJ5w7rXrg/DA9IgVmEGhDgGecEwnCTHffXcXs0V3OCEVzYDKS1vp/oX+ng+6XVU86UjA6FMO2RXOOOrqY1GgPvrAk9HV/BXtCu5RuwF8qgdGDLsBcui4E33ymdBip1X8uKyhIWT8qNRDsXz+gvO9UiEC0d8RG4Tf2x8H4slljgHtCBcxHLTWOYJm5H/fCPCzOgf9qgOUxTRZ0Pc6ha5yLuLVT9ntvIa6gacE99mCovdUumTQdRP4RPsS9129eEe2uSvvGh0bV4Y3QPPhPZMqhZWSMa5R0Hc1SGO4IVOQc0FrirlibTVfKRrYkD8kz3b+X65/QkUNaZdrdl3mCap0Hf3YcCw/LiouJYNbqz88UqeDYv93yO7vvXtgl4XCyAO4ODkY6W+83+LZU//p3/zXNGGrUKClCiOnL27iJZbNWDF02XXAOeFlB7IaADoMH1Yqr+UP9biyZDEa/iJt4MDeIz6GKTdLVBfWGVtRN4fdT2rgReX8UXwF2zOrradm4J0nyTgdPnai3RvzpZvCKDUqjOwD/QA6EDaMCLewX6QWYVnHY1sx1bd8ovYnPm1ZvPH+rE20lWjOCnZ66/xDt0QAl15FjfBcZp+i9OU0RNPQ0t3x2pSNWo8eiYudwsnuP1Hq6iH1LJCJynkYsfgJ0p3pF6SoQk2l+jqE8CPk+ziGJRSKjs+W5AO185umPdkYzlK4wl7TC9NxyyDP7ZoyYVoXiuS6SjnInlLWrwz1i8bGTKXX0AVQWkSfIlglW3zRJRJ8bg5VgE6ZEnqNu9B++0GNQvDQJvFize4ESNKBJP+8vA3LM4AX5SIBq08Mob+7QMTCZx4nwP/64+4BnlZC+8WtlP/CXw6t1PwMwkJ3jhP1FiXLhDF/3I6FGUzO2DSi9ABxKyyL9paZxSEz40ZCPQToDAJu1959k7QdbVxgB4icsu2s4zsTPJhcEDo+N1GX4zSk/wriRh8AqwL62972i9HJHd1ydaLXVzvKvOfGGw5RVcUVMiKXFH4APdkQU/dc5BX0YfKTNZYXCW9mb8bc8mufoQP6BbdQmT99ZjoYfr/go4TgQX9IDgztim7wyFeGMfbNaeqj8Dzs38pgcqwSv2hbqB3oSGKWKy+sesY7p57wAHldqE6NDudk/W7s/zjrK4rZFlFvaGxnSZdHbc1y47qDN6xkoK8O3bfr2j41dlJZ71rB4dlDqapPFa8N6xBrprUdtenUCHwxKNhw1uuTBh+9uU45k4REpQABN2bAO9DSLqoIL26gNroWgup5pUMxHUNSq4Gyz47vBPvilpo5f9OYI2ddAqTqmnxXERxQJ3UK8fHbVE9HagHi3+tqNRoNsArdmAxHA5LwtQo9ZAaNKUTljnokljo2x8scqVpEEIPc01fPCdHOCg0DeWBz8D5TVAAfx8aRH5X2ZYNI3ebKDZdeJ+oBDAxmRqJ30Eh2/DaeAy5diVNMpEDmXiPDsGTzBLXy8eVDdJoIafgx/gxMyQi454QrW56nCyeELgSuNNEmYkflF+t3CZQOVRWjKhIuCclmQSlAXT3+4JGG75B4t/5hQ+ldMP4LsAW6z3XmU6IJJwpnGVnsgUZhoY1fZlwTR8wSU7xRejf2uCx9Z5trVTRRJP9KnEb134dEieil6eCOGWgboI7xsqsqM99jfJLTePjygKlH2CVxxsse9QRzTBFjD/Kjqitr/CCTBt/SJ6nLxz7cKP9pFqBpp0lN5y+adKNsZjrPuroemZauH9aTTFD3EKHW8S55XBLFQAt1jgxTQCTwxmx/JyfsZDN1RroN3VaxpSenpIX7K+ZbL8VdlQDcI4Cbzg3QJLa9yVqNxUelu+EtxLVqeekaAvSJkO6sSVqbUajxqhKshNpvZqoeApF0k/0P0ikkwUcbdwc4A1ejN7Oo0O15kG7hTMoK3hZRBCX7YYeLW0wvcXx/18n/u37yLgzBYVBUvORGli+sfRcX/74uD6P4hq+7xu54TlWJLFzT63uwUDwuEDdOjJQqx7JV+ZjaEAPi7t0MMrR4Q8Rkf18uxD6RK0RKh0hL8YU+DeL97i4pa5ZSyAfXKwZRS/8gXcxdZXm62RBDj8U3sN8x95b5PpPs/mCBKYvpaA50pN5Ct/499AFTtwQ5vgeSh+NHrKIi4NVpwM/XzRaNfJD856lPE6M21zWPguFsH7jbLVyEDfRmt4VwrhCJ5VTYmcSPfGgO5clfN+vbaDZ7sakU5+2vZ2WCDY031NxJarVytfDDVtiafcTGO2rJ/taoL3zChN2qmjxofczTOYQPPVQPh0JVtYgdUQINcSiNEEy58UdYXX1MpWUCEBx7LbcGtAm8XWRQTVOaoV3ySri4RShhs/B/0m4jX6OAwXOvcA09bNSG4czEGv/Wey6V/jbTCNTW6awXdNTcA1GsPe1E9fZdGl7R0vyoVpIdJtfC6d32NNErrvq/R+d65VG+YOwRXppXxOCYyGNSf1K3x6VxAW/vtz4EC1SgCOSPdN62sLsoIzuDfg8GwZAbquVO8HIuFP/ToVoeUB7nnwMF35a1wK1tI6fkrqFKhQdeJpwyls0pIy8AZde3/6LUUbFaYJthyUJSU/kqDXTLQElnn0Jr4B2RVghNrmNmoEn7pXIeshPguXVsvwoTdmClq49JJU3LWhHyWTrJL9bRP6VKv3tZoA/th77p5Jw++OEENvyvWy/pNeExiDUVQaXIRGh8xySZTI36yueFaSXo1uJY0RnXYgEOoWWOJHeaVuX/bGNhHsh2yinznl/++NJcE9j6fBPRcBdq9hb8awNw8U7Bl6GM7x69EDOIIbX/npZ++amlHR9L/35mE/2Ss4gb0xCcY4VyTFLRE796vHysLAamqcyO+aFQyJIDBNslbH2/MrAvZiSEIedc/cqjmv4fbda2pXbv+F5a2szSsdkm9noiNURXt8edUhGUF6fSZWd1IJaXKFwD+49R6eCXD4Bkef7j9tRtNMVgW8BhRz/Qpy1TmeYk0doyjZoJSbePOReVHgkFsCFuQJ+Lgc4BxeAsK/cOiNDRmdNw0ctYhn/nQ498dYI5znzGLoJi1rav7Cn88rL3wLePVtDK5gl77Tki3gHEsIAQ2+IKgarj7Y8W1IQzV5V9N+0TjLqbg68WfKcOmBCOj3JkwJhVIkwDhc+JorXuZEPMEh0vvH3x7iqf+VAwXgd4diZiaJD1zHL9Snx6Wfg4IugreyhabQkcir+y5XgDtdx3Avs7lkeeCBwDvZoTUCXx5QrZkcEqWfYEiEYRs/EphmRALSNGR1Iclgdr5VFoELpzF4++f35w3/j0t5ucW3n2ch4PQCLuUXupsPRR7UA5FjSKrMtPcKAZJfagO4lGE7FH3YKMjorpK0ZxAv+i2JkJhtAMWWWFej4RhPR/cJ3DxwocCvXDi4SGZU4cu+K32XndiFWgopAl+0GApcwf1XvymJcFs39jExIBO4yUjU9MExBLQYc9H+W7+IgdESPRpciT+rKZPebVtaVq+1GYO/5xTAL3HASjNTGIgMvdjWbgc7JvdE1zIFpuC0U9ESiZyzBixzxWxj4Kwh8My34q+FK3KNLtmsA1qyrmKSNQOXCPUZd+ONelBTvFoUI/CYsqa/RhtKiyMf2CgSFqEPk59Y3uqnlZ8gFpswfSYyko23yVZYxzKGxGm49Zqxg1l8oz5Ra9XaRwHkuxepmgyhm0SoNy2KlbcEqK+9QqS9PNx9Ihm9U7gsR55SSJ1FBDNnkuWKxIZ0SDpXuOGwZdoUbOMDPHP4vBAgz2VlSEJAHZGJVbYIg7l/FO5KfIVvxC8pPPxMGcNMoevFDeStt2iqztE10n2TA4dgJH76YS9HDhKHD3iCx6ieFX84BAI3QQnngh76f5ruPQVbr5qZmck/5UjDc26lfrOvUBWy0Ogl8bCoOkMOns81TnC3cuUS9KW8+9A+fe3XYZOFUPG1u5epSSmDLw0s5s2F0W30ANeo+zJkJQz9SPZgzwYpEoktofhGVfmLOAB20boCbW1QWq/NpET/hnMecw/uSyAH4NJc3ECOU4nnkK1fj3S/i5dwb3R7k00AqQQUwt7Ie1qV0aY/VQX0J8hLPy7eBNXMHYZYDNxHZ2Qh6AuXJxq+AeRec/Q+JLhZV6hpXwQEzw7bf5v9uUf2vpq3qlhmy0IIGTkwYdCfSAFmqbdo+3XvDTDjFJde0mbeQLcn2n31xaAqJ0ixO/CLsT4I4G4DoncVTgRGNBtsCcjISWT+oeXZ4Iedw/8OsJI1aPnNKLX/60VvcZb94uasRxCkqlPQ11u1Sa2hHvB80WQENxVyzjns0/PiEByyil21Te6oisk3mNCEMrhouCFO3yEZTHHOCMy9eb/4Tmi8cVf3Lf7P53SY2hX3PSN033As3ETIMLHWumWEO9JXHA2y2SIBlIPpLGG2qvNsCIlIr+B1SWAqRKm2w6Blf7U+zCSBwJrfHG5i8J5Gax/cVonMlon7aHJX/gSvucIncRP93XCqkv7D8IFKFsLiBgHqUpXhE3pYjEcV1dk/JD9zFVCfEaQIVX8Jmfz7IIofcBKQ4OaG+C3xC2veX9CD+iAFXDNaGg9eTVxvkbJRJlW4Nk9Wk13kn696jWppRDe/8pDrYMO9ZyxZ98ReKSz9kWKLLyk2zCZgAniCkLJVX3n1M9DYbomyahWiv/KixRIV9hj/oFz87I+HLznbPTjpa+D+bZQnMuRsljTpv90vQUt/pK7jCFnA30B/jtroSF2/m/gpWn1aQs5WeA6ghzF8SdqWI20fghdSeDOCSCmLgTkfaGgGDmw7nHFkRzGtag57IHS2na06I+gzEphXo1w/Zx2BM/jKL2nZoFjHggtFQjYi8nSVRSXIE58RPbBObXk7uuIL9+rs/5Zo7suJInEUxgsiZZAWS25iBtpEiZeBgDtghEoAE0sjcayNq85M4tbu/LF5h51335PsGzQ09O875+vUS89lkWMyNOFoip2PuyWyMP/iU2XIZdfCCJNDjebDoBLQdpy7QQZC7s9c0wjHJervQNDu2jWzBW5MSAJMr7bP+Iv92BkS/GGgzjEn7MF1IRKFwwzbjbS4/slGOmhx9cZrFu7HSEefojNv3r0UaKfKOWzXsq1zEugbzlMDFsacRJJI/iJlK3vtkZ+PLZIVMFlKA32wbq2Kd5T0uCLZ1CPkAfCdzkz2EYscjDcZq2AWfziN2covN4kXE1lQXPPLTNM1xx3tbiepcO/t3SWm4w87qfh99SL0ZnY+LKFPLPeXVM2mIIoVWt+9Nk0I7nY4O79iGYqxZ8RVz289an6NVdJWnSKZvJQCAuHNiVaDxPAFoH392t9wot5t0/qmU95eEWNbU2udUW5sN9JVqcYlvAIfLeYC33oUzzxZgSktsv21mA7Uly1FA5VnoJFh6N244Wmv3YJGFv/TCPryaw+ZORlpZjQdq/2DYXr3EZskfed0G61P09ipTKmlTQ1067Rg5+PAk5FlQ9e0SWbGf2B/08kqymOTMVOznsALHHNFH4LFRKl2F/NOiYFl9khNHnSu9Ak5sq26Ynl/i2fdTle29Y1ugqmR5Yj4YT9pvslFyYCbw0mNFr5rVQm1LvkG27QMq9ph3t8fmn6r6SQ4oSbr5tz+J1kIawGzDxb6VYOvvWhobDTXfBeNv3b4aNm5XUinsCGqG2q/45m3+LoCOsddFceYhRx1Tsss9PLdPfJdErFMjYd3gddjiP0+XQjcRadZP6bwNLySvunFf20Czy6JqdEW2a96KxdYdOryBv1BjbuUq2yCHeh+6sk7fGmmPi50pe/1l5TyPe5oHW9oPnhPswLyf2TFDdCyYlhwBCstv5C1HwlW7xWoGT9XZt4qVj5WryLPLLD6h/5cMLEjWzgCeAIKNsLak92aBqBsHl4AJwl2N4jfvbSkBExGimv0nFvv09uDScQbjx+w4kPQjgjlW+g9ws9VEJvI2k8N6XxVu0uIwovgTFdunG24gBtaDi+y1YLQwZ8mwbip5fVlO3k0n0AEr/ETbtu8Vjkm+nNSiEb7X/3fMjBL5A8PdgG+/FnbexbFFExmEfetXAnisEKy5z44WVPpQZjSy/jzeGn4yDRsFGqhh87QPaDBWhlo37IFbe/C0xynS91d2tP/AJoJS0sVF6iwAAAAAElFTkSuQmCC");
}

#menu::after {
  display: block;
  content: '';
  padding-top: 80px;
}

#logo {
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: rgba(255,255,255,.1);
  font-size: 11px;
  display: block;
  width: 20px;
  height: 20px;
  line-height: 20px;
  text-align: center;
  -webkit-border-radius: 20px;
  -moz-border-radius: 20px;
  border-radius: 20px;
  -webkit-box-shadow: 0 0 3px rgba(0,0,0,.2);
  -moz-box-shadow: 0 0 3px rgba(0,0,0,.2);
  box-shadow: 0 0 3px rgba(0,0,0,.2);
  color: inherit;
}

#menu li a {
  display: block;
  color: white;
  padding: 0 35px 0 25px;
  -webkit-transition: background 300ms;
  -moz-transition: background 300ms;
}

#menu li {
  position: relative;
  list-style: none;
}

#menu a:hover,
#menu a.active {
  text-decoration: none;
  background: rgba(255,255,255,.1);
}

#menu li:hover .cov {
  opacity: 1;
}

#menu li .dirname {
  opacity: .60;
  padding-right: 2px;
}

#menu li .basename {
  opacity: 1;
}

#menu .cov {
  background: rgba(0,0,0,.4);
  position: absolute;
  top: 0;
  right: 8px;
  font-size: 9px;
  opacity: .6;
  text-align: left;
  width: 17px;
  -webkit-border-radius: 10px;
  -moz-border-radius: 10px;
  border-radius: 10px;
  padding: 2px 3px;
  text-align: center;
}

#stats:nth-child(2n) {
  display: inline-block;
  margin-top: 15px;
  border: 1px solid #eee;
  padding: 10px;
  -webkit-box-shadow: inset 0 0 2px #eee;
  -moz-box-shadow: inset 0 0 2px #eee;
  box-shadow: inset 0 0 2px #eee;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border-radius: 5px;
}

#stats div {
  float: left;
  padding: 0 5px;
}

#stats::after {
  display: block;
  content: '';
  clear: both;
}

#stats .sloc::after {
  content: ' SLOC';
  color: #b6b6b6;
}

#stats .percentage::after {
  content: ' coverage';
  color: #b6b6b6;
}

#stats .hits,
#stats .misses {
  display: none;
}

.high {
  color: #00d4b4;
}
.medium {
  color: #e87d0d;
}
.low {
  color: #d4081a;
}
.terrible {
  color: #d4081a;
  font-weight: bold;
}

table {
  width: 80%;
  margin-top: 10px;
  border-collapse: collapse;
  border: 1px solid #cbcbcb;
  color: #363636;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
}

table thead {
  display: none;
}

table td.line,
table td.hits {
  width: 20px;
  background: #eaeaea;
  text-align: center;
  font-size: 11px;
  padding: 0 10px;
  color: #949494;
}

table td.hits {
  width: 10px;
  padding: 2px 5px;
  color: rgba(0,0,0,.2);
  background: #f0f0f0;
}

tr.miss td.line,
tr.miss td.hits {
  background: #e6c3c7;
}

tr.miss td {
  background: #f8d5d8;
}

td.source {
  padding-left: 15px;
  line-height: 15px;
  white-space: pre;
  font: 12px monaco, monospace;
}

code .comment { color: #ddd }
code .init { color: #2F6FAD }
code .string { color: #5890AD }
code .keyword { color: #8A6343 }
code .number { color: #2F6FAD }
</style></head><body><div id="coverage"><h1 id="overview">Coverage</h1><div id="menu"><li><a href="#overview">overview</a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/config.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/</span><span class="basename">config.coffee</span></a></li><li><span class="cov high">90</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/auth.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">auth.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/connect.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">connect.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/query.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">query.coffee</span></a></li><li><span class="cov high">77</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/socket.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">socket.coffee</span></a></li><li><span class="cov high">96</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/storage.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">storage.coffee</span></a></li><li><span class="cov high">96</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/sync.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">sync.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/table.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">table.coffee</span></a></li><li><span class="cov high">95</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/controllers/validation.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/controllers/</span><span class="basename">validation.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/list.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">list.coffee</span></a></li><li><span class="cov high">96</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/list_tasks.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">list_tasks.coffee</span></a></li><li><span class="cov high">97</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/login.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">login.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/pref.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">pref.coffee</span></a></li><li><span class="cov high">97</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/register.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">register.coffee</span></a></li><li><span class="cov high">97</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/reset.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">reset.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/task.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">task.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/time_list.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">time_list.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/time_pref.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">time_pref.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/time_task.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">time_task.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/database/user.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/database/</span><span class="basename">user.coffee</span></a></li><li><span class="cov high">99</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/models/user.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/models/</span><span class="basename">user.coffee</span></a></li><li><span class="cov high">75</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/utils/keychain.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/utils/</span><span class="basename">keychain.coffee</span></a></li><li><span class="cov high">92</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/utils/log.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/utils/</span><span class="basename">log.coffee</span></a></li><li><span class="cov high">100</span><a href="#/Volumes/Home/Projects/Nitro-Sync/app/utils/time.coffee"><span class="dirname">/Volumes/Home/Projects/Nitro-Sync/app/utils/</span><span class="basename">time.coffee</span></a></li><a id="logo" href="http://visionmedia.github.io/mocha/">m</a></div><div id="stats" class="high"><div class="percentage">93%</div><div class="sloc">1130</div><div class="hits">1052</div><div class="misses">78</div></div><div id="files"><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/config.coffee">/Volumes/Home/Projects/Nitro-Sync/app/config.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">12</div><div class="hits">12</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var config, keychain;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  keychain = require('./utils/keychain');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  config = {</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">    use: function(platform) {</td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">      var key, value, _ref, _results;</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">      _ref = config[platform];</td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">      _results = [];</td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">      for (key in _ref) {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">3</td><td class="source">        value = _ref[key];</td></tr><tr class="hit"><td class="line">13</td><td class="hits">3</td><td class="source">        _results.push(config[key] = value);</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">15</td><td class="hits">1</td><td class="source">      return _results;</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">    production: {</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">      url: 'http://sync.nitrotasks.com',</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">      port: process.env.PORT || 8080,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">      database: {</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">        engine: keychain('sql_type'),</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">        host: keychain('sql_host'),</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">        port: keychain('sql_port'),</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">        user: keychain('sql_user'),</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">        password: keychain('sql_pass'),</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">        database: keychain('sql_db')</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">    development: {</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">      url: 'http://localhost:8080',</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">      port: process.env.PORT || 8080,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">      database: {</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">        engine: 'mysql',</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">        host: '127.0.0.1',</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">        port: 3306,</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">        user: 'nodejs',</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">        password: 'nodejs',</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">        database: 'Nitro'</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    testing: {</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">      url: 'http://localhost:8080',</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">      port: 8080,</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">      database: {</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">        engine: 'mysql',</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">        host: '127.0.0.1',</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">        port: 3306,</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">        user: 'nodejs',</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">        password: 'nodejs',</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">        database: 'Nitro_Test',</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">        charset: 'utf8'</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">56</td><td class="hits">1</td><td class="source">  module.exports = config;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/auth.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/auth.coffee</h2><div id="stats" class="high"><div class="percentage">90%</div><div class="sloc">54</div><div class="hits">49</div><div class="misses">5</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Auth, ERR_BAD_EMAIL, ERR_BAD_NAME, ERR_BAD_PASS, Keys, LOGIN_TOKEN_LENGTH, Q, REGISTRATION_TOKEN_LENGTH, RESET_TOKEN_LENGTH, Storage, bcrypt, crypto;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  bcrypt = require('bcrypt');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  crypto = require('crypto');</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  Storage = require('../controllers/storage');</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">12</td><td class="hits">1</td><td class="source">  Keys = require('../utils/keychain');</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">  bcrypt = {</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">    compare: Q.bindPromise(bcrypt.compare, bcrypt),</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    hash: Q.bindPromise(bcrypt.hash, bcrypt),</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">    salt: Q.bindPromise(bcrypt.genSalt, bcrypt)</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">  RESET_TOKEN_LENGTH = 22;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">  LOGIN_TOKEN_LENGTH = 64;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">  REGISTRATION_TOKEN_LENGTH = 22;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">  ERR_BAD_PASS = 'err_bad_pass';</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  ERR_BAD_EMAIL = 'err_bad_email';</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">  ERR_BAD_NAME = 'err_bad_name';</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">  Auth = {</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">     * Hash some data using bcrypt</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">     * The salt is randomly generated.</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">     * - data (string)</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">     * &gt; encrypted data</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    hash: function(data) {</td></tr><tr class="hit"><td class="line">42</td><td class="hits">6</td><td class="source">      return bcrypt.salt(10).then(function(salt) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">6</td><td class="source">        return bcrypt.hash(data, salt);</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">     * Check a hash against some data</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">     * - data (string)</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">     * - hash (buffer?)</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    compare: function(data, hash) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">6</td><td class="source">      return bcrypt.compare(data, hash);</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">     * Wrap crypto.randomBytes in a promise</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">     * - len (int) : number of bytes to get</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">     * &gt; buffer</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">    randomBytes: Q.bindPromise(crypto.randomBytes, crypto),</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">     * Generate a random string of a certain length.</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">     * We generate a bunch of random bytes and then covert them to base64.</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">     * We make sure to generate more bytes then we need and then cut</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">     * the excess off. This way we don't get any of the base64 padding.</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">     * - len (int) : The length of the string</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">    createToken: function(len) {</td></tr><tr class="hit"><td class="line">74</td><td class="hits">14</td><td class="source">      var byteLen;</td></tr><tr class="hit"><td class="line">75</td><td class="hits">14</td><td class="source">      byteLen = Math.ceil(len / 2);</td></tr><tr class="hit"><td class="line">76</td><td class="hits">14</td><td class="source">      return Auth.randomBytes(byteLen).then(function(bytes) {</td></tr><tr class="hit"><td class="line">77</td><td class="hits">14</td><td class="source">        return bytes.toString('hex').slice(0, len);</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">     * Generate a password reset token for a user</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">     * - email (string) : the email of the user</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">     * &gt; token</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">    createResetToken: function(email) {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">2</td><td class="source">      return Q.all([Auth.createToken(RESET_TOKEN_LENGTH), Storage.getByEmail(email)]).then(function(_arg) {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">1</td><td class="source">        var token, user;</td></tr><tr class="hit"><td class="line">90</td><td class="hits">1</td><td class="source">        token = _arg[0], user = _arg[1];</td></tr><tr class="hit"><td class="line">91</td><td class="hits">1</td><td class="source">        return Storage.addResetToken(user.id, token);</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">     * Create a login token for a user</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">     * - id (int) : The user id</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">     * &gt; token</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">    createLoginToken: function(id) {</td></tr><tr class="hit"><td class="line">102</td><td class="hits">3</td><td class="source">      return Auth.createToken(LOGIN_TOKEN_LENGTH).then(function(token) {</td></tr><tr class="hit"><td class="line">103</td><td class="hits">3</td><td class="source">        return Storage.addLoginToken(id, token);</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">     * Generate a login token for a user</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">     * Only works if the email and password match</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">     * - email (string)</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">     * - pass (string) : plaintext</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">     * &gt; user and token info</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">     * ! err_bad_pass</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">    login: function(email, pass) {</td></tr><tr class="hit"><td class="line">117</td><td class="hits">4</td><td class="source">      var user;</td></tr><tr class="hit"><td class="line">118</td><td class="hits">4</td><td class="source">      user = null;</td></tr><tr class="hit"><td class="line">119</td><td class="hits">4</td><td class="source">      return Storage.getByEmail(email).then(function(_user) {</td></tr><tr class="hit"><td class="line">120</td><td class="hits">4</td><td class="source">        user = _user;</td></tr><tr class="hit"><td class="line">121</td><td class="hits">4</td><td class="source">        return user.getPassword('password');</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">      }).then(function(password) {</td></tr><tr class="hit"><td class="line">123</td><td class="hits">4</td><td class="source">        return Auth.compare(pass, password);</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">      }).then(function(same) {</td></tr><tr class="hit"><td class="line">125</td><td class="hits">4</td><td class="source">        if (!same) {</td></tr><tr class="hit"><td class="line">126</td><td class="hits">1</td><td class="source">          throw ERR_BAD_PASS;</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">128</td><td class="hits">3</td><td class="source">        return Auth.createLoginToken(user.id);</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">      }).then(function(token) {</td></tr><tr class="hit"><td class="line">130</td><td class="hits">3</td><td class="source">        return [user.id, token];</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">      }).fail(function() {</td></tr><tr class="hit"><td class="line">132</td><td class="hits">1</td><td class="source">        throw ERR_BAD_PASS;</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">     * Register a user.</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">     * Hashes the users password and stores it in the database</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">     * - name (string)</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">     * - email (string)</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">     * - pass (string) : plaintext</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">     * &gt; registration token</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">     * ! err_bad_name</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">     * ! err_bad_email</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">     * ! err_bad_pass</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">    register: function(name, email, pass) {</td></tr><tr class="hit"><td class="line">149</td><td class="hits">4</td><td class="source">      if (name.length === 0) {</td></tr><tr class="miss"><td class="line">150</td><td class="hits">0</td><td class="source">        return Q.reject(ERR_BAD_NAME);</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">152</td><td class="hits">4</td><td class="source">      if (email.length === 0) {</td></tr><tr class="miss"><td class="line">153</td><td class="hits">0</td><td class="source">        return Q.reject(ERR_BAD_EMAIL);</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">155</td><td class="hits">4</td><td class="source">      if (pass.length === 0) {</td></tr><tr class="miss"><td class="line">156</td><td class="hits">0</td><td class="source">        return Q.reject(ERR_BAD_PASS);</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">158</td><td class="hits">4</td><td class="source">      return Q.all([Auth.createToken(REGISTRATION_TOKEN_LENGTH), Auth.hash(pass)]).then(function(_arg) {</td></tr><tr class="hit"><td class="line">159</td><td class="hits">4</td><td class="source">        var hash, token;</td></tr><tr class="hit"><td class="line">160</td><td class="hits">4</td><td class="source">        token = _arg[0], hash = _arg[1];</td></tr><tr class="hit"><td class="line">161</td><td class="hits">4</td><td class="source">        return Storage.register(token, name, email, hash);</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">     * Verify a registration using a token.</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">     * Should be used to verify that the user owns the email address.</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">     * - token (string) : the registration token</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source">     * &gt; user info stored at registration</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">    verifyRegistration: function(token) {</td></tr><tr class="hit"><td class="line">173</td><td class="hits">4</td><td class="source">      return Storage.getRegistration(token).then(function(user) {</td></tr><tr class="hit"><td class="line">174</td><td class="hits">4</td><td class="source">        return Storage.add({</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">          name: user.name,</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">          email: user.email,</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">          password: user.password</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">     * Change a users password</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">     * - user (user) : the user instance</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">     * - pass (string) : plaintext</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">    changePassword: function(user, pass) {</td></tr><tr class="miss"><td class="line">189</td><td class="hits">0</td><td class="source">      return Auth.hash(pass).then(function(hash) {</td></tr><tr class="miss"><td class="line">190</td><td class="hits">0</td><td class="source">        return user.setPassword(hash);</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">195</td><td class="hits">1</td><td class="source">  module.exports = Auth;</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/connect.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/connect.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">11</div><div class="hits">11</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Knex, Q, config, connect, url;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  url = require('url');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Knex = require('knex');</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  config = require('../config');</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">12</td><td class="hits">1</td><td class="source">  connect = {</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">    ready: Q.defer(),</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">     * - type (string) : 'production', 'development', 'testing'</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">    init: function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">      console.log('intializing');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">      this.db = Knex.initialize({</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">        client: config.database.engine,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">        connection: config.database</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">      return this.ready.resolve();</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  module.exports = connect;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/query.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/query.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">35</div><div class="hits">35</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Log, Q, connect, connected, createTables, log, resetTables, tables, warn;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  connect = require('../controllers/connect');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Log = require('../utils/log');</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  log = Log('Database', 'blue');</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">12</td><td class="hits">1</td><td class="source">  warn = Log('Database', 'red');</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">  tables = {</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">    user: require('../database/user'),</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    list: require('../database/list'),</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">    task: require('../database/task'),</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">    pref: require('../database/pref'),</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">    login: require('../database/login'),</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">    reset: require('../database/reset'),</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">    register: require('../database/register'),</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">    list_tasks: require('../database/list_tasks'),</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    time_task: require('../database/time_task'),</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">    time_list: require('../database/time_list'),</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    time_pref: require('../database/time_pref')</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  createTables = function() {</td></tr><tr class="hit"><td class="line">29</td><td class="hits">9</td><td class="source">    var Table, name, promise, table, _fn;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">9</td><td class="source">    promise = Q.resolve();</td></tr><tr class="hit"><td class="line">31</td><td class="hits">9</td><td class="source">    _fn = function(table) {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">99</td><td class="source">      return promise = promise.then(function() {</td></tr><tr class="hit"><td class="line">33</td><td class="hits">99</td><td class="source">        return table.setup();</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"><td class="line">36</td><td class="hits">9</td><td class="source">    for (name in tables) {</td></tr><tr class="hit"><td class="line">37</td><td class="hits">99</td><td class="source">      Table = tables[name];</td></tr><tr class="hit"><td class="line">38</td><td class="hits">99</td><td class="source">      module.exports[name] = table = new Table(connect.db);</td></tr><tr class="hit"><td class="line">39</td><td class="hits">99</td><td class="source">      _fn(table);</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">41</td><td class="hits">9</td><td class="source">    return promise;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">  resetTables = function() {</td></tr><tr class="hit"><td class="line">45</td><td class="hits">8</td><td class="source">    var name, promise, _fn, _i, _ref;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">8</td><td class="source">    promise = Q.resolve();</td></tr><tr class="hit"><td class="line">47</td><td class="hits">8</td><td class="source">    _ref = Object.keys(tables);</td></tr><tr class="hit"><td class="line">48</td><td class="hits">8</td><td class="source">    _fn = function(name) {</td></tr><tr class="hit"><td class="line">49</td><td class="hits">88</td><td class="source">      return promise = promise.then(function() {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">88</td><td class="source">        return module.exports[name]._dropTable();</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"><td class="line">53</td><td class="hits">8</td><td class="source">    for (_i = _ref.length - 1; _i &gt;= 0; _i += -1) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">88</td><td class="source">      name = _ref[_i];</td></tr><tr class="hit"><td class="line">55</td><td class="hits">88</td><td class="source">      _fn(name);</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">57</td><td class="hits">8</td><td class="source">    return promise.then(function() {</td></tr><tr class="hit"><td class="line">58</td><td class="hits">8</td><td class="source">      return createTables();</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">  connected = connect.ready.then(function() {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">    module.exports.query = connect.db;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">1</td><td class="source">    return createTables(connect.db);</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">  module.exports = {</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    connected: connected,</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    resetTables: resetTables</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/socket.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/socket.coffee</h2><div id="stats" class="high"><div class="percentage">77%</div><div class="sloc">235</div><div class="hits">181</div><div class="misses">54</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var CLASSES, CREATE, DESTROY, GuestSocket, INBOX, Jandal, LIST, Log, PREF, SERVER_PREFIX, SOCKET_URL, Socket, Storage, Sync, TASK, TIMEOUT_AUTH, UPDATE, UserSocket, Validation, init, log, sockjs, xType,</td></tr><tr class="hit"><td class="line">3</td><td class="hits">3356</td><td class="source">    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">5</td><td class="hits">14</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">7</td><td class="hits">1</td><td class="source">  sockjs = require('sockjs');</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">  Jandal = require('jandal');</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">  xType = require('xtype');</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">13</td><td class="hits">1</td><td class="source">  Sync = require('../controllers/sync');</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">15</td><td class="hits">1</td><td class="source">  Storage = require('../controllers/storage');</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">  Validation = require('../controllers/validation');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">  Log = require('../utils/log');</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">  log = Log('Socket', 'yellow');</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">  Jandal.handle('node');</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">  SERVER_PREFIX = 's';</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">  SOCKET_URL = '/socket';</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">  CREATE = 0;</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">  UPDATE = 1;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">  DESTROY = 2;</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">  TASK = 'task';</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">  LIST = 'list';</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">  PREF = 'pref';</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">  INBOX = 'inbox';</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">  TIMEOUT_AUTH = 3000;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">  CLASSES = [TASK, LIST, PREF];</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  /*</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">   * Init</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">   *</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">   * Start the SockJS server and attach it to the HTTP server</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">   *</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">   * - server (Server) - web server to attach to</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">   * - [sjs] (SockJS) - used for testing so we can inject our own mock server</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  */</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">57</td><td class="hits">1</td><td class="source">  init = function(server, sjs) {</td></tr><tr class="hit"><td class="line">58</td><td class="hits">18</td><td class="source">    var websockets;</td></tr><tr class="hit"><td class="line">59</td><td class="hits">18</td><td class="source">    if (sjs == null) {</td></tr><tr class="miss"><td class="line">60</td><td class="hits">0</td><td class="source">      sjs = sockjs;</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">62</td><td class="hits">18</td><td class="source">    websockets = sjs.createServer();</td></tr><tr class="hit"><td class="line">63</td><td class="hits">18</td><td class="source">    websockets.installHandlers(server, {</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">      prefix: SOCKET_URL</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    });</td></tr><tr class="hit"><td class="line">66</td><td class="hits">18</td><td class="source">    return websockets.on('connection', function(socket) {</td></tr><tr class="hit"><td class="line">67</td><td class="hits">26</td><td class="source">      return new GuestSocket(socket);</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">  Socket = (function() {</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">     * Socket</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">     * - _socket (Socket) : a WebSocket connection</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">78</td><td class="hits">1</td><td class="source">    function Socket(_socket) {</td></tr><tr class="hit"><td class="line">79</td><td class="hits">49</td><td class="source">      this._socket = _socket;</td></tr><tr class="hit"><td class="line">80</td><td class="hits">49</td><td class="source">      this.close = __bind(this.close, this);</td></tr><tr class="hit"><td class="line">81</td><td class="hits">49</td><td class="source">      this.end = __bind(this.end, this);</td></tr><tr class="hit"><td class="line">82</td><td class="hits">49</td><td class="source">      this.release = __bind(this.release, this);</td></tr><tr class="hit"><td class="line">83</td><td class="hits">49</td><td class="source">      this.bindEvents = __bind(this.bindEvents, this);</td></tr><tr class="hit"><td class="line">84</td><td class="hits">49</td><td class="source">      this.socket = new Jandal(this._socket);</td></tr><tr class="hit"><td class="line">85</td><td class="hits">49</td><td class="source">      this.bindEvents();</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">     * (Private) Bind Events</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">     * Loop thorough each event in @events and bind them to the socket.</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">     * @events should be an object in the format { &lt;namespace&gt;: [ &lt;event&gt; ] }</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">     * The function handler should be named &lt;namespace&gt;_&lt;event&gt;</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">     * - [action] (string)</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">99</td><td class="hits">1</td><td class="source">    Socket.prototype.bindEvents = function(action) {</td></tr><tr class="hit"><td class="line">100</td><td class="hits">72</td><td class="source">      var event, fn, id, methods, name, ns, _ref, _results;</td></tr><tr class="hit"><td class="line">101</td><td class="hits">72</td><td class="source">      if (action == null) {</td></tr><tr class="hit"><td class="line">102</td><td class="hits">49</td><td class="source">        action = 'on';</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">104</td><td class="hits">72</td><td class="source">      if (!this.events) {</td></tr><tr class="miss"><td class="line">105</td><td class="hits">0</td><td class="source">        return;</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">107</td><td class="hits">72</td><td class="source">      _ref = this.events;</td></tr><tr class="hit"><td class="line">108</td><td class="hits">72</td><td class="source">      _results = [];</td></tr><tr class="hit"><td class="line">109</td><td class="hits">72</td><td class="source">      for (name in _ref) {</td></tr><tr class="hit"><td class="line">110</td><td class="hits">164</td><td class="source">        methods = _ref[name];</td></tr><tr class="hit"><td class="line">111</td><td class="hits">164</td><td class="source">        ns = this.socket.namespace(name);</td></tr><tr class="hit"><td class="line">112</td><td class="hits">164</td><td class="source">        _results.push((function() {</td></tr><tr class="hit"><td class="line">113</td><td class="hits">164</td><td class="source">          var _i, _len, _results1;</td></tr><tr class="hit"><td class="line">114</td><td class="hits">164</td><td class="source">          _results1 = [];</td></tr><tr class="hit"><td class="line">115</td><td class="hits">164</td><td class="source">          for (_i = 0, _len = methods.length; _i &lt; _len; _i++) {</td></tr><tr class="hit"><td class="line">116</td><td class="hits">325</td><td class="source">            event = methods[_i];</td></tr><tr class="hit"><td class="line">117</td><td class="hits">325</td><td class="source">            id = name + '_' + event;</td></tr><tr class="hit"><td class="line">118</td><td class="hits">325</td><td class="source">            fn = xType.guard(id, this[id], this);</td></tr><tr class="hit"><td class="line">119</td><td class="hits">325</td><td class="source">            _results1.push(ns[action](event, fn));</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">          }</td></tr><tr class="hit"><td class="line">121</td><td class="hits">164</td><td class="source">          return _results1;</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">        }).call(this));</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">124</td><td class="hits">72</td><td class="source">      return _results;</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">     * Release</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">     * Release control over the web socket.</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">     * This just unbinds all the events.</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">135</td><td class="hits">1</td><td class="source">    Socket.prototype.release = function() {</td></tr><tr class="hit"><td class="line">136</td><td class="hits">23</td><td class="source">      return this.bindEvents('removeListener');</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">     * End</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">     * Disconnect the socket from the server using the default status code and</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">     * error message.</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">147</td><td class="hits">1</td><td class="source">    Socket.prototype.end = function() {</td></tr><tr class="miss"><td class="line">148</td><td class="hits">0</td><td class="source">      return this._socket.end();</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">     * Close</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">     * Close the socket connection and also send a status code and error message.</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">     * Status codes: http://tools.ietf.org/html/rfc6455#section-7.4.1</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">     * - status (int)</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">     * - message (string)</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">162</td><td class="hits">1</td><td class="source">    Socket.prototype.close = function(status, message) {</td></tr><tr class="hit"><td class="line">163</td><td class="hits">3</td><td class="source">      return this._socket.close(status, message);</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">166</td><td class="hits">1</td><td class="source">    return Socket;</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">  })();</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">1</td><td class="source">  GuestSocket = (function(_super) {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">1</td><td class="source">    __extends(GuestSocket, _super);</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">173</td><td class="hits">1</td><td class="source">    GuestSocket.prototype.events = {</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">      user: ['auth']</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">     * GuestSocket</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">     * This will handle a newly created socket and allow them to authenticate</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">     * themselves. There is a limited time to authenticate before the socket</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">     * will be automatically closed. This is done so that the server doesn't</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">     * have to handle any more sockets than it needs to.</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">     * - socket (Jandal)</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">189</td><td class="hits">1</td><td class="source">    function GuestSocket(socket) {</td></tr><tr class="hit"><td class="line">190</td><td class="hits">26</td><td class="source">      this.timeout = __bind(this.timeout, this);</td></tr><tr class="hit"><td class="line">191</td><td class="hits">26</td><td class="source">      this.kick = __bind(this.kick, this);</td></tr><tr class="hit"><td class="line">192</td><td class="hits">26</td><td class="source">      this.login = __bind(this.login, this);</td></tr><tr class="hit"><td class="line">193</td><td class="hits">26</td><td class="source">      this.user_auth = __bind(this.user_auth, this);</td></tr><tr class="hit"><td class="line">194</td><td class="hits">26</td><td class="source">      GuestSocket.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">195</td><td class="hits">26</td><td class="source">      log('A new guest has connected');</td></tr><tr class="hit"><td class="line">196</td><td class="hits">26</td><td class="source">      this.authenticated = false;</td></tr><tr class="hit"><td class="line">197</td><td class="hits">26</td><td class="source">      this.authTimeout = setTimeout(this.timeout, TIMEOUT_AUTH);</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">     * User Authentication</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">     * The callback function will only be called if authentication is successful,</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source">     * otherwise the socket will be instantly closed and an error message will be</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">     * sent back with it.</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">     * - userId (int) : id of the user</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">     * - token (string) : login token</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">     * - fn (function) : callback</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">213</td><td class="hits">1</td><td class="source">    GuestSocket.prototype.user_auth = function(userId, token, fn) {</td></tr><tr class="hit"><td class="line">214</td><td class="hits">24</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">215</td><td class="hits">24</td><td class="source">      this.userId = userId;</td></tr><tr class="hit"><td class="line">216</td><td class="hits">24</td><td class="source">      clearTimeout(this.authTimeout);</td></tr><tr class="hit"><td class="line">217</td><td class="hits">24</td><td class="source">      return Storage.checkLoginToken(this.userId, token).then(function(exists) {</td></tr><tr class="hit"><td class="line">218</td><td class="hits">24</td><td class="source">        if (exists) {</td></tr><tr class="hit"><td class="line">219</td><td class="hits">23</td><td class="source">          return _this.login(fn);</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">        } else {</td></tr><tr class="hit"><td class="line">221</td><td class="hits">1</td><td class="source">          return _this.kick();</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source">      }).fail(function(err) {</td></tr><tr class="miss"><td class="line">224</td><td class="hits">0</td><td class="source">        log(err);</td></tr><tr class="miss"><td class="line">225</td><td class="hits">0</td><td class="source">        return _this.kick(err);</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">     * (Private) User Login</td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">     * This handles logging in a user after they have been authenticated.</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source">     * It releases control of the Jandal instance and then creates a new</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">     * UserSocket. If an error occurs, the socket will be closed.</td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">     * - fn (callback)</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">240</td><td class="hits">1</td><td class="source">    GuestSocket.prototype.login = function(fn) {</td></tr><tr class="hit"><td class="line">241</td><td class="hits">23</td><td class="source">      var socket,</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">243</td><td class="hits">23</td><td class="source">      socket = this._socket;</td></tr><tr class="hit"><td class="line">244</td><td class="hits">23</td><td class="source">      this.release();</td></tr><tr class="hit"><td class="line">245</td><td class="hits">23</td><td class="source">      return Storage.get(this.userId).then(function(user) {</td></tr><tr class="hit"><td class="line">246</td><td class="hits">23</td><td class="source">        new UserSocket(socket, user);</td></tr><tr class="hit"><td class="line">247</td><td class="hits">23</td><td class="source">        return fn(null, true);</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">      }).fail(function(err) {</td></tr><tr class="miss"><td class="line">249</td><td class="hits">0</td><td class="source">        log(err);</td></tr><tr class="miss"><td class="line">250</td><td class="hits">0</td><td class="source">        return _this.kick(err);</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">254</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">     * (Private) Kick</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">257</td><td class="hits"></td><td class="source">     * This will close a socket because authentication has failed.</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">259</td><td class="hits"></td><td class="source">     * [message] (string) : Optional error message</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">263</td><td class="hits">1</td><td class="source">    GuestSocket.prototype.kick = function(message) {</td></tr><tr class="hit"><td class="line">264</td><td class="hits">1</td><td class="source">      if (message == null) {</td></tr><tr class="hit"><td class="line">265</td><td class="hits">1</td><td class="source">        message = 'err_bad_token';</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">267</td><td class="hits">1</td><td class="source">      return this.close(3002, message);</td></tr><tr><td class="line">268</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">     * (Private) Timeout</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">273</td><td class="hits"></td><td class="source">     * This will close a socket because no attempt was made to authenticate</td></tr><tr><td class="line">274</td><td class="hits"></td><td class="source">     * within the time limit.</td></tr><tr><td class="line">275</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">277</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">278</td><td class="hits">1</td><td class="source">    GuestSocket.prototype.timeout = function() {</td></tr><tr class="hit"><td class="line">279</td><td class="hits">2</td><td class="source">      return this.close(1002, 'err_auth_timeout');</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">282</td><td class="hits">1</td><td class="source">    return GuestSocket;</td></tr><tr><td class="line">283</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">  })(Socket);</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">286</td><td class="hits">1</td><td class="source">  UserSocket = (function(_super) {</td></tr><tr class="hit"><td class="line">287</td><td class="hits">1</td><td class="source">    __extends(UserSocket, _super);</td></tr><tr><td class="line">288</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">289</td><td class="hits">1</td><td class="source">    UserSocket.prototype.events = {</td></tr><tr><td class="line">290</td><td class="hits"></td><td class="source">      queue: ['sync'],</td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source">      user: ['info'],</td></tr><tr><td class="line">292</td><td class="hits"></td><td class="source">      list: ['create', 'update', 'destroy', 'fetch'],</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">      task: ['create', 'update', 'destroy', 'fetch'],</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">      pref: ['update', 'fetch']</td></tr><tr><td class="line">295</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">297</td><td class="hits">1</td><td class="source">    function UserSocket(socket, user) {</td></tr><tr class="hit"><td class="line">298</td><td class="hits">23</td><td class="source">      this.user = user;</td></tr><tr class="hit"><td class="line">299</td><td class="hits">23</td><td class="source">      this.queue_sync = __bind(this.queue_sync, this);</td></tr><tr class="hit"><td class="line">300</td><td class="hits">23</td><td class="source">      this.list_destroy = __bind(this.list_destroy, this);</td></tr><tr class="hit"><td class="line">301</td><td class="hits">23</td><td class="source">      this.task_destroy = __bind(this.task_destroy, this);</td></tr><tr class="hit"><td class="line">302</td><td class="hits">23</td><td class="source">      this.destroy = __bind(this.destroy, this);</td></tr><tr class="hit"><td class="line">303</td><td class="hits">23</td><td class="source">      this.pref_update = __bind(this.pref_update, this);</td></tr><tr class="hit"><td class="line">304</td><td class="hits">23</td><td class="source">      this.list_update = __bind(this.list_update, this);</td></tr><tr class="hit"><td class="line">305</td><td class="hits">23</td><td class="source">      this.task_update = __bind(this.task_update, this);</td></tr><tr class="hit"><td class="line">306</td><td class="hits">23</td><td class="source">      this.update = __bind(this.update, this);</td></tr><tr class="hit"><td class="line">307</td><td class="hits">23</td><td class="source">      this.list_create = __bind(this.list_create, this);</td></tr><tr class="hit"><td class="line">308</td><td class="hits">23</td><td class="source">      this.task_create = __bind(this.task_create, this);</td></tr><tr class="hit"><td class="line">309</td><td class="hits">23</td><td class="source">      this.create = __bind(this.create, this);</td></tr><tr class="hit"><td class="line">310</td><td class="hits">23</td><td class="source">      this.pref_fetch = __bind(this.pref_fetch, this);</td></tr><tr class="hit"><td class="line">311</td><td class="hits">23</td><td class="source">      this.list_fetch = __bind(this.list_fetch, this);</td></tr><tr class="hit"><td class="line">312</td><td class="hits">23</td><td class="source">      this.task_fetch = __bind(this.task_fetch, this);</td></tr><tr class="hit"><td class="line">313</td><td class="hits">23</td><td class="source">      this.user_info = __bind(this.user_info, this);</td></tr><tr class="hit"><td class="line">314</td><td class="hits">23</td><td class="source">      this.broadcast = __bind(this.broadcast, this);</td></tr><tr class="hit"><td class="line">315</td><td class="hits">23</td><td class="source">      UserSocket.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">316</td><td class="hits">23</td><td class="source">      log('A user has been authenticated');</td></tr><tr class="hit"><td class="line">317</td><td class="hits">23</td><td class="source">      this.authenticated = true;</td></tr><tr class="hit"><td class="line">318</td><td class="hits">23</td><td class="source">      this.socket.join(this.user.id);</td></tr><tr class="hit"><td class="line">319</td><td class="hits">23</td><td class="source">      this.sync = new Sync(this.user);</td></tr><tr><td class="line">320</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">321</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">322</td><td class="hits">1</td><td class="source">    UserSocket.prototype.broadcast = function(event, arg1, arg2, arg3) {</td></tr><tr class="hit"><td class="line">323</td><td class="hits">513</td><td class="source">      return this.socket.broadcast.to(this.user.id).emit(event, arg1, arg2, arg3);</td></tr><tr><td class="line">324</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">327</td><td class="hits"></td><td class="source">     * User Info</td></tr><tr><td class="line">328</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">329</td><td class="hits"></td><td class="source">     * - fn (function)</td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">331</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">333</td><td class="hits">1</td><td class="source">    UserSocket.prototype.user_info = function(fn) {</td></tr><tr class="hit"><td class="line">334</td><td class="hits">1</td><td class="source">      return this.user.info().then(function(info) {</td></tr><tr class="hit"><td class="line">335</td><td class="hits">1</td><td class="source">        return fn(null, info);</td></tr><tr><td class="line">336</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">338</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">339</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">     * Model Fetch</td></tr><tr><td class="line">341</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">342</td><td class="hits"></td><td class="source">     * - classname (string)</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">     * - fn (function)</td></tr><tr><td class="line">344</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">345</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">346</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">347</td><td class="hits">1</td><td class="source">    UserSocket.prototype.task_fetch = function(fn) {</td></tr><tr class="hit"><td class="line">348</td><td class="hits">2</td><td class="source">      return this.user.exportTasks().then(function(info) {</td></tr><tr class="hit"><td class="line">349</td><td class="hits">2</td><td class="source">        return fn(null, info);</td></tr><tr><td class="line">350</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">351</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">352</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">353</td><td class="hits">1</td><td class="source">    UserSocket.prototype.list_fetch = function(fn) {</td></tr><tr class="miss"><td class="line">354</td><td class="hits">0</td><td class="source">      return this.user.exportLists().then(function(info) {</td></tr><tr class="miss"><td class="line">355</td><td class="hits">0</td><td class="source">        return fn(null, info);</td></tr><tr><td class="line">356</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">357</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">359</td><td class="hits">1</td><td class="source">    UserSocket.prototype.pref_fetch = function(fn) {</td></tr><tr class="miss"><td class="line">360</td><td class="hits">0</td><td class="source">      return this.user.exportPref().then(function(info) {</td></tr><tr class="miss"><td class="line">361</td><td class="hits">0</td><td class="source">        return fn(null, info);</td></tr><tr><td class="line">362</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">363</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">364</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">365</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">366</td><td class="hits"></td><td class="source">     * Model Create</td></tr><tr><td class="line">367</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">368</td><td class="hits"></td><td class="source">     * - model (object)</td></tr><tr><td class="line">369</td><td class="hits"></td><td class="source">     * - fn (function)</td></tr><tr><td class="line">370</td><td class="hits"></td><td class="source">     * - [time] (number)</td></tr><tr><td class="line">371</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">372</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">373</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">374</td><td class="hits">1</td><td class="source">    UserSocket.prototype.create = function(classname, model, fn, time) {</td></tr><tr class="hit"><td class="line">375</td><td class="hits">211</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">376</td><td class="hits">211</td><td class="source">      return this.sync[classname + '_create'](model, time).then(function(id) {</td></tr><tr class="hit"><td class="line">377</td><td class="hits">165</td><td class="source">        _this.broadcast(classname + '.create', model);</td></tr><tr class="hit"><td class="line">378</td><td class="hits">165</td><td class="source">        if (fn) {</td></tr><tr class="hit"><td class="line">379</td><td class="hits">165</td><td class="source">          fn(null, id);</td></tr><tr><td class="line">380</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">381</td><td class="hits">165</td><td class="source">        return id;</td></tr><tr><td class="line">382</td><td class="hits"></td><td class="source">      }).fail(function() {</td></tr><tr class="hit"><td class="line">383</td><td class="hits">46</td><td class="source">        if (fn) {</td></tr><tr class="hit"><td class="line">384</td><td class="hits">46</td><td class="source">          return fn(true);</td></tr><tr><td class="line">385</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">386</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">387</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">388</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">389</td><td class="hits">1</td><td class="source">    UserSocket.prototype.task_create = function(model, fn, time) {</td></tr><tr class="hit"><td class="line">390</td><td class="hits">81</td><td class="source">      return this.create(TASK, model, fn, time);</td></tr><tr><td class="line">391</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">392</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">393</td><td class="hits">1</td><td class="source">    UserSocket.prototype.list_create = function(model, fn, time) {</td></tr><tr class="hit"><td class="line">394</td><td class="hits">130</td><td class="source">      return this.create(LIST, model, fn, time);</td></tr><tr><td class="line">395</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">396</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">397</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">398</td><td class="hits"></td><td class="source">     * Model Update</td></tr><tr><td class="line">399</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">400</td><td class="hits"></td><td class="source">     * - model (object)</td></tr><tr><td class="line">401</td><td class="hits"></td><td class="source">     * - [fn] (function)</td></tr><tr><td class="line">402</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">403</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">404</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">405</td><td class="hits">1</td><td class="source">    UserSocket.prototype.update = function(classname, model, fn, time) {</td></tr><tr class="hit"><td class="line">406</td><td class="hits">604</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">407</td><td class="hits">604</td><td class="source">      return this.sync[classname + '_update'](model, time).then(function(model) {</td></tr><tr class="hit"><td class="line">408</td><td class="hits">281</td><td class="source">        _this.broadcast(classname + '.update', model);</td></tr><tr class="hit"><td class="line">409</td><td class="hits">281</td><td class="source">        if (fn) {</td></tr><tr class="hit"><td class="line">410</td><td class="hits">281</td><td class="source">          return fn(null);</td></tr><tr><td class="line">411</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">412</td><td class="hits"></td><td class="source">      }).fail(function(err) {</td></tr><tr class="hit"><td class="line">413</td><td class="hits">323</td><td class="source">        console.log(err);</td></tr><tr class="hit"><td class="line">414</td><td class="hits">323</td><td class="source">        if (fn) {</td></tr><tr class="hit"><td class="line">415</td><td class="hits">323</td><td class="source">          return fn(true);</td></tr><tr><td class="line">416</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">417</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">418</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">419</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">420</td><td class="hits">1</td><td class="source">    UserSocket.prototype.task_update = function(model, fn, time) {</td></tr><tr class="hit"><td class="line">421</td><td class="hits">125</td><td class="source">      return this.update(TASK, model, fn, time);</td></tr><tr><td class="line">422</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">423</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">424</td><td class="hits">1</td><td class="source">    UserSocket.prototype.list_update = function(model, fn, time) {</td></tr><tr class="hit"><td class="line">425</td><td class="hits">234</td><td class="source">      return this.update(LIST, model, fn, time);</td></tr><tr><td class="line">426</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">427</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">428</td><td class="hits">1</td><td class="source">    UserSocket.prototype.pref_update = function(model, fn, time) {</td></tr><tr class="hit"><td class="line">429</td><td class="hits">245</td><td class="source">      return this.update(PREF, model, fn, time);</td></tr><tr><td class="line">430</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">431</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">432</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">433</td><td class="hits"></td><td class="source">     * Model Destroy</td></tr><tr><td class="line">434</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">435</td><td class="hits"></td><td class="source">     * - model (object)</td></tr><tr><td class="line">436</td><td class="hits"></td><td class="source">     * - [fn] (function)</td></tr><tr><td class="line">437</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">438</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">439</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">440</td><td class="hits">1</td><td class="source">    UserSocket.prototype.destroy = function(classname, model, fn, time) {</td></tr><tr class="hit"><td class="line">441</td><td class="hits">197</td><td class="source">      var id,</td></tr><tr><td class="line">442</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">443</td><td class="hits">197</td><td class="source">      id = model.id;</td></tr><tr class="hit"><td class="line">444</td><td class="hits">197</td><td class="source">      return this.sync[classname + '_destroy'](id, time).then(function() {</td></tr><tr class="hit"><td class="line">445</td><td class="hits">67</td><td class="source">        _this.broadcast(classname + '.destroy', {</td></tr><tr><td class="line">446</td><td class="hits"></td><td class="source">          id: id</td></tr><tr><td class="line">447</td><td class="hits"></td><td class="source">        });</td></tr><tr class="hit"><td class="line">448</td><td class="hits">67</td><td class="source">        if (fn) {</td></tr><tr class="hit"><td class="line">449</td><td class="hits">67</td><td class="source">          return fn(null);</td></tr><tr><td class="line">450</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">451</td><td class="hits"></td><td class="source">      }).fail(function(err) {</td></tr><tr class="hit"><td class="line">452</td><td class="hits">130</td><td class="source">        console.log(err);</td></tr><tr class="hit"><td class="line">453</td><td class="hits">130</td><td class="source">        if (fn) {</td></tr><tr class="hit"><td class="line">454</td><td class="hits">130</td><td class="source">          return fn(true);</td></tr><tr><td class="line">455</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">456</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">457</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">458</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">459</td><td class="hits">1</td><td class="source">    UserSocket.prototype.task_destroy = function(model, fn, time) {</td></tr><tr class="hit"><td class="line">460</td><td class="hits">68</td><td class="source">      return this.destroy(TASK, model, fn, time);</td></tr><tr><td class="line">461</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">462</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">463</td><td class="hits">1</td><td class="source">    UserSocket.prototype.list_destroy = function(model, fn, time) {</td></tr><tr class="hit"><td class="line">464</td><td class="hits">129</td><td class="source">      return this.destroy(LIST, model, fn, time);</td></tr><tr><td class="line">465</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">466</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">467</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">468</td><td class="hits"></td><td class="source">     * Model Sync</td></tr><tr><td class="line">469</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">470</td><td class="hits"></td><td class="source">     * - queue (object)</td></tr><tr><td class="line">471</td><td class="hits"></td><td class="source">     * - fn (function)</td></tr><tr><td class="line">472</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">473</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">474</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">475</td><td class="hits">1</td><td class="source">    UserSocket.prototype.queue_sync = function(queue, fn) {</td></tr><tr class="miss"><td class="line">476</td><td class="hits">0</td><td class="source">      var event, i, id, list, lists, pref, task, taskId, tasks, time, _i, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;</td></tr><tr class="miss"><td class="line">477</td><td class="hits">0</td><td class="source">      lists = {};</td></tr><tr class="miss"><td class="line">478</td><td class="hits">0</td><td class="source">      if (queue.list) {</td></tr><tr class="miss"><td class="line">479</td><td class="hits">0</td><td class="source">        _ref = queue.list;</td></tr><tr class="miss"><td class="line">480</td><td class="hits">0</td><td class="source">        for (id in _ref) {</td></tr><tr class="miss"><td class="line">481</td><td class="hits">0</td><td class="source">          _ref1 = _ref[id], event = _ref1[0], list = _ref1[1], time = _ref1[2];</td></tr><tr class="miss"><td class="line">482</td><td class="hits">0</td><td class="source">          switch (event) {</td></tr><tr><td class="line">483</td><td class="hits"></td><td class="source">            case CREATE:</td></tr><tr class="miss"><td class="line">484</td><td class="hits">0</td><td class="source">              tasks = list.tasks;</td></tr><tr class="miss"><td class="line">485</td><td class="hits">0</td><td class="source">              for (i = _i = tasks.length - 1; _i &gt;= 0; i = _i += -1) {</td></tr><tr class="miss"><td class="line">486</td><td class="hits">0</td><td class="source">                taskId = tasks[i];</td></tr><tr class="miss"><td class="line">487</td><td class="hits">0</td><td class="source">                if (taskId[0] !== SERVER_PREFIX) {</td></tr><tr class="miss"><td class="line">488</td><td class="hits">0</td><td class="source">                  tasks.splice(i, 1);</td></tr><tr><td class="line">489</td><td class="hits"></td><td class="source">                }</td></tr><tr><td class="line">490</td><td class="hits"></td><td class="source">              }</td></tr><tr class="miss"><td class="line">491</td><td class="hits">0</td><td class="source">              list.id = id;</td></tr><tr class="miss"><td class="line">492</td><td class="hits">0</td><td class="source">              lists[id] = this.list_create(list, null, time);</td></tr><tr class="miss"><td class="line">493</td><td class="hits">0</td><td class="source">              break;</td></tr><tr><td class="line">494</td><td class="hits"></td><td class="source">            case UPDATE:</td></tr><tr class="miss"><td class="line">495</td><td class="hits">0</td><td class="source">              list.id = id;</td></tr><tr class="miss"><td class="line">496</td><td class="hits">0</td><td class="source">              this.list_update(list, null, time);</td></tr><tr class="miss"><td class="line">497</td><td class="hits">0</td><td class="source">              break;</td></tr><tr><td class="line">498</td><td class="hits"></td><td class="source">            case DESTROY:</td></tr><tr class="miss"><td class="line">499</td><td class="hits">0</td><td class="source">              this.list_destroy(list, null, time);</td></tr><tr><td class="line">500</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">501</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">502</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">503</td><td class="hits">0</td><td class="source">      if (queue.task) {</td></tr><tr class="miss"><td class="line">504</td><td class="hits">0</td><td class="source">        _ref2 = queue.task;</td></tr><tr class="miss"><td class="line">505</td><td class="hits">0</td><td class="source">        for (id in _ref2) {</td></tr><tr class="miss"><td class="line">506</td><td class="hits">0</td><td class="source">          _ref3 = _ref2[id], event = _ref3[0], task = _ref3[1], time = _ref3[2];</td></tr><tr class="miss"><td class="line">507</td><td class="hits">0</td><td class="source">          switch (event) {</td></tr><tr><td class="line">508</td><td class="hits"></td><td class="source">            case CREATE:</td></tr><tr class="miss"><td class="line">509</td><td class="hits">0</td><td class="source">              task.id = id;</td></tr><tr class="miss"><td class="line">510</td><td class="hits">0</td><td class="source">              if (lists[task.listId]) {</td></tr><tr class="miss"><td class="line">511</td><td class="hits">0</td><td class="source">                task.listId = lists[task.listId];</td></tr><tr><td class="line">512</td><td class="hits"></td><td class="source">              }</td></tr><tr class="miss"><td class="line">513</td><td class="hits">0</td><td class="source">              this.task_create(task, null, time);</td></tr><tr class="miss"><td class="line">514</td><td class="hits">0</td><td class="source">              break;</td></tr><tr><td class="line">515</td><td class="hits"></td><td class="source">            case UPDATE:</td></tr><tr class="miss"><td class="line">516</td><td class="hits">0</td><td class="source">              task.id = id;</td></tr><tr class="miss"><td class="line">517</td><td class="hits">0</td><td class="source">              if ((task.listId != null) &amp;&amp; lists[task.listId]) {</td></tr><tr class="miss"><td class="line">518</td><td class="hits">0</td><td class="source">                task.listId = lists[task.listId];</td></tr><tr><td class="line">519</td><td class="hits"></td><td class="source">              }</td></tr><tr class="miss"><td class="line">520</td><td class="hits">0</td><td class="source">              this.task_update(task, null, time);</td></tr><tr class="miss"><td class="line">521</td><td class="hits">0</td><td class="source">              break;</td></tr><tr><td class="line">522</td><td class="hits"></td><td class="source">            case DESTROY:</td></tr><tr class="miss"><td class="line">523</td><td class="hits">0</td><td class="source">              this.task_destroy(task, null, time);</td></tr><tr><td class="line">524</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">525</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">526</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">527</td><td class="hits">0</td><td class="source">      if (queue.pref) {</td></tr><tr class="miss"><td class="line">528</td><td class="hits">0</td><td class="source">        _ref4 = queue.task;</td></tr><tr class="miss"><td class="line">529</td><td class="hits">0</td><td class="source">        for (id in _ref4) {</td></tr><tr class="miss"><td class="line">530</td><td class="hits">0</td><td class="source">          _ref5 = _ref4[id], event = _ref5[0], pref = _ref5[1], time = _ref5[2];</td></tr><tr class="miss"><td class="line">531</td><td class="hits">0</td><td class="source">          switch (event) {</td></tr><tr><td class="line">532</td><td class="hits"></td><td class="source">            case UPDATE:</td></tr><tr class="miss"><td class="line">533</td><td class="hits">0</td><td class="source">              this.pref_update(pref, null, time);</td></tr><tr><td class="line">534</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">536</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">537</td><td class="hits">0</td><td class="source">      if (fn) {</td></tr><tr class="miss"><td class="line">538</td><td class="hits">0</td><td class="source">        return fn(null, {</td></tr><tr><td class="line">539</td><td class="hits"></td><td class="source">          list: this.user.exportModel(LIST),</td></tr><tr><td class="line">540</td><td class="hits"></td><td class="source">          task: this.user.exportModel(TASK),</td></tr><tr><td class="line">541</td><td class="hits"></td><td class="source">          pref: this.user.exportModel(PREF)</td></tr><tr><td class="line">542</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">543</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">544</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">545</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">546</td><td class="hits">1</td><td class="source">    return UserSocket;</td></tr><tr><td class="line">547</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">548</td><td class="hits"></td><td class="source">  })(Socket);</td></tr><tr><td class="line">549</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">550</td><td class="hits">1</td><td class="source">  module.exports = {</td></tr><tr><td class="line">551</td><td class="hits"></td><td class="source">    init: init</td></tr><tr><td class="line">552</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">553</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">554</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">555</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/storage.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/storage.coffee</h2><div id="stats" class="high"><div class="percentage">96%</div><div class="sloc">51</div><div class="hits">49</div><div class="misses">2</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var ERR_BAD_TOKEN, ERR_NO_USER, ERR_OLD_EMAIL, Log, Q, Storage, User, db, log, time;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  db = require('../controllers/query');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  time = require('../utils/time');</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  Log = require('../utils/log');</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">12</td><td class="hits">1</td><td class="source">  User = require('../models/user');</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">  log = Log('Storage', 'green');</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">  ERR_OLD_EMAIL = 'err_old_email';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">  ERR_BAD_TOKEN = 'err_bad_token';</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">  ERR_NO_USER = 'err_no_user';</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">  Storage = {</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">     * This will store user data in a temporary key until</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">     * they have verified their account.</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">     * The email used must not exist in the database.</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">     * - token (string) : special id assigned to the data</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">     * - user (object) : { name, email, password }</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">     * &gt; token</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">     * ! err_old_email</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    register: function(token, name, email, password) {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">5</td><td class="source">      return this.emailExists(email).then(function(exists) {</td></tr><tr class="hit"><td class="line">36</td><td class="hits">5</td><td class="source">        if (exists) {</td></tr><tr class="miss"><td class="line">37</td><td class="hits">0</td><td class="source">          throw ERR_OLD_EMAIL;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">39</td><td class="hits">5</td><td class="source">        return db.register.create({</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">          token: token,</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">          name: name,</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">          email: email,</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">          password: password</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">     * This will check if registration token exists.</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">     * If the token can't be found an error will be thrown.</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">     * If it is found then the registration will be deleted</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">     * and the user data returned.</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">     * - token (string) : the registration token</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">     * &gt; return user data</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">     * ! err_bad_token</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    getRegistration: function(token) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">6</td><td class="source">      return db.register.read(token).then(function(data) {</td></tr><tr class="hit"><td class="line">60</td><td class="hits">5</td><td class="source">        db.register.destroy(data.id);</td></tr><tr class="hit"><td class="line">61</td><td class="hits">5</td><td class="source">        return data;</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">      }).fail(function() {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">        throw ERR_BAD_TOKEN;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">     * This will add a user to the database</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">     * It will then return a new instance of the user</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">     * - user (object) : { name, email, password }</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">     * &gt; User</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">    add: function(user) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">12</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">76</td><td class="hits">12</td><td class="source">      return this.emailExists(user.email).then(function(exists) {</td></tr><tr class="hit"><td class="line">77</td><td class="hits">12</td><td class="source">        var id;</td></tr><tr class="hit"><td class="line">78</td><td class="hits">12</td><td class="source">        if (exists) {</td></tr><tr class="hit"><td class="line">79</td><td class="hits">3</td><td class="source">          throw ERR_OLD_EMAIL;</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">81</td><td class="hits">9</td><td class="source">        user.pro = 0;</td></tr><tr class="hit"><td class="line">82</td><td class="hits">9</td><td class="source">        id = null;</td></tr><tr class="hit"><td class="line">83</td><td class="hits">9</td><td class="source">        return db.user.create(user).then(function(_id) {</td></tr><tr class="hit"><td class="line">84</td><td class="hits">9</td><td class="source">          id = _id;</td></tr><tr class="hit"><td class="line">85</td><td class="hits">9</td><td class="source">          return db.pref.create({</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">            userId: id</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">          });</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">        }).then(function() {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">9</td><td class="source">          return time.create('pref', id, {});</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">        }).then(function() {</td></tr><tr class="hit"><td class="line">91</td><td class="hits">9</td><td class="source">          return _this.get(id);</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">     * This will retrive a user from the database by their ID.</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">     * If the user is already loaded in memory, it will return that instance,</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">     * Else it will load it from the database and add it to the records.</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">     * Will return the user as a User instance.</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">     * Will throw an error if the user can't be found.</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">     * - id (int) : The id of the user to get</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">     * &gt; User</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">     * ! err_no_user</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">    get: function(id) {</td></tr><tr class="hit"><td class="line">108</td><td class="hits">47</td><td class="source">      return db.user.read(id, 'id').then(function() {</td></tr><tr class="hit"><td class="line">109</td><td class="hits">44</td><td class="source">        return new User(id);</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">     * Get a user by their email address</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">     * - email (string)</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">     * &gt; user</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">    getByEmail: function(email) {</td></tr><tr class="hit"><td class="line">120</td><td class="hits">10</td><td class="source">      return db.user.search(email).then(this.get, function() {</td></tr><tr class="hit"><td class="line">121</td><td class="hits">2</td><td class="source">        throw ERR_NO_USER;</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">     * Check if an email address exists in the system</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">     * - email (string)</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">     * &gt; boolean</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">    emailExists: function(email) {</td></tr><tr class="hit"><td class="line">132</td><td class="hits">21</td><td class="source">      return db.user.search(email).then(function() {</td></tr><tr class="hit"><td class="line">133</td><td class="hits">6</td><td class="source">        return true;</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">      }).fail(function() {</td></tr><tr class="hit"><td class="line">135</td><td class="hits">15</td><td class="source">        return false;</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">     * Completely remove a user from the system</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">     * We could integrate it with @release(id), but that would write</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">     * it to the database, right before we instantly delete it.</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">     * - id (int) : the user id</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">    destroy: function(id) {</td></tr><tr class="hit"><td class="line">147</td><td class="hits">3</td><td class="source">      log(&quot;Removing user &quot; + id);</td></tr><tr class="hit"><td class="line">148</td><td class="hits">3</td><td class="source">      return db.user.destroy(id);</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">     * Add a new login token.</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">     * It will expire after two weeks.</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">     * - id (int) : the user id</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">     * - token (string) : the login token</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">     * &gt; token</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">    addLoginToken: function(id, token) {</td></tr><tr class="hit"><td class="line">160</td><td class="hits">4</td><td class="source">      return db.login.create(id, token).then(function() {</td></tr><tr class="hit"><td class="line">161</td><td class="hits">4</td><td class="source">        return token;</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">     * Check that a login token is valid</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">     * - id (int) : the user id</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">     * - token (string) : the login token</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source">     * &gt; boolean</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">    checkLoginToken: function(id, token) {</td></tr><tr class="hit"><td class="line">173</td><td class="hits">27</td><td class="source">      return db.login.exists(id, token);</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">     * Remove a specific login token</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">     * - id (int) : the user id</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">     * - token (string) : the login token</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">    destroyLoginToken: function(id, token) {</td></tr><tr class="hit"><td class="line">183</td><td class="hits">1</td><td class="source">      return db.login.destroy(id, token);</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">     * Remove all the login tokens for a user</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">     * - id (int) : the user id</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">    destroyAllLoginTokens: function(id) {</td></tr><tr class="miss"><td class="line">192</td><td class="hits">0</td><td class="source">      return db.login.destroyAll(id);</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">     * Add a new password reset token</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source">     * Tokens are removed after 12 hours</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">     * - id (int) : the user id</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source">     * - token (string) : the reset token</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">     * &gt; database reset token</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">    addResetToken: function(id, token) {</td></tr><tr class="hit"><td class="line">204</td><td class="hits">2</td><td class="source">      return db.reset.create(id, token);</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">     * Check that a reset token is valid</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">     * - token (string) : the reset token</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">     * &gt; int : the user id</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">    checkResetToken: function(token) {</td></tr><tr class="hit"><td class="line">214</td><td class="hits">3</td><td class="source">      return db.reset.read(token).fail(function() {</td></tr><tr class="hit"><td class="line">215</td><td class="hits">2</td><td class="source">        throw ERR_BAD_TOKEN;</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">     * Destroy a reset token</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source">     * - token (string) : the reset token</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">    destroyResetToken: function(token) {</td></tr><tr class="hit"><td class="line">225</td><td class="hits">3</td><td class="source">      return db.reset.destroy(token);</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">229</td><td class="hits">1</td><td class="source">  module.exports = Storage;</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/sync.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/sync.coffee</h2><div id="stats" class="high"><div class="percentage">96%</div><div class="sloc">134</div><div class="hits">129</div><div class="misses">5</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">           ___  __   __      __            __</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    |\ | |  |  |__) /  \    /__` \ / |\ | /  `</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">    | \| |  |  |  \ \__/    .__/  |  | \| \__,</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">    ------------------------------------------</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">    This is the sync code. It's a wee bit crazy.</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">*/</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">12</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">13</td><td class="hits">1</td><td class="source">  var ERR_INVALID_MODEL, ERR_OLD_EVENT, LIST, Log, PREF, Q, Sync, TASK, hasSameKeys, log, logEvent, time, warn,</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1275</td><td class="source">    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">  Log = require('../utils/log');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">  time = require('../utils/time');</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">  log = Log('Sync', 'cyan');</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">  logEvent = Log('Sync Event', 'yellow');</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">  warn = Log('Sync', 'red');</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  LIST = 'list';</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">  PREF = 'pref';</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">  TASK = 'task';</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">  ERR_INVALID_MODEL = 'err_invalid_model';</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">  ERR_OLD_EVENT = 'err_old_event';</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">  hasSameKeys = function(a, b) {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">3</td><td class="source">    var aKeys, bKeys;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">3</td><td class="source">    aKeys = Object.keys(a);</td></tr><tr class="hit"><td class="line">41</td><td class="hits">3</td><td class="source">    bKeys = Object.keys(b);</td></tr><tr class="hit"><td class="line">42</td><td class="hits">3</td><td class="source">    if (aKeys.length === bKeys.length) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">3</td><td class="source">      if (aKeys.every(function(key) {</td></tr><tr class="hit"><td class="line">44</td><td class="hits">3</td><td class="source">        return b.hasOwnProperty(key);</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">      })) {</td></tr><tr class="hit"><td class="line">46</td><td class="hits">3</td><td class="source">        return aKeys;</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"><td class="line">49</td><td class="hits">0</td><td class="source">    return false;</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">  Sync = (function() {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">    function Sync(user) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">34</td><td class="source">      this.user = user;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">34</td><td class="source">      this.list_destroy = __bind(this.list_destroy, this);</td></tr><tr class="hit"><td class="line">56</td><td class="hits">34</td><td class="source">      this.task_destroy = __bind(this.task_destroy, this);</td></tr><tr class="hit"><td class="line">57</td><td class="hits">34</td><td class="source">      this.pref_update = __bind(this.pref_update, this);</td></tr><tr class="hit"><td class="line">58</td><td class="hits">34</td><td class="source">      this.list_update = __bind(this.list_update, this);</td></tr><tr class="hit"><td class="line">59</td><td class="hits">34</td><td class="source">      this.task_update = __bind(this.task_update, this);</td></tr><tr class="hit"><td class="line">60</td><td class="hits">34</td><td class="source">      this.list_create = __bind(this.list_create, this);</td></tr><tr class="hit"><td class="line">61</td><td class="hits">34</td><td class="source">      this.task_create = __bind(this.task_create, this);</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">     * Create Task</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">     * - model (object)</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">     * - timestamp (number)</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">     * &gt; id (number)</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">    Sync.prototype.task_create = function(task, timestamp) {</td></tr><tr class="hit"><td class="line">74</td><td class="hits">84</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">75</td><td class="hits">84</td><td class="source">      return this.user.shouldOwnList(task.listId).then(function(exists) {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">38</td><td class="source">        if (!exists) {</td></tr><tr class="miss"><td class="line">77</td><td class="hits">0</td><td class="source">          warn('[task] [create] can not find listId', task.listId);</td></tr><tr class="miss"><td class="line">78</td><td class="hits">0</td><td class="source">          throw ERR_INVALID_MODEL;</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">80</td><td class="hits">38</td><td class="source">        return _this.user.createTask(task);</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">      }).then(function(id) {</td></tr><tr class="hit"><td class="line">82</td><td class="hits">38</td><td class="source">        task.id = id;</td></tr><tr class="hit"><td class="line">83</td><td class="hits">38</td><td class="source">        if (timestamp == null) {</td></tr><tr class="hit"><td class="line">84</td><td class="hits">38</td><td class="source">          timestamp = Date.now();</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">86</td><td class="hits">38</td><td class="source">        return time.createTask(id, timestamp);</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">      }).then(function(id) {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">38</td><td class="source">        return _this.user.addTaskToList(task.id, task.listId);</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">90</td><td class="hits">38</td><td class="source">        return task.id;</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">     * Create List</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">     * - model (object)</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">     * - timestamp (number)</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">     * &gt; id (number)</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">103</td><td class="hits">1</td><td class="source">    Sync.prototype.list_create = function(list, timestamp) {</td></tr><tr class="hit"><td class="line">104</td><td class="hits">133</td><td class="source">      return this.user.createList(list).then(function(id) {</td></tr><tr class="hit"><td class="line">105</td><td class="hits">133</td><td class="source">        list.id = id;</td></tr><tr class="hit"><td class="line">106</td><td class="hits">133</td><td class="source">        if (timestamp == null) {</td></tr><tr class="hit"><td class="line">107</td><td class="hits">133</td><td class="source">          timestamp = Date.now();</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">109</td><td class="hits">133</td><td class="source">        return time.createList(list.id, timestamp);</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">111</td><td class="hits">133</td><td class="source">        return list.id;</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">     * (private) Model Update Timestamps</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">     * Handle timestamps for an update event</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">     * - classname (string)</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">     * - id (string)</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">     * - changes (object)</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">     * - timestamps (object)</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">     * &gt; timestamps</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">128</td><td class="hits">1</td><td class="source">    Sync.prototype.model_update_create_timestamps = function(changes) {</td></tr><tr class="hit"><td class="line">129</td><td class="hits">289</td><td class="source">      var key, now, timestamps;</td></tr><tr class="hit"><td class="line">130</td><td class="hits">289</td><td class="source">      timestamps = {};</td></tr><tr class="hit"><td class="line">131</td><td class="hits">289</td><td class="source">      now = Date.now();</td></tr><tr class="hit"><td class="line">132</td><td class="hits">289</td><td class="source">      for (key in changes) {</td></tr><tr class="hit"><td class="line">133</td><td class="hits">953</td><td class="source">        timestamps[key] = now;</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">135</td><td class="hits">289</td><td class="source">      return Q.resolve(timestamps);</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">138</td><td class="hits">1</td><td class="source">    Sync.prototype.model_update_timestamps = function(classname, id, changes, timestamps) {</td></tr><tr class="hit"><td class="line">139</td><td class="hits">292</td><td class="source">      var keys;</td></tr><tr class="hit"><td class="line">140</td><td class="hits">292</td><td class="source">      if (timestamps) {</td></tr><tr class="hit"><td class="line">141</td><td class="hits">3</td><td class="source">        keys = hasSameKeys(changes, timestamps);</td></tr><tr class="hit"><td class="line">142</td><td class="hits">3</td><td class="source">        if (keys === false) {</td></tr><tr class="miss"><td class="line">143</td><td class="hits">0</td><td class="source">          return Q.reject(ERR_INVALID_MODEL);</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">145</td><td class="hits">3</td><td class="source">        return time.checkMultiple(classname, id, timestamps).then(function(oldKeys) {</td></tr><tr class="hit"><td class="line">146</td><td class="hits">3</td><td class="source">          var key, _i, _len;</td></tr><tr class="hit"><td class="line">147</td><td class="hits">3</td><td class="source">          for (_i = 0, _len = oldKeys.length; _i &lt; _len; _i++) {</td></tr><tr class="hit"><td class="line">148</td><td class="hits">3</td><td class="source">            key = oldKeys[_i];</td></tr><tr class="hit"><td class="line">149</td><td class="hits">3</td><td class="source">            delete timestamps[key];</td></tr><tr class="hit"><td class="line">150</td><td class="hits">3</td><td class="source">            delete changes[key];</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">          }</td></tr><tr class="hit"><td class="line">152</td><td class="hits">3</td><td class="source">          if (oldKeys.length === keys.length) {</td></tr><tr class="hit"><td class="line">153</td><td class="hits">3</td><td class="source">            throw ERR_OLD_EVENT;</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">      } else {</td></tr><tr class="hit"><td class="line">157</td><td class="hits">289</td><td class="source">        return this.model_update_create_timestamps(changes);</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">     * Update Task</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">     * - changes (object)</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">     * - timestamps</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">     * &gt; changes</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">1</td><td class="source">    Sync.prototype.task_update = function(changes, timestamps) {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">131</td><td class="source">      var id,</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">173</td><td class="hits">131</td><td class="source">      id = changes.id;</td></tr><tr class="hit"><td class="line">174</td><td class="hits">131</td><td class="source">      delete changes.id;</td></tr><tr class="hit"><td class="line">175</td><td class="hits">131</td><td class="source">      if (Object.keys(changes).length === 0) {</td></tr><tr class="hit"><td class="line">176</td><td class="hits">2</td><td class="source">        return Q.reject(ERR_INVALID_MODEL);</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">178</td><td class="hits">129</td><td class="source">      return this.user.shouldOwnTask(id).then(function() {</td></tr><tr class="hit"><td class="line">179</td><td class="hits">20</td><td class="source">        return _this.model_update_timestamps(TASK, id, changes, timestamps);</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">      }).then(function(_timestamps) {</td></tr><tr class="hit"><td class="line">181</td><td class="hits">19</td><td class="source">        timestamps = _timestamps;</td></tr><tr class="hit"><td class="line">182</td><td class="hits">19</td><td class="source">        if (!changes.listId) {</td></tr><tr class="hit"><td class="line">183</td><td class="hits">9</td><td class="source">          return Q.resolve();</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">185</td><td class="hits">10</td><td class="source">        return _this.user.shouldOwnList(changes.listId).then(function() {</td></tr><tr class="hit"><td class="line">186</td><td class="hits">5</td><td class="source">          return _this.user.readTask(id, 'listId');</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">        }).then(function(old) {</td></tr><tr class="hit"><td class="line">188</td><td class="hits">5</td><td class="source">          if (old.listId === changes.listId) {</td></tr><tr class="miss"><td class="line">189</td><td class="hits">0</td><td class="source">            throw ERR_INVALID_MODEL;</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">          }</td></tr><tr class="hit"><td class="line">191</td><td class="hits">5</td><td class="source">          return _this.user.removeTaskFromList(id, old.listId);</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">        }).then(function() {</td></tr><tr class="hit"><td class="line">193</td><td class="hits">5</td><td class="source">          return _this.user.addTaskToList(id, changes.listId);</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">        }).fail(function(err) {</td></tr><tr class="hit"><td class="line">195</td><td class="hits">5</td><td class="source">          delete changes.listId;</td></tr><tr class="hit"><td class="line">196</td><td class="hits">5</td><td class="source">          return delete timestamps.listId;</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">199</td><td class="hits">19</td><td class="source">        return time.update(TASK, id, timestamps);</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">201</td><td class="hits">19</td><td class="source">        return _this.user.updateTask(id, changes);</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">203</td><td class="hits">19</td><td class="source">        changes.id = id;</td></tr><tr class="hit"><td class="line">204</td><td class="hits">19</td><td class="source">        return changes;</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">     * Update List</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source">     * - changes (object)</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">     * - timestamps (object)</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">     * &gt; changes</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">217</td><td class="hits">1</td><td class="source">    Sync.prototype.list_update = function(changes, timestamps) {</td></tr><tr class="hit"><td class="line">218</td><td class="hits">239</td><td class="source">      var id,</td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">220</td><td class="hits">239</td><td class="source">      id = changes.id;</td></tr><tr class="hit"><td class="line">221</td><td class="hits">239</td><td class="source">      delete changes.id;</td></tr><tr class="hit"><td class="line">222</td><td class="hits">239</td><td class="source">      if (Object.keys(changes).length === 0) {</td></tr><tr class="hit"><td class="line">223</td><td class="hits">68</td><td class="source">        return Q.reject(ERR_INVALID_MODEL);</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">225</td><td class="hits">171</td><td class="source">      return this.user.shouldOwnList(id).then(function() {</td></tr><tr class="hit"><td class="line">226</td><td class="hits">81</td><td class="source">        if (changes.tasks) {</td></tr><tr class="hit"><td class="line">227</td><td class="hits">55</td><td class="source">          warn('[list] [update] TODO: Handle list.tasks');</td></tr><tr class="hit"><td class="line">228</td><td class="hits">55</td><td class="source">          delete changes.tasks;</td></tr><tr class="hit"><td class="line">229</td><td class="hits">55</td><td class="source">          delete timestamps.tasks;</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">231</td><td class="hits">26</td><td class="source">        return _this.model_update_timestamps(LIST, id, changes, timestamps);</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">      }).then(function(timestamps) {</td></tr><tr class="hit"><td class="line">233</td><td class="hits">25</td><td class="source">        return time.update(LIST, id, timestamps);</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">235</td><td class="hits">25</td><td class="source">        return _this.user.updateList(id, changes);</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">237</td><td class="hits">25</td><td class="source">        changes.id = id;</td></tr><tr class="hit"><td class="line">238</td><td class="hits">25</td><td class="source">        return changes;</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source">     * Update Pref</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">     * - changes (object)</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">     * - timestamps (timestamps)</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source">     * &gt; changes</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">251</td><td class="hits">1</td><td class="source">    Sync.prototype.pref_update = function(changes, timestamps) {</td></tr><tr class="hit"><td class="line">252</td><td class="hits">247</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">253</td><td class="hits">247</td><td class="source">      if (Object.keys(changes).length === 0) {</td></tr><tr class="hit"><td class="line">254</td><td class="hits">1</td><td class="source">        return Q.reject(ERR_INVALID_MODEL);</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">256</td><td class="hits">246</td><td class="source">      return this.model_update_timestamps(PREF, this.user.id, changes, timestamps).then(function(timestamps) {</td></tr><tr class="hit"><td class="line">257</td><td class="hits">245</td><td class="source">        return time.update(PREF, _this.user.id, timestamps);</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">259</td><td class="hits">245</td><td class="source">        return _this.user.updatePref(changes);</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">261</td><td class="hits">245</td><td class="source">        return changes;</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source">     * Destroy Task</td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">268</td><td class="hits"></td><td class="source">     * - id (string)</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">     * - timestamp (number)</td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">273</td><td class="hits">1</td><td class="source">    Sync.prototype.task_destroy = function(id, timestamp) {</td></tr><tr class="hit"><td class="line">274</td><td class="hits">70</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">275</td><td class="hits">70</td><td class="source">      return this.user.shouldOwnTask(id).then(function() {</td></tr><tr class="hit"><td class="line">276</td><td class="hits">10</td><td class="source">        return time.checkSingle(TASK, id, timestamp);</td></tr><tr><td class="line">277</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">278</td><td class="hits">10</td><td class="source">        return _this.user.destroyTask(id);</td></tr><tr><td class="line">279</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">282</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">283</td><td class="hits"></td><td class="source">     * Destroy List</td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source">     * - id (string)</td></tr><tr><td class="line">286</td><td class="hits"></td><td class="source">     * - timestamp (number)</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">288</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">289</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">290</td><td class="hits">1</td><td class="source">    Sync.prototype.list_destroy = function(id, timestamp) {</td></tr><tr class="hit"><td class="line">291</td><td class="hits">133</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">292</td><td class="hits">133</td><td class="source">      return this.user.shouldOwnList(id).then(function() {</td></tr><tr class="hit"><td class="line">293</td><td class="hits">61</td><td class="source">        return time.checkSingle(LIST, id, timestamp);</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">295</td><td class="hits">61</td><td class="source">        return _this.user.destroyList(id);</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">297</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">298</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">299</td><td class="hits">1</td><td class="source">    return Sync;</td></tr><tr><td class="line">300</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">301</td><td class="hits"></td><td class="source">  })();</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">303</td><td class="hits">1</td><td class="source">  module.exports = Sync;</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">305</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/table.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/table.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">74</div><div class="hits">74</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Q, Table;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = (function() {</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">     * Table (string)</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">     * This should store the table name</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">13</td><td class="hits">1</td><td class="source">    Table.prototype.table = null;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">     * Constants</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">    Table.prototype.ERR_NO_ROW = 'err_no_row';</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">     * Table Constructor</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">     * - query (function) : the Knex builder</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">    function Table(query) {</td></tr><tr class="hit"><td class="line">30</td><td class="hits">99</td><td class="source">      this.query = query;</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">     * Setup</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">     * This will be called after initialization to setup the table.</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">     * It should return a promise so that we can tell when all the tables</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">     * are ready.</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">     * &gt; Promise</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">    Table.prototype.setup = function() {};</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">     * Wrap</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">     * Converts the Knex builder into a Kew promise</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">     * - fn (Knex) : The knex builder</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">    Table.prototype.wrap = function(fn) {</td></tr><tr class="hit"><td class="line">56</td><td class="hits">2386</td><td class="source">      var deferred;</td></tr><tr class="hit"><td class="line">57</td><td class="hits">2386</td><td class="source">      deferred = Q.defer();</td></tr><tr class="hit"><td class="line">58</td><td class="hits">2386</td><td class="source">      fn.exec(deferred.makeNodeResolver());</td></tr><tr class="hit"><td class="line">59</td><td class="hits">2386</td><td class="source">      return deferred.promise;</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">     * (private) Create Table</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">     * Creates a table if it does not already exist</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">     * - fn (function) : will be passed to knex.schema.createTable</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">    Table.prototype._createTable = function(fn) {</td></tr><tr class="hit"><td class="line">72</td><td class="hits">99</td><td class="source">      var promise,</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">74</td><td class="hits">99</td><td class="source">      promise = this.wrap(this.query.schema.hasTable(this.table));</td></tr><tr class="hit"><td class="line">75</td><td class="hits">99</td><td class="source">      return promise.then(function(exists) {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">99</td><td class="source">        if (exists) {</td></tr><tr class="hit"><td class="line">77</td><td class="hits">11</td><td class="source">          return;</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">79</td><td class="hits">88</td><td class="source">        return _this.wrap(_this.query.schema.createTable(_this.table, fn));</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">83</td><td class="hits">1</td><td class="source">    Table.prototype._dropTable = function() {</td></tr><tr class="hit"><td class="line">84</td><td class="hits">88</td><td class="source">      return this.wrap(this.query.schema.dropTable(this.table));</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">87</td><td class="hits">1</td><td class="source">    Table.prototype._true = function() {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">29</td><td class="source">      return true;</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">91</td><td class="hits">1</td><td class="source">    Table.prototype._false = function() {</td></tr><tr class="hit"><td class="line">92</td><td class="hits">8</td><td class="source">      return false;</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">95</td><td class="hits">1</td><td class="source">    Table.prototype._parseToken = function(token) {</td></tr><tr class="hit"><td class="line">96</td><td class="hits">19</td><td class="source">      var match;</td></tr><tr class="hit"><td class="line">97</td><td class="hits">19</td><td class="source">      match = token.match(/^(\d+)_(\w+)$/);</td></tr><tr class="hit"><td class="line">98</td><td class="hits">19</td><td class="source">      if (match === null) {</td></tr><tr class="hit"><td class="line">99</td><td class="hits">5</td><td class="source">        return null;</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">101</td><td class="hits">14</td><td class="source">      return [match[1], match[2]];</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">104</td><td class="hits">1</td><td class="source">    Table.prototype._search = function(columns, data) {</td></tr><tr class="hit"><td class="line">105</td><td class="hits">926</td><td class="source">      var promise,</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">107</td><td class="hits">926</td><td class="source">      promise = this.wrap(this.query(this.table).select().column(columns).where(data));</td></tr><tr class="hit"><td class="line">108</td><td class="hits">926</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">109</td><td class="hits">925</td><td class="source">        if (!rows.length) {</td></tr><tr class="hit"><td class="line">110</td><td class="hits">451</td><td class="source">          throw _this.ERR_NO_ROW;</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">112</td><td class="hits">474</td><td class="source">        return rows;</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">116</td><td class="hits">1</td><td class="source">    Table.prototype._update = function(data, where) {</td></tr><tr class="hit"><td class="line">117</td><td class="hits">597</td><td class="source">      var promise,</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">119</td><td class="hits">597</td><td class="source">      promise = this.wrap(this.query(this.table).update(data).where(where));</td></tr><tr class="hit"><td class="line">120</td><td class="hits">597</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">121</td><td class="hits">597</td><td class="source">        if (!rows) {</td></tr><tr class="hit"><td class="line">122</td><td class="hits">3</td><td class="source">          throw _this.ERR_NO_ROW;</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">124</td><td class="hits">594</td><td class="source">        return rows;</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">128</td><td class="hits">1</td><td class="source">    Table.prototype._delete = function(data) {</td></tr><tr class="hit"><td class="line">129</td><td class="hits">115</td><td class="source">      var promise,</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">131</td><td class="hits">115</td><td class="source">      promise = this.wrap(this.query(this.table).del().where(data));</td></tr><tr class="hit"><td class="line">132</td><td class="hits">115</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">133</td><td class="hits">115</td><td class="source">        if (!rows) {</td></tr><tr class="hit"><td class="line">134</td><td class="hits">6</td><td class="source">          throw _this.ERR_NO_ROW;</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">136</td><td class="hits">109</td><td class="source">        return true;</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">     * Create</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">     * Create a new row</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">     * - data (object) : the data data</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">     * &gt; id (number) : the new id of the user</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">150</td><td class="hits">1</td><td class="source">    Table.prototype.create = function(data) {</td></tr><tr class="hit"><td class="line">151</td><td class="hits">473</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">152</td><td class="hits">473</td><td class="source">      promise = this.wrap(this.query(this.table).insert(data));</td></tr><tr class="hit"><td class="line">153</td><td class="hits">473</td><td class="source">      return promise.then(function(id) {</td></tr><tr class="hit"><td class="line">154</td><td class="hits">471</td><td class="source">        return id[0];</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">     * Read</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">     * Retrieve data from an existing row.</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">     * - id (number) : id of the row</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">     * - [columns] (array|string) : columns to retrieve</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">     * &gt; row (object) : the row data</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">     * ! err_no_row : row cannot be found</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">1</td><td class="source">    Table.prototype.read = function(id, columns) {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">195</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">172</td><td class="hits">195</td><td class="source">      promise = this._search(columns, {</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">        id: id</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">175</td><td class="hits">195</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">176</td><td class="hits">176</td><td class="source">        return rows[0];</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">180</td><td class="hits">1</td><td class="source">    Table.prototype.exists = function(id) {</td></tr><tr class="hit"><td class="line">181</td><td class="hits">2</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">182</td><td class="hits">2</td><td class="source">      promise = this._search('id', {</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">        id: id</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">185</td><td class="hits">2</td><td class="source">      return promise.then(this._true, this._false);</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">     * Update</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">     * Update attributes in an existing row.</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">     * - id (number) : the id of the row</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">     * - data (object) : attributes to set in the row</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">     * &gt; id (number)</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source">     * ! err_no_row : row cannot be found</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">200</td><td class="hits">1</td><td class="source">    Table.prototype.update = function(id, data) {</td></tr><tr class="hit"><td class="line">201</td><td class="hits">350</td><td class="source">      return this._update(data, {</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">        id: id</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">     * Destroy</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">     * Destroy an existing row.</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source">     * - id (number) : id of row to destroy</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">     * &gt; true</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">     * ! err_no_row : row cannot be found</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">217</td><td class="hits">1</td><td class="source">    Table.prototype.destroy = function(id) {</td></tr><tr class="hit"><td class="line">218</td><td class="hits">97</td><td class="source">      return this._delete({</td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">        id: id</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">223</td><td class="hits">1</td><td class="source">    return Table;</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source">  })();</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">227</td><td class="hits">1</td><td class="source">  module.exports = Table;</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/controllers/validation.coffee">/Volumes/Home/Projects/Nitro-Sync/app/controllers/validation.coffee</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">47</div><div class="hits">45</div><div class="misses">2</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var define, defineFn, _ref;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  _ref = require('xtype'), define = _ref.define, defineFn = _ref.defineFn;</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  define('Task', 'object', {</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">      id: 'number',</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">      listId: 'number',</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">      date: 'number',</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">      name: 'string',</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">      notes: 'string',</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">      priority: 'number',</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">      completed: 'number'</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">  define('TaskCollection', 'array', {</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">    all: 'number'</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">  define('List', 'object', {</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">      id: 'number',</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">      name: 'string',</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">      tasks: 'TaskCollection'</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">  define('Pref', 'object', {</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">      sort: 'number',</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">      night: 'number',</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">      language: 'string',</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">      weekStart: 'number',</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">      dateFormat: 'string',</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">      confirmDelete: 'number',</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">      moveCompleted: 'number'</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">  define('CreateList', 'object', {</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">    required: ['id', 'name', 'tasks'],</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">    inherit: 'List'</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">  define('UpdateList', 'object', {</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    required: ['id'],</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    inherit: 'List'</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">  define('DestroyList', 'object', {</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    required: ['id'],</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">    inherit: 'List'</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">57</td><td class="hits">1</td><td class="source">  define('CreateTask', 'object', {</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    required: ['id', 'listId', 'date', 'name', 'notes', 'priority', 'completed'],</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">    inherit: 'Task'</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">  define('UpdateTask', 'object', {</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">    required: ['id'],</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    inherit: 'Task'</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">  define('DestroyTask', 'object', {</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    required: ['id'],</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    inherit: 'Task'</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">72</td><td class="hits">1</td><td class="source">  define('Timestamps', 'object', {</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">    all: 'number'</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">76</td><td class="hits">1</td><td class="source">  define('CreateEvent', 'array', {</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">      2: 'number'</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">82</td><td class="hits">1</td><td class="source">  define('UpdateEvent', 'array', {</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">      2: 'Timestamps'</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">88</td><td class="hits">1</td><td class="source">  define('DestroyEvent', 'array', {</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">      2: 'number'</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">94</td><td class="hits">1</td><td class="source">  define('TaskCreateEvent', 'array', {</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">    inherit: 'CreateEvent',</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">      1: 'CreateTask'</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">101</td><td class="hits">1</td><td class="source">  define('TaskUpdateEvent', 'array', {</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    inherit: 'UpdateEvent',</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">      1: 'UpdateTask'</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">108</td><td class="hits">1</td><td class="source">  define('TaskDestroyEvent', 'array', {</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">    inherit: 'DestroyEvent',</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">      1: 'DestroyTask'</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">115</td><td class="hits">1</td><td class="source">  define('ListCreateEvent', 'array', {</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">    inherit: 'CreateEvent',</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">      1: 'CreateList'</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">122</td><td class="hits">1</td><td class="source">  define('ListUpdateEvent', 'array', {</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">    inherit: 'UpdateEvent',</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">      1: 'UpdateList'</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">129</td><td class="hits">1</td><td class="source">  define('ListDestroyEvent', 'array', {</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">    inherit: 'DestroyEvent',</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">      1: 'DestroyList'</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">136</td><td class="hits">1</td><td class="source">  define('TaskQueueEvent', 'array', {</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">    inherit: ['TaskCreateEvent', 'TaskUpdateEvent', 'TaskDestroyEvent'],</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    check: function(arr) {</td></tr><tr class="miss"><td class="line">139</td><td class="hits">0</td><td class="source">      return arr[0];</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">143</td><td class="hits">1</td><td class="source">  define('ListQueueEvent', 'array', {</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">    inherit: ['ListCreateEvent', 'ListUpdateEvent', 'ListDestroyEvent'],</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">    check: function(arr) {</td></tr><tr class="miss"><td class="line">146</td><td class="hits">0</td><td class="source">      return arr[0];</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">150</td><td class="hits">1</td><td class="source">  define('TaskEvent', 'array', {</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">    inherit: 'TaskQueueEvent',</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source">      0: 'number'</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">    required: [0, 1, 2]</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">158</td><td class="hits">1</td><td class="source">  define('ListEvent', 'array', {</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">    inherit: 'ListQueueEvent',</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">      0: 'number'</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">    required: [0, 1, 2]</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">166</td><td class="hits">1</td><td class="source">  define('PrefEvent', 'array', {</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">      0: 'number',</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source">      1: 'Pref',</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">      2: 'Timestamps'</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">    required: [0, 1, 2]</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">175</td><td class="hits">1</td><td class="source">  define('TaskQueue', 'object', {</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">    all: 'TaskEvent'</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">179</td><td class="hits">1</td><td class="source">  define('ListQueue', 'object', {</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">    all: 'ListEvent'</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">183</td><td class="hits">1</td><td class="source">  define('PrefQueue', 'object', {</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">    all: 'PrefEvent'</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">187</td><td class="hits">1</td><td class="source">  define('Queue', 'object', {</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">    keys: {</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">      task: 'TaskQueue',</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">      list: 'ListQueue',</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">      pref: 'PrefQueue'</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">195</td><td class="hits">1</td><td class="source">  defineFn('user_auth', 'number', 'string', 'function');</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">197</td><td class="hits">1</td><td class="source">  defineFn('user_info', 'function');</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">199</td><td class="hits">1</td><td class="source">  defineFn('task_fetch', 'function');</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">201</td><td class="hits">1</td><td class="source">  defineFn('list_fetch', 'function');</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">203</td><td class="hits">1</td><td class="source">  defineFn('pref_fetch', 'function');</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">205</td><td class="hits">1</td><td class="source">  defineFn('task_create', 'CreateTask', 'function');</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">207</td><td class="hits">1</td><td class="source">  defineFn('list_create', 'CreateList', 'function');</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">209</td><td class="hits">1</td><td class="source">  defineFn('task_update', 'UpdateTask', '~function');</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">211</td><td class="hits">1</td><td class="source">  defineFn('list_update', 'UpdateList', '~function');</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">213</td><td class="hits">1</td><td class="source">  defineFn('pref_update', 'Pref', '~function');</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">215</td><td class="hits">1</td><td class="source">  defineFn('task_destroy', 'DestroyTask', '~function');</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">217</td><td class="hits">1</td><td class="source">  defineFn('list_destroy', 'DestroyList', '~function');</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">219</td><td class="hits">1</td><td class="source">  defineFn('queue_sync', 'Queue', 'function');</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/list.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/list.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">18</div><div class="hits">18</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var List, Table, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  List = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(List, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function List() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = List.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    List.prototype.table = 'list';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    List.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">8</td><td class="source">        table.increments('id').unsigned();</td></tr><tr class="hit"><td class="line">22</td><td class="hits">8</td><td class="source">        table.integer('userId').unsigned().index().references('id').inTable('user').onDelete('cascade').onUpdate('cascade');</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        return table.string('name', 150);</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">    return List;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">  module.exports = List;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/list_tasks.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/list_tasks.coffee</h2><div id="stats" class="high"><div class="percentage">96%</div><div class="sloc">33</div><div class="hits">32</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var ListTasks, Table, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  ListTasks = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(ListTasks, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function ListTasks() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = ListTasks.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    ListTasks.prototype.table = 'list_tasks';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    ListTasks.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">8</td><td class="source">        table.primary(['listId', 'taskId']);</td></tr><tr class="hit"><td class="line">22</td><td class="hits">8</td><td class="source">        table.integer('listId').unsigned().references('id').inTable('list').onDelete('cascade').onUpdate('cascade');</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        return table.integer('taskId').unsigned().references('id').inTable('task').onDelete('cascade').onUpdate('cascade');</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">    ListTasks.prototype.create = function(list, task) {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">48</td><td class="source">      return ListTasks.__super__.create.call(this, {</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">        listId: list,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">        taskId: task</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">    ListTasks.prototype.read = function(list) {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">28</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">36</td><td class="hits">28</td><td class="source">      promise = this._search('taskId', {</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">        listId: list</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">39</td><td class="hits">28</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">40</td><td class="hits">10</td><td class="source">        return rows.map(function(row) {</td></tr><tr class="hit"><td class="line">41</td><td class="hits">17</td><td class="source">          return row.taskId;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">      }).fail(function() {</td></tr><tr class="hit"><td class="line">44</td><td class="hits">18</td><td class="source">        return [];</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">    ListTasks.prototype.update = function() {</td></tr><tr class="miss"><td class="line">49</td><td class="hits">0</td><td class="source">      throw new Error('Cannot update list_tasks');</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">    ListTasks.prototype.destroy = function(list, task) {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">7</td><td class="source">      return this._delete({</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">        listId: list,</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">        taskId: task</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">    ListTasks.prototype.destroyAll = function(list) {</td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">      return this._delete({</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">        listId: list</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">65</td><td class="hits">1</td><td class="source">    return ListTasks;</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">69</td><td class="hits">1</td><td class="source">  module.exports = ListTasks;</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/login.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/login.coffee</h2><div id="stats" class="high"><div class="percentage">97%</div><div class="sloc">36</div><div class="hits">35</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Login, Table, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Login = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(Login, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function Login() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = Login.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    Login.prototype.table = 'login';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    Login.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">8</td><td class="source">        table.primary(['userid', 'token']);</td></tr><tr class="hit"><td class="line">22</td><td class="hits">8</td><td class="source">        table.integer('userId').unsigned().references('id').inTable('user').onDelete('cascade').onUpdate('cascade');</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        table.string('token', 64);</td></tr><tr class="hit"><td class="line">24</td><td class="hits">8</td><td class="source">        return table.timestamp('created_at').defaultTo(_this.query.raw('now()'));</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">    Login.prototype.create = function(id, token) {</td></tr><tr class="hit"><td class="line">29</td><td class="hits">8</td><td class="source">      return Login.__super__.create.call(this, {</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">        userId: id,</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">        token: token</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">     * Read</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">     * Retrieve data from an existing row.</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">     * - id (number) : id of the row</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">     * - [columns] (array|string) : columns to retrieve</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">     * &gt; row (object) : the row data</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">     * ! err_no_row : row cannot be found</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">    Login.prototype.read = function(id, token, columns) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">3</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">49</td><td class="hits">3</td><td class="source">      promise = this._search(columns, {</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">        userId: id,</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">        token: token</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">53</td><td class="hits">3</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">2</td><td class="source">        return rows[0];</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">    Login.prototype.exists = function(id, token) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">35</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">60</td><td class="hits">35</td><td class="source">      promise = this._search('userId', {</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">        userId: id,</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">        token: token</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">64</td><td class="hits">35</td><td class="source">      return promise.then(this._true, this._false);</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">    Login.prototype.update = function() {</td></tr><tr class="miss"><td class="line">68</td><td class="hits">0</td><td class="source">      throw new Error('Cannot update login row');</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">    Login.prototype.destroy = function(id, token) {</td></tr><tr class="hit"><td class="line">72</td><td class="hits">2</td><td class="source">      return this._delete({</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">        userId: id,</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">        token: token</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">78</td><td class="hits">1</td><td class="source">    Login.prototype.destroyAll = function(id) {</td></tr><tr class="hit"><td class="line">79</td><td class="hits">2</td><td class="source">      return this._delete({</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">        userId: id</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">84</td><td class="hits">1</td><td class="source">    return Login;</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">88</td><td class="hits">1</td><td class="source">  module.exports = Login;</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/pref.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/pref.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">33</div><div class="hits">33</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Pref, Table, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Pref = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(Pref, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function Pref() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = Pref.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    Pref.prototype.table = 'pref';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    Pref.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">8</td><td class="source">        table.integer('userId').unsigned().primary().references('id').inTable('user').onDelete('cascade').onUpdate('cascade');</td></tr><tr class="hit"><td class="line">22</td><td class="hits">8</td><td class="source">        table.boolean('sort').unsigned();</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        table.integer('night').unsigned();</td></tr><tr class="hit"><td class="line">24</td><td class="hits">8</td><td class="source">        table.string('language', 5);</td></tr><tr class="hit"><td class="line">25</td><td class="hits">8</td><td class="source">        table.integer('weekStart').unsigned();</td></tr><tr class="hit"><td class="line">26</td><td class="hits">8</td><td class="source">        table.string('dateFormat', 8);</td></tr><tr class="hit"><td class="line">27</td><td class="hits">8</td><td class="source">        table.boolean('confirmDelete').unsigned();</td></tr><tr class="hit"><td class="line">28</td><td class="hits">8</td><td class="source">        return table.integer('moveCompleted').unsigned();</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">     * Read</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">     * Retrieve data from an existing row.</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">     * - id (number) : id of the row</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">     * - [columns] (array|string) : columns to retrieve</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">     * &gt; row (object) : the row data</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">     * ! err_no_row : row cannot be found</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">    Pref.prototype.read = function(id, columns) {</td></tr><tr class="hit"><td class="line">45</td><td class="hits">7</td><td class="source">      var promise,</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">        _this = this;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">7</td><td class="source">      promise = this._search(columns, {</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">        userid: id</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">50</td><td class="hits">7</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">51</td><td class="hits">6</td><td class="source">        return rows[0];</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">     * Update</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">     * Update attributes in an existing row.</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">     * Does not care if the row does not exist</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">     * - id (number) : the id of the user</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">     * - data (object) : attributes to set in the row</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">     * &gt; id (number)</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">    Pref.prototype.update = function(id, data) {</td></tr><tr class="hit"><td class="line">68</td><td class="hits">247</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">69</td><td class="hits">247</td><td class="source">      return promise = this._update(data, {</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">        userId: id</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">     * Destroy</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">     * Destroy an existing row.</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">     * - id (number) : id of row to destroy</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">     * &gt; true</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">     * ! err_no_row : row cannot be found</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">85</td><td class="hits">1</td><td class="source">    Pref.prototype.destroy = function(id) {</td></tr><tr class="hit"><td class="line">86</td><td class="hits">3</td><td class="source">      return this._delete({</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">        userId: id</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">91</td><td class="hits">1</td><td class="source">    return Pref;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">95</td><td class="hits">1</td><td class="source">  module.exports = Pref;</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/register.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/register.coffee</h2><div id="stats" class="high"><div class="percentage">97%</div><div class="sloc">35</div><div class="hits">34</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Q, Register, Table, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  Register = (function(_super) {</td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    __extends(Register, _super);</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">13</td><td class="hits">1</td><td class="source">    function Register() {</td></tr><tr class="hit"><td class="line">14</td><td class="hits">9</td><td class="source">      _ref = Register.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">15</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    Register.prototype.table = 'register';</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">    Register.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        table.increments('id').unsigned();</td></tr><tr class="hit"><td class="line">24</td><td class="hits">8</td><td class="source">        table.string('token', 22);</td></tr><tr class="hit"><td class="line">25</td><td class="hits">8</td><td class="source">        table.string('name', 100);</td></tr><tr class="hit"><td class="line">26</td><td class="hits">8</td><td class="source">        table.string('email', 100);</td></tr><tr class="hit"><td class="line">27</td><td class="hits">8</td><td class="source">        table.string('password', 60);</td></tr><tr class="hit"><td class="line">28</td><td class="hits">8</td><td class="source">        return table.timestamp('created_at').defaultTo(_this.query.raw('now()'));</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">    Register.prototype.create = function(data) {</td></tr><tr class="hit"><td class="line">33</td><td class="hits">6</td><td class="source">      return Register.__super__.create.call(this, data).then(function(id) {</td></tr><tr class="hit"><td class="line">34</td><td class="hits">6</td><td class="source">        return id + '_' + data.token;</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">    Register.prototype.read = function(token) {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">9</td><td class="source">      var match, promise;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">9</td><td class="source">      match = this._parseToken(token);</td></tr><tr class="hit"><td class="line">41</td><td class="hits">9</td><td class="source">      if (!match) {</td></tr><tr class="hit"><td class="line">42</td><td class="hits">2</td><td class="source">        return Q.reject('err_invalid_token');</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">44</td><td class="hits">7</td><td class="source">      promise = this._search(['id', 'name', 'email', 'password'], {</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">        id: match[0],</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">        token: match[1]</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">48</td><td class="hits">7</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">49</td><td class="hits">6</td><td class="source">        return rows[0];</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">    Register.prototype.update = function() {</td></tr><tr class="miss"><td class="line">54</td><td class="hits">0</td><td class="source">      throw new Error('Cannot update registration');</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">57</td><td class="hits">1</td><td class="source">    return Register;</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">  module.exports = Register;</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/reset.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/reset.coffee</h2><div id="stats" class="high"><div class="percentage">97%</div><div class="sloc">39</div><div class="hits">38</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Q, Reset, Table, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  Reset = (function(_super) {</td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    __extends(Reset, _super);</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">13</td><td class="hits">1</td><td class="source">    function Reset() {</td></tr><tr class="hit"><td class="line">14</td><td class="hits">9</td><td class="source">      _ref = Reset.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">15</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    Reset.prototype.table = 'reset';</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">    Reset.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        table.primary(['userId', 'token']);</td></tr><tr class="hit"><td class="line">24</td><td class="hits">8</td><td class="source">        table.integer('userId').unsigned().references('id').inTable('user').onDelete('cascade').onUpdate('cascade');</td></tr><tr class="hit"><td class="line">25</td><td class="hits">8</td><td class="source">        table.string('token', 22);</td></tr><tr class="hit"><td class="line">26</td><td class="hits">8</td><td class="source">        return table.timestamp('created_at').defaultTo(_this.query.raw('now()'));</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">    Reset.prototype.create = function(id, token) {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">3</td><td class="source">      return Reset.__super__.create.call(this, {</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">        userId: id,</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">        token: token</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">      }).then(function() {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">3</td><td class="source">        return id + '_' + token;</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">    Reset.prototype.read = function(token) {</td></tr><tr class="hit"><td class="line">40</td><td class="hits">6</td><td class="source">      var match, promise;</td></tr><tr class="hit"><td class="line">41</td><td class="hits">6</td><td class="source">      match = this._parseToken(token);</td></tr><tr class="hit"><td class="line">42</td><td class="hits">6</td><td class="source">      if (!match) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">2</td><td class="source">        return Q.reject('err_invalid_token');</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">45</td><td class="hits">4</td><td class="source">      promise = this._search('userId', {</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">        userId: match[0],</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">        token: match[1]</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">49</td><td class="hits">4</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">2</td><td class="source">        return rows[0].userId;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">    Reset.prototype.update = function() {</td></tr><tr class="miss"><td class="line">55</td><td class="hits">0</td><td class="source">      throw new Error('Cannot update a reset token');</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">    Reset.prototype.destroy = function(token) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">4</td><td class="source">      var match;</td></tr><tr class="hit"><td class="line">60</td><td class="hits">4</td><td class="source">      match = this._parseToken(token);</td></tr><tr class="hit"><td class="line">61</td><td class="hits">4</td><td class="source">      if (!match) {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">        return Q.reject('err_invalid_token');</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">64</td><td class="hits">3</td><td class="source">      return this._delete({</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">        userId: match[0],</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">        token: match[1]</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">    return Reset;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">  module.exports = Reset;</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/task.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/task.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">23</div><div class="hits">23</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Table, Task, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Task = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(Task, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function Task() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = Task.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    Task.prototype.table = 'task';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">     * Setup</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">     * Create table</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">    Task.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">8</td><td class="source">        table.increments('id').unsigned();</td></tr><tr class="hit"><td class="line">29</td><td class="hits">8</td><td class="source">        table.integer('userId').unsigned().index().references('id').inTable('user').onDelete('cascade').onUpdate('cascade').notNullable();</td></tr><tr class="hit"><td class="line">30</td><td class="hits">8</td><td class="source">        table.integer('listId').unsigned().references('id').inTable('list').onDelete('cascade').onUpdate('cascade').notNullable();</td></tr><tr class="hit"><td class="line">31</td><td class="hits">8</td><td class="source">        table.string('name', 150);</td></tr><tr class="hit"><td class="line">32</td><td class="hits">8</td><td class="source">        table.string('notes', 400);</td></tr><tr class="hit"><td class="line">33</td><td class="hits">8</td><td class="source">        table.integer('priority').unsigned();</td></tr><tr class="hit"><td class="line">34</td><td class="hits">8</td><td class="source">        table.bigInteger('completed').unsigned();</td></tr><tr class="hit"><td class="line">35</td><td class="hits">8</td><td class="source">        return table.bigInteger('date').unsigned();</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">    return Task;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">  module.exports = Task;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/time_list.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/time_list.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">18</div><div class="hits">18</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Table, TimeList, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  TimeList = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(TimeList, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function TimeList() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = TimeList.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    TimeList.prototype.table = 'time_list';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    TimeList.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">8</td><td class="source">        table.integer('id').unsigned().primary().references('id').inTable('list').onDelete('cascade').onUpdate('cascade').notNullable();</td></tr><tr class="hit"><td class="line">22</td><td class="hits">8</td><td class="source">        table.bigInteger('name').unsigned();</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        return table.bigInteger('tasks').unsigned();</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">    return TimeList;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">  module.exports = TimeList;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/time_pref.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/time_pref.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">23</div><div class="hits">23</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Table, TimePref, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  TimePref = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(TimePref, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function TimePref() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = TimePref.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    TimePref.prototype.table = 'time_pref';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    TimePref.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">8</td><td class="source">        table.integer('id').unsigned().primary().references('userId').inTable('pref').onDelete('cascade').onUpdate('cascade').notNullable();</td></tr><tr class="hit"><td class="line">22</td><td class="hits">8</td><td class="source">        table.bigInteger('sort').unsigned();</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        table.bigInteger('night').unsigned();</td></tr><tr class="hit"><td class="line">24</td><td class="hits">8</td><td class="source">        table.bigInteger('language').unsigned();</td></tr><tr class="hit"><td class="line">25</td><td class="hits">8</td><td class="source">        table.bigInteger('weekStart').unsigned();</td></tr><tr class="hit"><td class="line">26</td><td class="hits">8</td><td class="source">        table.bigInteger('dateFormat').unsigned();</td></tr><tr class="hit"><td class="line">27</td><td class="hits">8</td><td class="source">        table.bigInteger('confirmDelete').unsigned();</td></tr><tr class="hit"><td class="line">28</td><td class="hits">8</td><td class="source">        return table.bigInteger('moveCompleted').unsigned();</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">    return TimePref;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">  module.exports = TimePref;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/time_task.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/time_task.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">22</div><div class="hits">22</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Table, TimeTask, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  TimeTask = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(TimeTask, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function TimeTask() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = TimeTask.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    TimeTask.prototype.table = 'time_task';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">    TimeTask.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">8</td><td class="source">        table.integer('id').unsigned().primary().references('id').inTable('task').onDelete('cascade').onUpdate('cascade').notNullable();</td></tr><tr class="hit"><td class="line">22</td><td class="hits">8</td><td class="source">        table.bigInteger('listId').unsigned();</td></tr><tr class="hit"><td class="line">23</td><td class="hits">8</td><td class="source">        table.bigInteger('name').unsigned();</td></tr><tr class="hit"><td class="line">24</td><td class="hits">8</td><td class="source">        table.bigInteger('notes').unsigned();</td></tr><tr class="hit"><td class="line">25</td><td class="hits">8</td><td class="source">        table.bigInteger('priority').unsigned();</td></tr><tr class="hit"><td class="line">26</td><td class="hits">8</td><td class="source">        table.bigInteger('completed').unsigned();</td></tr><tr class="hit"><td class="line">27</td><td class="hits">8</td><td class="source">        return table.bigInteger('date').unsigned();</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">    return TimeTask;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">  module.exports = TimeTask;</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/database/user.coffee">/Volumes/Home/Projects/Nitro-Sync/app/database/user.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">26</div><div class="hits">26</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Table, User, _ref,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __hasProp = {}.hasOwnProperty,</td></tr><tr class="hit"><td class="line">4</td><td class="hits">7</td><td class="source">    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  Table = require('../controllers/table');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  User = (function(_super) {</td></tr><tr class="hit"><td class="line">9</td><td class="hits">1</td><td class="source">    __extends(User, _super);</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">11</td><td class="hits">1</td><td class="source">    function User() {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">9</td><td class="source">      _ref = User.__super__.constructor.apply(this, arguments);</td></tr><tr class="hit"><td class="line">13</td><td class="hits">9</td><td class="source">      return _ref;</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">    User.prototype.table = 'user';</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">     * Setup</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">     * Creates the `user` table if it doesn't already exist</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">    User.prototype.setup = function() {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">9</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">9</td><td class="source">      return this._createTable(function(table) {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">8</td><td class="source">        table.increments('id').unsigned();</td></tr><tr class="hit"><td class="line">29</td><td class="hits">8</td><td class="source">        table.string('name', 100);</td></tr><tr class="hit"><td class="line">30</td><td class="hits">8</td><td class="source">        table.string('email', 100).index();</td></tr><tr class="hit"><td class="line">31</td><td class="hits">8</td><td class="source">        table.string('password', 60);</td></tr><tr class="hit"><td class="line">32</td><td class="hits">8</td><td class="source">        table.boolean('pro').unsigned();</td></tr><tr class="hit"><td class="line">33</td><td class="hits">8</td><td class="source">        return table.timestamp('created_at').defaultTo(_this.query.raw('now()'));</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">    User.prototype.search = function(email) {</td></tr><tr class="hit"><td class="line">38</td><td class="hits">31</td><td class="source">      var promise;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">31</td><td class="source">      promise = this._search('id', {</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">        email: email</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">      });</td></tr><tr class="hit"><td class="line">42</td><td class="hits">31</td><td class="source">      return promise.then(function(rows) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">14</td><td class="source">        return rows[0].id;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">    return User;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  })(Table);</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">  module.exports = User;</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/models/user.coffee">/Volumes/Home/Projects/Nitro-Sync/app/models/user.coffee</h2><div id="stats" class="high"><div class="percentage">99%</div><div class="sloc">103</div><div class="hits">102</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Log, Q, User, db, log;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  Q = require('kew');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  db = require('../controllers/query');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  Log = require('../utils/log');</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  log = Log('user', 'green');</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">12</td><td class="hits">1</td><td class="source">  User = (function() {</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">     * Create a new User instance</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">     * - [attrs] (object) : optional attributes to load in</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">     * - [duration] (int) : how long to wait between writes</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">    var Storage;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">    function User(id) {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">80</td><td class="source">      this.id = id;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">    module.exports = User;</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">    Storage = require('../controllers/storage');</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">    User.prototype.info = function() {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">9</td><td class="source">      return db.user.read(this.id, ['name', 'email', 'pro']);</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">     * Set Name</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">     * - name (string) : the users name</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">    User.prototype.setName = function(name) {</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">      return db.user.update(this.id, {</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">        name: name</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">    User.prototype.getName = function() {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">      return db.user.read(this.id, 'name').then(function(info) {</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">        return info.name;</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">     * Change a users email and update the email lookup table</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">     * - email (string) : the email to change to</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">    User.prototype.setEmail = function(email) {</td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">      return db.user.update(this.id, {</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">        email: email</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">    User.prototype.getEmail = function() {</td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">      return db.user.read(this.id, 'email').then(function(info) {</td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">        return info.email;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">     * Change a users password and remove all their login tokens</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">     * - password (string) : the hash of the password</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">79</td><td class="hits">1</td><td class="source">    User.prototype.setPassword = function(password) {</td></tr><tr class="hit"><td class="line">80</td><td class="hits">1</td><td class="source">      db.login.destroyAll(this.id);</td></tr><tr class="hit"><td class="line">81</td><td class="hits">1</td><td class="source">      return db.user.update(this.id, {</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">        password: password</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">    User.prototype.getPassword = function() {</td></tr><tr class="hit"><td class="line">87</td><td class="hits">5</td><td class="source">      return db.user.read(this.id, 'password').then(function(info) {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">5</td><td class="source">        return info.password;</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">92</td><td class="hits">1</td><td class="source">    User.prototype.createModel = function(classname, properties) {</td></tr><tr class="hit"><td class="line">93</td><td class="hits">193</td><td class="source">      return db[classname].create(properties);</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">96</td><td class="hits">1</td><td class="source">    User.prototype.createList = function(list) {</td></tr><tr class="hit"><td class="line">97</td><td class="hits">143</td><td class="source">      return this.createModel('list', {</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">        userId: this.id,</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">        name: list.name</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">103</td><td class="hits">1</td><td class="source">    User.prototype.createTask = function(task) {</td></tr><tr class="hit"><td class="line">104</td><td class="hits">48</td><td class="source">      return this.createModel('task', {</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">        userId: this.id,</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">        listId: task.listId,</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">        name: task.name,</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">        notes: task.notes,</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">        date: task.date,</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">        priority: task.priority,</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">        completed: task.completed</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">115</td><td class="hits">1</td><td class="source">    User.prototype.createPref = function(pref) {</td></tr><tr class="hit"><td class="line">116</td><td class="hits">2</td><td class="source">      return this.createModel('pref', {</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">        userId: this.id,</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">        sort: pref.sort,</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">        night: pref.night,</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">        language: pref.language,</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">        weekStart: pref.weekStart,</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">        dateFormat: pref.dateFormat,</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">        confirmDelete: pref.confirmDelete,</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">        moveCompleted: pref.moveCompleted</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">128</td><td class="hits">1</td><td class="source">    User.prototype.addTaskToList = function(taskId, listId) {</td></tr><tr class="hit"><td class="line">129</td><td class="hits">45</td><td class="source">      return db.list_tasks.create(listId, taskId);</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">132</td><td class="hits">1</td><td class="source">    User.prototype.removeTaskFromList = function(taskId, listId) {</td></tr><tr class="hit"><td class="line">133</td><td class="hits">6</td><td class="source">      return db.list_tasks.destroy(listId, taskId);</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">136</td><td class="hits">1</td><td class="source">    User.prototype.readListTasks = function(listId) {</td></tr><tr class="hit"><td class="line">137</td><td class="hits">23</td><td class="source">      return db.list_tasks.read(listId);</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">140</td><td class="hits">1</td><td class="source">    User.prototype.shouldOwnModel = function(classname, id) {</td></tr><tr class="hit"><td class="line">141</td><td class="hits">602</td><td class="source">      return db[classname]._search('id', {</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">        id: id,</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">        userId: this.id</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">147</td><td class="hits">1</td><td class="source">    User.prototype.shouldOwnTask = function(id) {</td></tr><tr class="hit"><td class="line">148</td><td class="hits">201</td><td class="source">      return this.shouldOwnModel('task', id).fail(function() {</td></tr><tr class="hit"><td class="line">149</td><td class="hits">170</td><td class="source">        log('[task] does not own', id);</td></tr><tr class="hit"><td class="line">150</td><td class="hits">170</td><td class="source">        throw 'err_no_row';</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">154</td><td class="hits">1</td><td class="source">    User.prototype.shouldOwnList = function(id) {</td></tr><tr class="hit"><td class="line">155</td><td class="hits">401</td><td class="source">      return this.shouldOwnModel('list', id).fail(function() {</td></tr><tr class="hit"><td class="line">156</td><td class="hits">214</td><td class="source">        log('[list] does not own', id);</td></tr><tr class="hit"><td class="line">157</td><td class="hits">214</td><td class="source">        throw 'err_no_row';</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">161</td><td class="hits">1</td><td class="source">    User.prototype.readModel = function(classname, id, columns) {</td></tr><tr class="hit"><td class="line">162</td><td class="hits">29</td><td class="source">      return db[classname].read(id, columns).then(function(obj) {</td></tr><tr class="hit"><td class="line">163</td><td class="hits">20</td><td class="source">        delete obj.userId;</td></tr><tr class="hit"><td class="line">164</td><td class="hits">20</td><td class="source">        return obj;</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">168</td><td class="hits">1</td><td class="source">    User.prototype.readList = function(id, columns) {</td></tr><tr class="hit"><td class="line">169</td><td class="hits">9</td><td class="source">      return this.readModel('list', id, columns);</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">172</td><td class="hits">1</td><td class="source">    User.prototype.readTask = function(id, columns) {</td></tr><tr class="hit"><td class="line">173</td><td class="hits">14</td><td class="source">      return this.readModel('task', id, columns);</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">176</td><td class="hits">1</td><td class="source">    User.prototype.readPref = function(columns) {</td></tr><tr class="hit"><td class="line">177</td><td class="hits">6</td><td class="source">      return this.readModel('pref', this.id, columns);</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">180</td><td class="hits">1</td><td class="source">    User.prototype.updateModel = function(classname, id, changes) {</td></tr><tr class="hit"><td class="line">181</td><td class="hits">294</td><td class="source">      return db[classname].update(id, changes);</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">184</td><td class="hits">1</td><td class="source">    User.prototype.updateList = function(id, changes) {</td></tr><tr class="hit"><td class="line">185</td><td class="hits">27</td><td class="source">      return this.updateModel('list', id, changes);</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">188</td><td class="hits">1</td><td class="source">    User.prototype.updateTask = function(id, changes) {</td></tr><tr class="hit"><td class="line">189</td><td class="hits">21</td><td class="source">      return this.updateModel('task', id, changes);</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">192</td><td class="hits">1</td><td class="source">    User.prototype.updatePref = function(changes) {</td></tr><tr class="hit"><td class="line">193</td><td class="hits">246</td><td class="source">      return this.updateModel('pref', this.id, changes);</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">196</td><td class="hits">1</td><td class="source">    User.prototype.destroyModel = function(classname, id) {</td></tr><tr class="hit"><td class="line">197</td><td class="hits">77</td><td class="source">      return db[classname].destroy(id);</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">200</td><td class="hits">1</td><td class="source">    User.prototype.destroyList = function(id) {</td></tr><tr class="hit"><td class="line">201</td><td class="hits">63</td><td class="source">      return this.destroyModel('list', id);</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">204</td><td class="hits">1</td><td class="source">    User.prototype.destroyTask = function(id) {</td></tr><tr class="hit"><td class="line">205</td><td class="hits">12</td><td class="source">      return this.destroyModel('task', id);</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">208</td><td class="hits">1</td><td class="source">    User.prototype.destroyPref = function() {</td></tr><tr class="hit"><td class="line">209</td><td class="hits">2</td><td class="source">      return this.destroyModel('pref', this.id);</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">     * Get an array of all the active models in a class</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">     * - classname (string)</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">     * &gt; object</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">220</td><td class="hits">1</td><td class="source">    User.prototype.exportTasks = function() {</td></tr><tr class="hit"><td class="line">221</td><td class="hits">7</td><td class="source">      return db.task._search('*', {</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">        userId: this.id</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source">      }).then(function(tasks) {</td></tr><tr class="hit"><td class="line">224</td><td class="hits">6</td><td class="source">        var task, _i, _len;</td></tr><tr class="hit"><td class="line">225</td><td class="hits">6</td><td class="source">        for (_i = 0, _len = tasks.length; _i &lt; _len; _i++) {</td></tr><tr class="hit"><td class="line">226</td><td class="hits">19</td><td class="source">          task = tasks[_i];</td></tr><tr class="hit"><td class="line">227</td><td class="hits">19</td><td class="source">          delete task.userId;</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">229</td><td class="hits">6</td><td class="source">        return tasks;</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">      }).fail(function() {</td></tr><tr class="hit"><td class="line">231</td><td class="hits">1</td><td class="source">        return [];</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">235</td><td class="hits">1</td><td class="source">    User.prototype.exportLists = function() {</td></tr><tr class="hit"><td class="line">236</td><td class="hits">5</td><td class="source">      var _this = this;</td></tr><tr class="hit"><td class="line">237</td><td class="hits">5</td><td class="source">      return db.list._search('*', {</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source">        userId: this.id</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">      }).then(function(lists) {</td></tr><tr class="hit"><td class="line">240</td><td class="hits">5</td><td class="source">        var promises;</td></tr><tr class="hit"><td class="line">241</td><td class="hits">5</td><td class="source">        promises = [];</td></tr><tr class="hit"><td class="line">242</td><td class="hits">5</td><td class="source">        lists.forEach(function(list) {</td></tr><tr class="hit"><td class="line">243</td><td class="hits">18</td><td class="source">          delete list.userId;</td></tr><tr class="hit"><td class="line">244</td><td class="hits">18</td><td class="source">          return promises.push(_this.readListTasks(list.id).then(function(tasks) {</td></tr><tr class="hit"><td class="line">245</td><td class="hits">18</td><td class="source">            return list.tasks = tasks;</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">          }));</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source">        });</td></tr><tr class="hit"><td class="line">248</td><td class="hits">5</td><td class="source">        return Q.all(promises).then(function() {</td></tr><tr class="hit"><td class="line">249</td><td class="hits">5</td><td class="source">          return lists;</td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source">        });</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">      }).fail(function() {</td></tr><tr class="miss"><td class="line">252</td><td class="hits">0</td><td class="source">        return [];</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">254</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">256</td><td class="hits">1</td><td class="source">    User.prototype.exportPref = function() {</td></tr><tr class="hit"><td class="line">257</td><td class="hits">2</td><td class="source">      return this.readPref();</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">259</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">260</td><td class="hits">1</td><td class="source">    return User;</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">  })();</td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/utils/keychain.coffee">/Volumes/Home/Projects/Nitro-Sync/app/utils/keychain.coffee</h2><div id="stats" class="high"><div class="percentage">75%</div><div class="sloc">16</div><div class="hits">12</div><div class="misses">4</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var Log, data, e, fs, keys, warn;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  Log = require('../utils/log');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  fs = require('fs');</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  keys = {};</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  warn = Log('Keychain', 'red');</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">12</td><td class="hits">1</td><td class="source">  try {</td></tr><tr class="hit"><td class="line">13</td><td class="hits">1</td><td class="source">    data = fs.readFileSync(__dirname + '/../../keychain');</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">  } catch (_error) {</td></tr><tr class="miss"><td class="line">15</td><td class="hits">0</td><td class="source">    e = _error;</td></tr><tr class="miss"><td class="line">16</td><td class="hits">0</td><td class="source">    warn('Could not load keychain');</td></tr><tr class="miss"><td class="line">17</td><td class="hits">0</td><td class="source">    data = '{}';</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">  keys = JSON.parse(data.toString());</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">  module.exports = function(key) {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">6</td><td class="source">    if (!keys.hasOwnProperty(key)) {</td></tr><tr class="miss"><td class="line">24</td><td class="hits">0</td><td class="source">      warn(&quot;Key not found for '&quot; + key + &quot;'&quot;);</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">26</td><td class="hits">6</td><td class="source">    return keys[key];</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/utils/log.coffee">/Volumes/Home/Projects/Nitro-Sync/app/utils/log.coffee</h2><div id="stats" class="high"><div class="percentage">92%</div><div class="sloc">13</div><div class="hits">12</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var colors,</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">    __slice = [].slice;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">5</td><td class="hits">1</td><td class="source">  colors = {</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">    'reset': '\u001b[0m',</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">    'bold': '\u001b[1m',</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">    'italic': '\u001b[3m',</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">    'underline': '\u001b[4m',</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">    'blink': '\u001b[5m',</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">    'black': '\u001b[30m',</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">    'red': '\u001b[31m',</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">    'green': '\u001b[32m',</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    'yellow': '\u001b[33m',</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">    'blue': '\u001b[34m',</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    'magenta': '\u001b[35m',</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">    'cyan': '\u001b[36m',</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">    'white': '\u001b[37m'</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">  module.exports = function(name, color) {</td></tr><tr class="hit"><td class="line">22</td><td class="hits">9</td><td class="source">    var prefix,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">      _this = this;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">9</td><td class="source">    if (color == null) {</td></tr><tr class="miss"><td class="line">25</td><td class="hits">0</td><td class="source">      color = 'reset';</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">27</td><td class="hits">9</td><td class="source">    prefix = &quot;&quot; + colors[color] + &quot;[&quot; + name + &quot;]&quot; + colors.reset;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">9</td><td class="source">    return function() {</td></tr><tr class="hit"><td class="line">29</td><td class="hits">491</td><td class="source">      var args;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">491</td><td class="source">      args = 1 &lt;= arguments.length ? __slice.call(arguments, 0) : [];</td></tr><tr class="hit"><td class="line">31</td><td class="hits">491</td><td class="source">      args.unshift(prefix);</td></tr><tr class="hit"><td class="line">32</td><td class="hits">491</td><td class="source">      return console.log.apply(console, args);</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="/Volumes/Home/Projects/Nitro-Sync/app/utils/time.coffee">/Volumes/Home/Projects/Nitro-Sync/app/utils/time.coffee</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">39</div><div class="hits">39</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr class="hit"><td class="line">1</td><td class="hits">1</td><td class="source">(function() {</td></tr><tr class="hit"><td class="line">2</td><td class="hits">1</td><td class="source">  var PREFIX, TIME, db, time;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">4</td><td class="hits">1</td><td class="source">  db = require('../controllers/query');</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">6</td><td class="hits">1</td><td class="source">  TIME = 'time';</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">8</td><td class="hits">1</td><td class="source">  PREFIX = 'time_';</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">10</td><td class="hits">1</td><td class="source">  time = {</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">    read: function(classname, id, column) {</td></tr><tr class="hit"><td class="line">12</td><td class="hits">91</td><td class="source">      return db[PREFIX + classname].read(id, column);</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">    destroy: function(classname, id) {</td></tr><tr class="hit"><td class="line">15</td><td class="hits">4</td><td class="source">      return db[PREFIX + classname].destroy(id);</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">    update: function(classname, id, attr, time) {</td></tr><tr class="hit"><td class="line">18</td><td class="hits">292</td><td class="source">      var obj;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">292</td><td class="source">      if (typeof attr === 'object') {</td></tr><tr class="hit"><td class="line">20</td><td class="hits">290</td><td class="source">        obj = attr;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">      } else {</td></tr><tr class="hit"><td class="line">22</td><td class="hits">2</td><td class="source">        obj = {};</td></tr><tr class="hit"><td class="line">23</td><td class="hits">2</td><td class="source">        obj[attr] = time;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">25</td><td class="hits">292</td><td class="source">      return db[PREFIX + classname].update(id, obj);</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">    /*</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">     * Create Time</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">     * Set multiple timestamps.</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">     * Will add id property to attrs object.</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">     *</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">     * - classname (string)</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">     * - id (int)</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">     * - attrs (object)</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">    */</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">    create: function(classname, id, attrs) {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">183</td><td class="source">      attrs.id = id;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">183</td><td class="source">      return db[PREFIX + classname].create(attrs);</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">    createTask: function(id, time) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">39</td><td class="source">      return this.create('task', id, {</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">        listId: time,</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">        name: time,</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">        notes: time,</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">        priority: time,</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">        date: time,</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">        completed: time</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    createList: function(id, time) {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">134</td><td class="source">      return this.create('list', id, {</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">        name: time,</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">        tasks: time</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    createPref: function(id, time) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">      return this.create('pref', id, {</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">        sort: time,</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">        night: time,</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">        language: time,</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">        weekStart: time,</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">        dateFormat: time,</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">        confirmDelete: time,</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">        moveCompleted: time</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    checkSingle: function(classname, id, time) {</td></tr><tr class="hit"><td class="line">70</td><td class="hits">73</td><td class="source">      return this.read(classname, id).then(function(times) {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">73</td><td class="source">        var attr, pass, val;</td></tr><tr class="hit"><td class="line">72</td><td class="hits">73</td><td class="source">        pass = true;</td></tr><tr class="hit"><td class="line">73</td><td class="hits">73</td><td class="source">        for (attr in times) {</td></tr><tr class="hit"><td class="line">74</td><td class="hits">267</td><td class="source">          val = times[attr];</td></tr><tr class="hit"><td class="line">75</td><td class="hits">267</td><td class="source">          if (val &gt; time) {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">6</td><td class="source">            pass = false;</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">79</td><td class="hits">73</td><td class="source">        return pass;</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    checkMultiple: function(classname, id, times) {</td></tr><tr class="hit"><td class="line">83</td><td class="hits">6</td><td class="source">      var keys, old;</td></tr><tr class="hit"><td class="line">84</td><td class="hits">6</td><td class="source">      keys = Object.keys(times);</td></tr><tr class="hit"><td class="line">85</td><td class="hits">6</td><td class="source">      old = [];</td></tr><tr class="hit"><td class="line">86</td><td class="hits">6</td><td class="source">      return this.read(classname, id, keys).then(function(timestamps) {</td></tr><tr class="hit"><td class="line">87</td><td class="hits">5</td><td class="source">        var attr, current;</td></tr><tr class="hit"><td class="line">88</td><td class="hits">5</td><td class="source">        for (attr in times) {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">11</td><td class="source">          time = times[attr];</td></tr><tr class="hit"><td class="line">90</td><td class="hits">11</td><td class="source">          current = timestamps[attr];</td></tr><tr class="hit"><td class="line">91</td><td class="hits">11</td><td class="source">          if (current &gt; time) {</td></tr><tr class="hit"><td class="line">92</td><td class="hits">7</td><td class="source">            old.push(attr);</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">        }</td></tr><tr class="hit"><td class="line">95</td><td class="hits">5</td><td class="source">        return old;</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">100</td><td class="hits">1</td><td class="source">  module.exports = time;</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">}).call(this);</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div></div></div></body></html>